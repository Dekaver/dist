import{_ as f,u as v,a as h,r as l,o as d,c,b as s,d as r,w,n as m,e as b,f as g,p as L,g as S}from"./index-11eb6111.js";const A="/layout/images/latar2.jpg",k="/layout/images/erp-ori-nocapt.png",x="/layout/images/kata.png";const C={data(){return{userStore:v(),siteKey:"6Le5nhIpAAAAAMFoIVPDYCX8nLLG-e5CK0f_MFQT",user:{usernamenya:"",passwordnya:""},isSubmitted:!1,redirect:"/"}},mounted(){this.getRedirect(),this.isLogged(),this.$isLoading.value=!1,this.loadCaptcha()},methods:{handler(e){this.user.recaptchaToken=e},validateRecaptcha(){return new Promise((e,a)=>{const n=grecaptcha.getResponse();e(n===""?{success:!1}:{success:!0,response:n})})},async login(){try{this.user.usernamenya&&this.user.passwordnya?(this.$isLoading.value=!0,this.isSubmitted=!0,await h.login(this.user).then(e=>{this.$toast.add({severity:"success",summary:"Success",detail:e.data.message,life:3e3}),setTimeout(()=>{this.$router.push(this.redirect)},1e3)}).catch(e=>{this.user.passwordnya=null,this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})})):!this.user.usernamenya&&this.user.passwordnya?this.$toast.add({severity:"error",summary:"Failed",detail:"Username Required ",life:3e3}):this.user.usernamenya&&!this.user.passwordnya?this.$toast.add({severity:"error",summary:"Failed",detail:"Password Required ",life:3e3}):this.$toast.add({severity:"error",summary:"Failed",detail:"Username And Password Required ",life:3e3});return}catch(e){this.isSubmitted=!1,this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}finally{this.isSubmitted=!1,this.$timeoutLoading()}},async logout(){await h.logout().then(()=>{localStorage.removeItem("user"),this.userStore.clearUser()})},getRedirect(){let e=this.$route.redirectedFrom;e&&e.fullPath!=="/login"?this.redirect==null?this.redirect=e.fullPath:this.redirect="/":this.redirect="/"},async isLogged(){this.getRedirect(),await this.$auth.checkAuth()&&this.$router.push(this.redirect)},loadCaptcha(){const e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit",e.defer=!0,e.async=!0,e.onload=()=>{grecaptcha.ready(()=>{grecaptcha.render(this.$refs.recaptcha,{sitekey:"6Le5nhIpAAAAAMFoIVPDYCX8nLLG-e5CK0f_MFQT",callback:this.handler})})},document.head.appendChild(e)}}},i=e=>(L("data-v-b38d2d48"),e=e(),S(),e),I={class:"login-body"},R=i(()=>s("div",{class:"bg-img"},[s("img",{src:A,alt:""})],-1)),V={class:"login-wrapper"},$={class:"login-panel"},F={class:"card grid p-2"},P={class:"col"},T=i(()=>s("div",{class:"logo"},[s("img",{src:k,alt:"poseidon-layout"})],-1)),U=i(()=>s("p",{class:"m-0"},"Selamat datang di ERP Nusantara",-1)),j=["data-sitekey"],B={key:0,class:"text-center w-full"},M={key:1,class:"text-center w-full"},N=i(()=>s("i",{class:"pi pi-spinner pi-spin"},null,-1)),E=[N],K=i(()=>s("p",{class:"m-0"},"Lupa password ? Hubungi admin",-1)),q=i(()=>s("div",{class:"col"},[s("div",{class:"bg-blue-100 flex border-round justify-content-center align-items-center h-full p-4"},[s("img",{class:"logo-client max-h-9rem max-w-15rem",src:x,alt:"poseidon-layout"})])],-1));function G(e,a,n,D,t,u){const _=l("Toast"),p=l("InputText"),y=l("Button");return d(),c("div",I,[R,s("div",V,[s("div",$,[r(_),s("div",F,[s("div",P,[T,U,s("form",{class:"login-form",onSubmit:a[2]||(a[2]=w((...o)=>u.login&&u.login(...o),["prevent"]))},[r(p,{modelValue:t.user.usernamenya,"onUpdate:modelValue":a[0]||(a[0]=o=>t.user.usernamenya=o),type:"text",autocomplete:"on",placeholder:"Email",class:m({"p-invalid":t.isSubmitted&&!t.user.usernamenya}),autofocus:""},null,8,["modelValue","class"]),r(p,{modelValue:t.user.passwordnya,"onUpdate:modelValue":a[1]||(a[1]=o=>t.user.passwordnya=o),type:"password",autocomplete:"off",placeholder:"Password",class:m({"p-invalid":t.isSubmitted&&!t.user.passwordnya})},null,8,["modelValue","class"]),s("div",{class:"g-recaptcha mb-4 mx-auto flex justify-content-center","data-sitekey":t.siteKey,ref:"recaptcha"},null,8,j),r(y,{type:"submit",class:"w-100",disabled:e.$isLoading.value,loading:e.$isLoading.value},{default:b(()=>[e.$isLoading.value?g("",!0):(d(),c("span",B," LOGIN ")),e.$isLoading.value?(d(),c("span",M,E)):g("",!0)]),_:1},8,["disabled","loading"])],32),K]),q])])])])}const X=f(C,[["render",G],["__scopeId","data-v-b38d2d48"]]);export{X as default};
