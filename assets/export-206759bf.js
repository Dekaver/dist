import{a as p}from"./xlsx.min-b21a3818.js";import{_ as w,o as u,c as s,b as e,m as i,q as a,t as n,W as _,p as k,g as T}from"./index-11eb6111.js";const A={props:{lItem:{type:Array,default:()=>[]}},data(){return{columns:[{field:"ap_number",header:"Nomor",expander:!0},{field:"date",header:"Tanggal",type:"date"},{field:"invoice_number",header:"Invoice"},{field:"invoice_date",header:"Tanggal Invoice",type:"date"},{field:"due_date",header:"Jatuh Tempo",type:"date"},{field:"amount",header:"Nilai Invoice",class:"justify-content-end",type:"currency"},{field:"pay",header:"Bayar",class:"justify-content-end",type:"currency"},{field:"discount",header:"Diskon",class:"justify-content-end",type:"currency"},{field:"sisa",header:"Sisa Tagihan",class:"justify-content-end",type:"currency"},{field:"umur_overdue",header:"Umur Jatuh Tempo",type:"number"},{field:"po_number",header:"Nomor PO"},{field:"keterangan",header:"Keterangan"}]}},methods:{exportToXLSX(){const t=p.utils.table_to_sheet(document.getElementById("table")),d=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];t["!cols"]=d;for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const l=t[r];l.t==="n"&&(l.z="0")}t.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}},t.A2.s={font:{name:"Arial Black",sz:16,bold:!0},alignment:{vertical:"center",horizontal:"center"}};let b={fill:{patternType:"solid",fgColor:{rgb:"49b1fb"},bgColor:{rgb:"49b1fb"}},alignment:{vertical:"center",horizontal:"center"}};const c={s:{c:0,r:5},e:{c:11,r:5}};for(let r=c.s.r;r<=c.e.r;r++)for(let l=c.s.c;l<=c.e.c;l++){const h=p.utils.encode_cell({r,c:l});t[h].s=b}["F","G","H","I"].forEach(r=>{for(let l=7;l<=this.totalDataObjects+7;l++){const h=r+l,f=t[h];f&&f.v&&(f.s={alignment:{vertical:"center",horizontal:"right"}})}});const m=p.utils.book_new();p.utils.book_append_sheet(m,t,"Sheet1"),p.writeFile(m,"exported_data.xlsx")}},created(){},mounted(){},computed:{totalDataObjects(){let t=0;for(const d of this.lItem)if(t++,d.children&&Array.isArray(d.children))for(const b of d.children)t++;return t}}},g=t=>(k("data-v-5764556b"),t=t(),T(),t),N={border:"1",id:"table"},I=g(()=>e("tr",null,[e("td",{colspan:"12"},"PT Planet IT (PRODUK)")],-1)),S=g(()=>e("tr",null,[e("td",{colspan:"12"},"LAPORAN HUTANG (AP) BELUM LUNAS")],-1));function $(t,d,b,c,y,m){return u(),s("div",null,[e("button",{onClick:d[0]||(d[0]=(...r)=>m.exportToXLSX&&m.exportToXLSX(...r))},"Export to XLSX"),e("div",null,[e("table",N,[e("thead",null,[I,S,e("tr",null,[(u(),s(i,null,a(12,r=>e("td",{key:r},n(" "))),64))]),e("tr",null,[(u(),s(i,null,a(12,r=>e("td",{key:r},n(" "))),64))]),e("tr",null,[(u(),s(i,null,a(12,r=>e("td",{key:r},n(" "))),64))]),e("tr",null,[(u(!0),s(i,null,a(y.columns,(r,l)=>(u(),s("th",{key:l},n(r.header),1))),128))])]),e("tbody",null,[(u(!0),s(i,null,a(b.lItem,({key:r,data:l,children:h,style:f})=>(u(),s(i,{key:r},[e("tr",{style:_(f==="font-bold"?"font-weight: bold;":"")},[e("td",null,n(l.invoice_number),1),e("td",null,n(t.$h.formatDate(l.invoice_date)),1),e("td",null,n(l.due_date!="Total"?t.$h.formatDate(l.due_date):l.due_date),1),e("td",null,n(l.amount?t.$h.formatNumber(l.amount):null),1),e("td",null,n(l.pay?t.$h.formatNumber(l.pay):null),1),e("td",null,n(l.discount?t.$h.formatNumber(l.discount):null),1),e("td",null,n(l.sisa?t.$h.formatNumber(l.sisa):null),1),e("td",null,n(l.umur_overdue),1),e("td",null,n(l.po_number),1),e("td",null,n(l.keterangan),1)],4),(u(!0),s(i,null,a(h,({key:v,data:o})=>(u(),s("tr",{key:v,style:_(o.style==="font-bold"?"font-weight: bold;":"")},[e("td",null,n(o.invoice_number),1),e("td",null,n(t.$h.formatDate(o.invoice_date)),1),e("td",null,n(o.due_date!="Total"?t.$h.formatDate(o.due_date):o.due_date),1),e("td",null,n(o.amount?t.$h.formatNumber(o.amount):null),1),e("td",null,n(o.pay?t.$h.formatNumber(o.pay):null),1),e("td",null,n(o.discount?t.$h.formatNumber(o.discount):null),1),e("td",null,n(o.sisa?t.$h.formatNumber(o.sisa):null),1),e("td",null,n(o.umur_overdue),1),e("td",null,n(o.po_number),1),e("td",null,n(o.keterangan),1)],4))),128))],64))),128))])])])])}const z=w(A,[["render",$],["__scopeId","data-v-5764556b"]]);export{z as default};
