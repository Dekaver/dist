import{a as b}from"./xlsx.min-b21a3818.js";import{_ as T,o as u,c as a,b as e,m as i,q as s,t as o,W as y,p as g,g as S}from"./index-11eb6111.js";const w={data(){return{lItem:[{key:7,data:{style:"font-bold",ap_number:"001",date:"SBS"},children:[{key:"7-0",data:{ap_number:"AP230900004",date:"2023-09-29T00:00:00.000Z",id_supplier:7,invoice_number:"ini ap 2 x",invoice_date:"2023-09-29T00:00:00.000Z",top:12,due_date:"2023-10-11T00:00:00.000Z",amount:"400000000",discount:"0",pay:"0",po_number:"PO230900002",keterangan:null,customer:"SBS",code_customer:"001",sisa:4e8,umur_overdue:-9,style:"font-normal"}},{key:"7-1",data:{ap_number:"AP230900005",date:"2023-09-29T00:00:00.000Z",id_supplier:7,invoice_number:"sakdh",invoice_date:"2023-09-29T00:00:00.000Z",top:12,due_date:"2023-10-11T00:00:00.000Z",amount:"4000000",discount:"0",pay:"0",po_number:"PO230900003",keterangan:null,customer:"SBS",code_customer:"001",sisa:4e6,umur_overdue:-9,style:"font-normal"}},{key:"7-2",data:{ap_number:"AP230900003",date:"2023-09-29T00:00:00.000Z",id_supplier:7,invoice_number:"iniinvoice",invoice_date:"2023-09-29T00:00:00.000Z",top:12,due_date:"2023-10-11T00:00:00.000Z",amount:"10000000000",discount:"0",pay:"0",po_number:"PO230900001",keterangan:null,customer:"SBS",code_customer:"001",sisa:1e10,umur_overdue:-9,style:"font-normal"}},{key:"7-3",data:{ap_number:"AP230900006",date:"2023-09-29T00:00:00.000Z",id_supplier:7,invoice_number:"uyiuoi",invoice_date:"2023-09-29T00:00:00.000Z",top:12,due_date:"2023-10-11T00:00:00.000Z",amount:"10000",discount:"0",pay:"0",po_number:"PO230900001",keterangan:null,customer:"SBS",code_customer:"001",sisa:1e4,umur_overdue:-9,style:"font-normal"}},{key:"7-4",data:{ap_number:"AP231000002",date:"2023-10-02T00:00:00.000Z",id_supplier:7,invoice_number:"ininininin",invoice_date:"2023-10-02T00:00:00.000Z",top:12,due_date:"2023-10-14T00:00:00.000Z",amount:"4000000",discount:"0",pay:"0",po_number:"PO231000001",keterangan:null,customer:"SBS",code_customer:"001",sisa:4e6,umur_overdue:-12,style:"font-normal"}},{key:"7-5",data:{ap_number:"AP231000001",date:"2023-10-02T00:00:00.000Z",id_supplier:7,invoice_number:"ini invoice",invoice_date:"2023-10-02T00:00:00.000Z",top:12,due_date:"2023-10-14T00:00:00.000Z",amount:"90900",discount:"0",pay:"0",po_number:"PO230900001",keterangan:"ini keterangan",customer:"SBS",code_customer:"001",sisa:90900,umur_overdue:-12,style:"font-normal"}},{key:"7-total",data:{style:"font-bold",due_date:"Total",amount:"10408100900",sisa:10408100900}}]},{key:8,data:{style:"font-bold",ap_number:"002",date:"Aku Kamu Media"},children:[{key:"8-0",data:{ap_number:"AP231000004",date:"2023-10-02T00:00:00.000Z",id_supplier:8,invoice_number:"1212",invoice_date:"2023-10-02T00:00:00.000Z",top:12,due_date:"2023-10-14T00:00:00.000Z",amount:"10000000",discount:"0",pay:"0",po_number:"PO231000002",keterangan:"12",customer:"Aku Kamu Media",code_customer:"002",sisa:1e7,umur_overdue:-12,style:"font-normal"}},{key:"8-total",data:{style:"font-bold",due_date:"Total",amount:"10000000",sisa:1e7}}]}],columns:[{field:"ap_number",header:"Nomor",expander:!0},{field:"date",header:"Tanggal",type:"date"},{field:"invoice_number",header:"Invoice"},{field:"invoice_date",header:"Tanggal Invoice",type:"date"},{field:"due_date",header:"Jatuh Tempo",type:"date"},{field:"amount",header:"Nilai Invoice",class:"justify-content-end",type:"currency"},{field:"pay",header:"Bayar",class:"justify-content-end",type:"currency"},{field:"discount",header:"Diskon",class:"justify-content-end",type:"currency"},{field:"sisa",header:"Sisa Tagihan",class:"justify-content-end",type:"currency"},{field:"umur_overdue",header:"Umur Jatuh Tempo",type:"number"},{field:"po_number",header:"Nomor PO"},{field:"keterangan",header:"Keterangan"}],headers:{},childData:[]}},methods:{exportToXLSX(){const n=b.utils.table_to_sheet(document.getElementById("table")),d=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];n["!cols"]=d;for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)){const t=n[r];t.t==="n"&&(t.z="0")}n.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}},n.A2.s={font:{name:"Arial Black",sz:16,bold:!0},alignment:{vertical:"center",horizontal:"center"}};let f={fill:{patternType:"solid",fgColor:{rgb:"49b1fb"},bgColor:{rgb:"49b1fb"}},alignment:{vertical:"center",horizontal:"center"}};const c={s:{c:0,r:5},e:{c:11,r:5}};for(let r=c.s.r;r<=c.e.r;r++)for(let t=c.s.c;t<=c.e.c;t++){const p=b.utils.encode_cell({r,c:t});n[p].s=f}["F","G","H","I"].forEach(r=>{for(let t=7;t<=this.totalDataObjects+7;t++){const p=r+t,_=n[p];_&&_.v&&(_.s={alignment:{vertical:"center",horizontal:"right"}})}});const m=b.utils.book_new();b.utils.book_append_sheet(m,n,"Sheet1"),b.writeFile(m,"exported_data.xlsx")}},created(){},mounted(){},computed:{totalDataObjects(){let n=0;for(const d of this.lItem)if(n++,d.children&&Array.isArray(d.children))for(const f of d.children)n++;return n}}},v=n=>(g("data-v-58dee9a3"),n=n(),S(),n),A={border:"1",id:"table"},P=v(()=>e("tr",null,[e("td",{colspan:"12"},"PT Planet IT (PRODUK)")],-1)),Z=v(()=>e("tr",null,[e("td",{colspan:"12"},"LAPORAN HUTANG (AP) BELUM LUNAS")],-1));function N(n,d,f,c,h,m){return u(),a("div",null,[e("button",{onClick:d[0]||(d[0]=(...r)=>m.exportToXLSX&&m.exportToXLSX(...r))},"Export to XLSX"),e("div",null,[e("table",A,[e("thead",null,[P,Z,e("tr",null,[(u(),a(i,null,s(12,r=>e("td",{key:r},o(" "))),64))]),e("tr",null,[(u(),a(i,null,s(12,r=>e("td",{key:r},o(" "))),64))]),e("tr",null,[(u(),a(i,null,s(12,r=>e("td",{key:r},o(" "))),64))]),e("tr",null,[(u(!0),a(i,null,s(h.columns,(r,t)=>(u(),a("th",{key:t},o(r.header),1))),128))])]),e("tbody",null,[(u(!0),a(i,null,s(h.lItem,({key:r,data:t,children:p,style:_})=>(u(),a(i,{key:r},[e("tr",{style:y(_==="font-bold"?"font-weight: bold;":"")},[e("td",null,o(t.ap_number),1),e("td",null,o(new Date(t.date)instanceof Date&&!isNaN(new Date(t.date))?n.$h.formatDate(t.date):t.date),1),e("td",null,o(t.invoice_number),1),e("td",null,o(n.$h.formatDate(t.invoice_date)),1),e("td",null,o(t.due_date!="Total"?n.$h.formatDate(t.due_date):t.due_date),1),e("td",null,o(t.amount?n.$h.formatNumber(t.amount):null),1),e("td",null,o(t.pay?n.$h.formatNumber(t.pay):null),1),e("td",null,o(t.discount?n.$h.formatNumber(t.discount):null),1),e("td",null,o(t.sisa?n.$h.formatNumber(t.sisa):null),1),e("td",null,o(t.umur_overdue),1),e("td",null,o(t.po_number),1),e("td",null,o(t.keterangan),1)],4),(u(!0),a(i,null,s(p,({key:k,data:l})=>(u(),a("tr",{key:k,style:y(l.style==="font-bold"?"font-weight: bold;":"")},[e("td",null,o(l.ap_number),1),e("td",null,o(n.$h.formatDate(l.date)),1),e("td",null,o(l.invoice_number),1),e("td",null,o(n.$h.formatDate(l.invoice_date)),1),e("td",null,o(l.due_date!="Total"?n.$h.formatDate(l.due_date):l.due_date),1),e("td",null,o(l.amount?n.$h.formatNumber(l.amount):null),1),e("td",null,o(l.pay?n.$h.formatNumber(l.pay):null),1),e("td",null,o(l.discount?n.$h.formatNumber(l.discount):null),1),e("td",null,o(l.sisa?n.$h.formatNumber(l.sisa):null),1),e("td",null,o(l.umur_overdue),1),e("td",null,o(l.po_number),1),e("td",null,o(l.keterangan),1)],4))),128))],64))),128))])])])])}const O=T(w,[["render",N],["__scopeId","data-v-58dee9a3"]]);export{O as default};
