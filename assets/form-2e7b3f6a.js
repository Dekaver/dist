import{a as u}from"./permission-1fb3dbe3.js";import{a as r}from"./role-1adf88f1.js";import{_ as y,r as d,o as f,c as x,b as n,d as a,e as _}from"./index-11eb6111.js";const k={data(){return{items:[],expandedKeys:{},selectedIds:[],selectedKey:[],checked:!0}},methods:{async getData(){await u.index({type:"tree"}).then(e=>{this.items=e.data.data,this.expandAll()}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message})}),await r.show(this.$route.params.id).then(e=>{e.data.data.permissions.map(s=>{this.selectedKey={[s.id_permission]:{checked:!0,partialChecked:!1},...this.selectedKey}})})},async saveData(){await r.attachPermission(this.$route.params.id,{id_permission:Object.keys(this.selectedKey).map(e=>parseInt(e))}).then(e=>{this.$router.push({path:"/setting/role",query:{success:!0}}),this.$toast.add({severity:"success",summary:"Success",detail:e.data.message})}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message})})},expandAll(){for(let e of this.items)this.expandNode(e);this.expandedKeys={...this.expandedKeys}},collapseAll(){this.expandedKeys={}},expandNode(e){if(e.children&&e.children.length){this.expandedKeys[e.key]=!0;for(let s of e.children)this.expandNode(s)}},handleSelectedIds(e){this.selectedIds=e},goBack(){this.$router.go(-1)}},mounted(){this.getData()},watch:{checked:{handler:function(e){e?this.expandAll():this.collapseAll()}}},created(){this.$route.query.success&&this.$toast.add({severity:"success",summary:"Success",detail:"Role updated",life:3e3})}},K={class:"grid crud-demo"},g={class:"col-12"},v={class:"card"},b={class:"flex flex-wrap gap-2 mb-4"},B={class:"flex justify-content-between"};function C(e,s,w,T,t,i){const p=d("Toast"),h=d("ToggleButton"),c=d("Column"),m=d("TreeTable"),l=d("Button");return f(),x("div",K,[n("div",g,[n("div",v,[a(p),n("div",b,[a(h,{modelValue:t.checked,"onUpdate:modelValue":s[0]||(s[0]=o=>t.checked=o),class:"w-8rem",onLabel:"Collapse",offLabel:"Expand"},null,8,["modelValue"])]),a(m,{selectionKeys:t.selectedKey,"onUpdate:selectionKeys":s[1]||(s[1]=o=>t.selectedKey=o),expandedKeys:t.expandedKeys,"onUpdate:expandedKeys":s[2]||(s[2]=o=>t.expandedKeys=o),value:t.items,selectionMode:"checkbox"},{default:_(()=>[a(c,{header:"Permission",field:"permission",expander:""}),a(c,{header:"Keterangan",field:"keterangan"})]),_:1},8,["selectionKeys","expandedKeys","value"]),n("div",B,[a(l,{label:"Back",icon:"pi pi-chevron-left",class:"mt-4",text:"",type:"button",onClick:i.goBack},null,8,["onClick"]),a(l,{label:"Save",icon:"pi pi-check",class:"mt-4",type:"button",onClick:i.saveData},null,8,["onClick"])])])])])}const D=y(k,[["render",C]]);export{D as default};
