import{a as L}from"./jeniskendaraan-ee8c8507.js";import{a as h}from"./internaltransfer-7aab9fa3.js";/* empty css                             */import{_ as J,r as d,A as N,o as c,c as k,d as s,b as t,l as f,t as p,e as _,n as w,m as C,q as P,k as y,B as j,f as x}from"./index-11eb6111.js";const A={data(){return{item:{id:null,nomor:null,id_internal_order:null,nomor_internal_order:null,tanggal_internal_order:null,tanggal:null,id_pengirim:null,id_penerima:null,id_gudang_asal:null,id_gudang_tujuan:null,gudang_asal:null,gudang_tujuan:null,status:null,tanggal_kirim:null,tanggal_terima:null,jam_kirim:null,jam_terima:null,keterangan:null,telepon:null,nopol:null,id_jenis_kendaraan:null,driver:null,transporter:null,detail:[]},lInternalTransfer:[],selectedInternalTransfer:null,filteredInternalTransfer:[],lProduk:[],lJeniskendaraan:[],selectedJenisKendaraan:null,columns:[{field:"nama_barang",header:"Product",width:"15%",class:"left"},{field:"kode_barang",header:"Code Product",width:"15%",class:"left"},{field:"qty",header:"Qty Order",width:"15%",class:"left"},{field:"diterima",header:"Qty",width:"15%",class:"left"},{field:"satuan",header:"Unit",width:"15%",class:"left"},{field:"keterangan",header:"Remark",width:"15%",class:"left"}],tanggal:null,tanggal_kirim:null,tanggal_terima:null,tanggal_internal_order:null,filters:{},isMore:!1,isEdit:!1,isSubmit:!1}},computed:{invalid:function(){return!(this.item.tanggal!=null&&this.item.id_internal_order!=null&&this.item.id_gudang_asal!=null&&this.item.id_gudang_tujuan!=null)}},mounted(){this.isEdit=!!this.$route.params.id,this.item.id=this.$route.params.id?this.$route.params.id:null,this.tanggal_terima=this.$serverTime,this.item.tanggal_terima=this.$h.Date(this.$serverTime),this.item.status_terima="D",this.getData().then(()=>{this.isEdit&&this.getInternalTransfer()})},methods:{onCellEditComplete(n){let{data:e,newValue:i,field:o}=n;switch(o){case"diterima":e[o]=i;break;case"keterangan":e[o]=i;break}},async getData(){await L.index().then(n=>{this.lJeniskendaraan=n.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Jenis Kendaraan",life:3e3})}),await h.index({status:"S"}).then(n=>{this.lInternalTransfer=n.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Internal Order",life:3e3})})},async getInternalTransfer(){await h.show(this.item.id).then(n=>{this.item=n.data.data,this.tanggal=new Date(this.item.tanggal),this.tanggal_internal_order=new Date(this.item.tanggal_internal_order),this.item.tanggal=this.tanggal,this.selectedJenisKendaraan=this.lJeniskendaraan.find(e=>e.id==this.item.id_jenis_kendaraan)})},selectJenisKendaraan(n){this.item.id_jenis_kendaraan=n.value.id},selectInternalTransfer(n){h.show(n.value.id).then(e=>{this.item.id=e.data.data.id,this.item.nomor=e.data.data.nomor,this.item.tanggal=e.data.data.tanggal,this.item.tanggal_kirim=e.data.data.tanggal_kirim,this.item.jam_kirim=e.data.data.jam_kirim,this.item.id_internal_order=e.data.data.id,this.item.nomor_internal_order=e.data.data.nomor_internal_order,this.item.id_gudang_asal=e.data.data.id_gudang_asal,this.item.id_gudang_tujuan=e.data.data.id_gudang_tujuan,this.item.status=e.data.data.status,this.item.gudang_asal=e.data.data.gudang_asal,this.item.gudang_tujuan=e.data.data.gudang_tujuan,this.item.id_pengirim=e.data.data.id_pengirim,this.item.detail=e.data.data.detail.map(i=>({...i,qty:parseFloat(i.qty),diterima:parseFloat(i.qty)})),this.tanggal_internal_order=this.$h.Date(e.data.data.tanggal)})},searchInternalTransfer(n){setTimeout(()=>{n.query.trim().length?this.filteredInternalTransfer=this.lInternalTransfer.filter(e=>e.nomor.toLowerCase().includes(n.query.trim().toLowerCase())):this.filteredInternalTransfer=[...this.lInternalTransfer]},250)},async submitForm(n="D"){let e=this.item.status_terima;try{if(this.isSubmit=!0,this.invalid)return;if(n=="S"){let i=!1;if(this.item.detail.forEach(o=>{o.id_barang==null&&(i=!0),o.id_barang==null&&(i=!0)}),i){this.$toast.add({severity:"warn",summary:"Warning!",detail:"Barang tidak boleh kosong",life:3e3});return}if(this.item.detail.reduce((o,a)=>o+parseFloat(a.qty),0)==0){this.$toast.add({severity:"warn",summary:"Warning!",detail:"Minimal ada 1 barang",life:3e3});return}}this.item.status_terima=n,this.isEdit?(this.item.status_terima!="X"&&(this.item.alasan=""),h.updateReceipt(this.item.id,this.item).then(i=>{this.$toast.add({severity:"success",summary:"Successful",detail:i.data.message,life:3e3})}).catch(i=>{this.$toast.add({severity:"warn",summary:"Warning",detail:i.response.data.message,life:3e3})})):h.updateReceipt(this.item.id,this.item).then(i=>{this.item.id=i.data.data.id,this.item.nomor=i.data.data.nomor,setTimeout(()=>{this.$router.push({name:"internal-receive.edit",params:{id:i.data.data.id}})},1e3),this.$toast.add({severity:"success",summary:"Successful",detail:i.data.message,life:3e3})}).catch(i=>{this.$toast.add({severity:"error",summary:"Failed",detail:i.response.data.message,life:3e3})})}catch(i){this.$toast.add({severity:"error",summary:"Failed",detail:i.response.data.message,life:3e3})}finally{this.item.status_terima=e,this.isSubmit=!1}},submitPosting(){this.submitForm("A").catch(()=>{this.item.status_terima="D"})},buttons(){return[{label:"Posting",icon:"pi pi-refresh",command:()=>{this.submitPosting()}}]}}},K={class:"grid"},R={class:"col-12"},O={class:"card"},M={class:"p-fluid formgrid grid"},W={class:"field col-12 md:col-3"},z=t("label",{for:"donumber"},"No. Internal Transfer",-1),G={class:"product-autocomplete"},Q={class:"kode"},X={class:"row"},H={class:"col-12"},Y={class:"field col-12 md:col-3"},Z={class:"p-float-label"},$=t("p",{class:"mb-1"},"Tanggal",-1),ee={class:"field col-12 md:col-3"},te={class:"field col-12 md:col-3"},ae={class:"p-float-label"},le=t("p",{class:"mb-1"},"Tanggal Internal Order",-1),ie={class:"field col-12 md:col-3"},ne={class:"field col-12 md:col-3"},se=t("div",{class:"field col-12 md:col-6"},null,-1),de={class:"field col-12 md:col-3"},oe={class:"p-float-label"},re=t("p",{class:"mb-1"},"Transporter Date",-1),me={class:"field col-12 md:col-3"},ue=t("label",{for:"transtime"},"Transporter Time",-1),_e={class:"field col-12 md:col-3"},ce={class:"p-float-label"},ge=t("p",{class:"mb-1"},"Receive Date",-1),he={class:"field col-12 md:col-3"},pe=t("label",{for:"transtime"},"Receive Time",-1),fe={class:"field col-12 md:col-12"},ye=t("label",{for:"keterangan"},"Keterangan",-1),ve={class:"col-12 my-4"},be=t("div",{class:"text-center"},"Empty",-1),ke={key:2},Te=t("br",null,null,-1),Ve={class:"grid"},Ie={class:"col-6"},we={class:"flex flex-wrap gap-3 justify-content-start"},Ce={class:"col-6"},je={class:"flex flex-wrap gap-3 justify-content-end"};function xe(n,e,i,o,a,g){const D=d("Toast"),S=d("Tag"),F=d("AutoComplete"),r=d("InputText"),v=d("Label"),T=d("Calendar"),E=d("InputNumber"),U=d("Column"),B=d("DataTable"),V=d("Button"),q=d("SplitButton"),I=N("select-all-text");return c(),k(C,null,[s(D),t("div",K,[t("div",R,[t("div",O,[t("h5",null,[f(p(a.isEdit?"Edit":"Add")+" Internal Receive ",1),s(S,{style:{float:"right"},value:n.$h.getLabel(a.item.status_terima),severity:n.$h.getLabel(a.item.status_terima)},null,8,["value","severity"])]),t("div",M,[t("div",W,[z,s(F,{modelValue:a.selectedInternalTransfer,"onUpdate:modelValue":e[0]||(e[0]=l=>a.selectedInternalTransfer=l),suggestions:a.filteredInternalTransfer,optionLabel:"nomor",virtualScrollerOptions:{itemSize:50},onComplete:g.searchInternalTransfer,onItemSelect:g.selectInternalTransfer,class:w({"p-invalid":a.isSubmit&&!a.item.id_so}),dropdown:""},{option:_(l=>[t("div",G,[t("div",Q,p(l.option.id),1),t("div",X,[t("div",H,p(l.option.nomor),1)])])]),_:1},8,["modelValue","suggestions","onComplete","onItemSelect","class"])]),t("div",Y,[t("span",Z,[$,s(r,{value:n.$h.Date(a.item.tanggal),id:"tanggal",type:"text",readonly:""},null,8,["value"])])]),t("div",ee,[s(v,{for:"itemnumber",required:""},{default:_(()=>[f("Nomor Internal Order")]),_:1}),s(r,{value:a.item.nomor_internal_order,id:"gudang_asal",type:"text",readonly:""},null,8,["value"])]),t("div",te,[t("span",ae,[le,s(T,{readonly:"",dateFormat:"dd-mm-yy",modelValue:a.tanggal_internal_order,"onUpdate:modelValue":e[1]||(e[1]=l=>a.tanggal_internal_order=l),inputId:"tanggal_internal_order"},null,8,["modelValue"])])]),t("div",ie,[s(v,{for:"gudang_asal"},{default:_(()=>[f("Gudang Asal")]),_:1}),s(r,{modelValue:a.item.gudang_asal,"onUpdate:modelValue":e[2]||(e[2]=l=>a.item.gudang_asal=l),id:"gudang_asal",type:"text",readonly:""},null,8,["modelValue"])]),t("div",ne,[s(v,{for:"gudang_tujuan"},{default:_(()=>[f("Gudang Tujuan")]),_:1}),s(r,{modelValue:a.item.gudang_tujuan,"onUpdate:modelValue":e[3]||(e[3]=l=>a.item.gudang_tujuan=l),id:"gudang_tujuan",type:"text",readonly:""},null,8,["modelValue"])]),se,t("div",de,[t("span",oe,[re,s(r,{value:n.$h.Date(a.item.tanggal_kirim),id:"tanggal_kirim",type:"text",readonly:""},null,8,["value"])])]),t("div",me,[ue,s(r,{modelValue:a.item.jam_kirim,"onUpdate:modelValue":e[4]||(e[4]=l=>a.item.jam_kirim=l),id:"transtime",type:"text",readonly:""},null,8,["modelValue"])]),t("div",_e,[t("span",ce,[ge,s(T,{dateFormat:"dd-mm-yy",modelValue:a.tanggal_terima,"onUpdate:modelValue":e[5]||(e[5]=l=>a.tanggal_terima=l),inputId:"tanggal_terima"},null,8,["modelValue"])])]),t("div",he,[pe,s(r,{modelValue:a.item.jam_terima,"onUpdate:modelValue":e[6]||(e[6]=l=>a.item.jam_terima=l),id:"transtime",type:"text"},null,8,["modelValue"])]),t("div",fe,[ye,s(r,{modelValue:a.item.keterangan,"onUpdate:modelValue":e[7]||(e[7]=l=>a.item.keterangan=l),id:"keterangan",type:"text"},null,8,["modelValue"])]),t("div",ve,[s(B,{value:a.item.detail,editMode:"cell",onCellEditComplete:g.onCellEditComplete,tableClass:"editable-cells-table p-datatable-small",tableStyle:"table-layout: auto;"},{empty:_(()=>[be]),default:_(()=>[(c(!0),k(C,null,P(a.columns,l=>(c(),y(U,{key:l.field,field:l.field,header:l.header,headerStyle:l.width,class:w(l.class)},{body:_(({data:u,field:m})=>[t("div",null,p(u[m]),1)]),editor:_(({data:u,field:m})=>[m=="diterima"?j((c(),y(E,{key:0,modelValue:u[m],"onUpdate:modelValue":b=>u[m]=b,id:"diterima",max:u.qty,minFractionDigits:1,maxFractionDigits:5},null,8,["modelValue","onUpdate:modelValue","max"])),[[I]]):m=="keterangan"?j((c(),y(r,{key:1,modelValue:u[m],"onUpdate:modelValue":b=>u[m]=b,id:"keterangan",type:"text"},null,8,["modelValue","onUpdate:modelValue"])),[[I]]):(c(),k("div",ke,p(u[m]),1))]),_:2},1032,["field","header","headerStyle","class"]))),128))]),_:1},8,["value","onCellEditComplete"])])]),Te,t("div",Ve,[t("div",Ie,[t("div",we,[s(V,{label:"Back",severity:"secondary",iconPos:"left",icon:"pi pi-arrow-left",onClick:e[8]||(e[8]=l=>this.$router.back())}),s(V,{label:"print",severity:"help",iconPos:"left",icon:"pi pi-print"})])]),t("div",Ce,[t("div",je,[x("",!0),a.item.status_terima=="D"?(c(),y(q,{key:1,label:"Save",onClick:e[10]||(e[10]=l=>g.submitForm()),model:g.buttons(),disabled:a.isSubmit},null,8,["model","disabled"])):x("",!0)])])])])])])],64)}const Ue=J(A,[["render",xe]]);export{Ue as default};
