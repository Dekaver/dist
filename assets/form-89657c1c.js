import{a as M}from"./options-b2eb7ae6.js";import{a as O}from"./api-f000d862.js";import{a as j}from"./api-917068af.js";import"./custom-zod-e9521e5d.js";import{A as te}from"./index-b9e295bc.js";import{_ as ae,j as le,y as se,r as y,A as oe,o as m,c as v,d as s,b as t,l as g,t as h,e as c,n as S,f as w,m as C,q as R,k,C as ie,B as P}from"./index-11eb6111.js";import{z as p}from"./index-0ec66d4d.js";const z=p.object({tanggal:p.date(),referensi:p.string().min(1),id_customer:p.number(),id_salesman:p.number(),id_gudang:p.number(),id_so:p.number(),kepada:p.string().min(1),alamat:p.string().min(1),keterangan:p.string().nullish()}),H=p.object({id_barang:p.number().nullish(),id_satuan:p.number(),qty:p.coerce.number().gte(0),keterangan:p.string().nullish(),catatan:p.string().max(255).nullish(),nama_barang:p.string().min(1)}),ne=z.extend({status:p.literal("D"),detail:p.array(H)}),K=z.extend({status:p.literal("C"),detail:p.array(H).refine(o=>o.some(e=>e.qty>0),{message:"Minimal harus ada satu Produk dikirim",path:["detail"]})}),re=K.extend({status:p.literal("S")}),de=p.discriminatedUnion("status",[ne,re,K]),ue={data(){return{gudangStore:le(),settingStore:se(),item:{id:null,nomor:null,no_so:null,tanggal:null,referensi:null,id_customer:null,id_salesman:null,id_gudang:null,id_so:null,status:null,gudang:null,customer:null,kepada:null,alamat:null,telepon:null,hp:null,email:null,driver:null,driver_hp:null,sipb:null,lic_plate:null,tgl_transporter:null,transporter:null,transporter_time:null,keterangan:null,detail:[{type:"produk",nama_barang:null}]},nullDetail:null,lSo:[],selectedSo:null,filteredlSo:[],lProduk:[],lSatuan:[],columns:[{field:"nama_barang",header:"Produk/Jasa",width:"15%",class:"left",editor:!1},{field:"keterangan",header:"Deskripsi",width:"15%",class:"left",editor:!1},{field:"qty",header:"Kuantitas",width:"15%",class:"left",editor:!0},{field:"selectedSatuan",header:"Satuan",width:"15%",class:"left",editor:!0},{field:"catatan",header:"Catatan",width:"15%",class:"left",editor:!0}],datetransporter:null,isMore:!1,showPersetujuanDialog:!1,product:{},filters:{},status:null,isEdit:!1,isClean:!0}},computed:{FormItem(){return{...this.item,status:this.status,detail:this.item.detail.filter(o=>o.qty>0)}},FormError(){var o,e;return this.isClean?{}:((e=(o=de.safeParse(this.FormItem))==null?void 0:o.error)==null?void 0:e.format())||{}},canPersetujuan(){var i;const o=(i=this.item.persetujuan)==null?void 0:i.find(n=>n.id_pegawai==this.$auth.id&&n.tanggal_persetujuan==null),e=o?this.item.persetujuan.find(n=>n.urut<o.urut&&n.status===!0):null;return o&&(e||(o==null?void 0:o.urut)==1)}},mounted(){this.$isLoading.value=!1,this.item.id=this.$route.params.id,this.isEdit=!!this.$route.params.id,this.nullDetail={...this.item.detail[0]},this.getData().then(()=>{if(this.isEdit){this.getDeliveryOrder();return}this.item.tanggal=new Date,this.datetransporter=new Date,this.item.tgl_transporter=new Date})},methods:{onCellEditComplete(o){let{data:e,newValue:i,field:n}=o;switch(n){case"qty":e[n]=i;break;case"selectedSatuan":if(!i)return;e[n]=i,e.id_satuan=i.id;break;case"keterangan":e[n]=i;break;case"catatan":e[n]=i;break}},async getData(){await O.index({type:"option",module:"do"}).then(o=>{this.lSo=o.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Sales Order",life:3e3})}),await M.getProduk().then(o=>{this.lProduk=o.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Barang",life:3e3})}),await M.getSatuan().then(o=>{this.lSatuan=o.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Satuan Barang",life:3e3})})},async getDeliveryOrder(){this.isEdit&&await j.show(this.item.id).then(o=>{this.item=o.data.data,this.item.date_so=new Date(this.item.date_so),this.tanggal_referensi=this.item.tgl_ref==null?null:new Date(this.item.tgl_ref),this.item.tanggal=new Date(this.item.tanggal),this.selectedSo=this.item.nomor_so,this.item.detail.forEach(e=>{if(e.id_barang){let i=this.lProduk.find(n=>n.id==e.id_barang);e.option_satuan=i.option_satuan,e.selectedSatuan=e.option_satuan.find(n=>n.id==e.id_satuan)}else e.option_satuan=[],e.selectedSatuan=this.lSatuan.find(i=>i.id==e.id_satuan)})})},async selectSo(o){await O.show(o.value.id).then(e=>{const i=e.data.data;this.item.id_so=i.id,this.item.referensi=i.referensi,this.item.no_so=i.nomor,this.item.date_so=new Date(i.tanggal),this.item.id_gudang=i.id_gudang,this.item.id_salesman=i.id_salesman,this.item.id_customer=i.id_customer,this.item.gudang=i.gudang,this.item.customer=i.customer,this.item.kepada=i.kepada,this.item.telepon=i.telepon,this.item.email=i.email,this.item.alamat=i.deliverypoint,this.item.hp=i.hp,this.item.detail=i.detail,this.item.detail.filter(n=>n.sisa!=0).forEach(n=>{if(n.id_barang){let l=this.lProduk.find(r=>r.id==n.id_barang);n.option_satuan=l.option_satuan,n.selectedSatuan=n.option_satuan.find(r=>r.id==n.id_satuan)}else n.option_satuan=[],n.selectedSatuan=this.lSatuan.find(l=>l.id==n.id_satuan);n.qty=n.sisa,n.keterangan=n.note})})},searchSo(o){setTimeout(()=>{this.filteredlSo=o.query.trim().length?this.lSo.filter(e=>{const i=o.query.trim().toLowerCase();return["nomor","referensi","gudang","customer"].some(n=>{var l;return(l=e[n])==null?void 0:l.toLowerCase().includes(i)})}):[...this.lSo]},250)},clearSo(){this.item.id_so=null,this.item.referensi=null,this.item.no_so=null,this.item.id_gudang=null,this.item.id_salesman=null,this.item.id_customer=null,this.item.gudang=null,this.item.customer=null,this.item.kepada=null,this.item.telepon=null,this.item.email=null,this.item.alamat=null,this.item.hp=null,this.item.detail=[{...this.nullDetail}]},async Save(o="D"){try{if(this.$isLoading.value=!0,this.isClean=!1,this.status=o,Object.keys(this.FormError).length>0)return;this.isEdit?(this.item.status!="X"&&(this.item.alasan=""),await j.update(this.item.id,this.FormItem).then(e=>{this.item.status=e.data.data.status,this.item.persetujuan=e.data.data.persetujuan,this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3})})):await j.store(this.FormItem).then(e=>{this.item.id=e.data.data.id,this.item.nomor=e.data.data.nomor,this.item.status=e.data.data.status,this.item.persetujuan=e.data.data.persetujuan,setTimeout(()=>{this.$router.replace({name:"do.edit",params:{id:e.data.data.id}})},1e3),this.isEdit=!0,this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3})}),this.isClean=!0}catch(e){e instanceof te&&this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}finally{this.$timeoutLoading()}},confirmApprove(){this.showPersetujuanDialog=!0,this.item.keterangan="",this.isApprove=!0},confirmReject(){this.showPersetujuanDialog=!0,this.item.keterangan="",this.isApprove=!1},async submitPersetujuan(o=!1){const e={id:this.item.id,status:o,keterangan:this.item.keterangan};this.$isLoading.value=!0,await j.updatePersetujuan(e).then(i=>{this.item.status=i.data.data.update_status||this.item.status,this.item.persetujuan.forEach(n=>{n.urut==i.data.data.urut&&(n.tanggal_persetujuan=i.data.data.tanggal_persetujuan,n.status=i.data.data.status,n.keterangan=i.data.data.keterangan)}),this.$toast.add({severity:"success",summary:"Successful",detail:"Update persetujuan",life:3e3}),this.showPersetujuanDialog=!1}).catch(i=>{this.$toast.add({severity:"error",summary:"Error",detail:i,life:3e3})}).finally(()=>{this.$timeoutLoading(),this.showPersetujuanDialog=!1}),this.showPersetujuanDialog=!1},cetakPDF(){this.$router.push({name:"do.cetak",params:this.item.id})}}},me={class:"grid"},ce={class:"col-12"},pe={class:"card"},he={class:"p-fluid formgrid grid"},_e={class:"field col-12 md:col-3"},ge={class:"grid"},fe={class:"col-4"},ye={class:"text-green-500"},be={class:"text-green-600 font-bold"},ve={class:"col-4"},ke={class:"text-blue-500"},Ve={class:"text-blue-600 font-bold"},Se={class:"col-4"},we={class:""},De={class:"font-bold",style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},Ce={class:"field col-12 md:col-2"},je={class:"field col-12 md:col-3"},xe=t("div",{class:"col-12"},null,-1),Ee={class:"field col-12 md:col-3"},Ue={class:"field col-12 md:col-2"},Pe={class:"field col-12 md:col-3"},Fe=t("div",{class:"col-12"},null,-1),qe={class:"field col-12 md:col-2"},Le={class:"field col-12 md:col-2"},Te={key:0,class:"field col-12 md:col-2"},Ie=t("div",{class:"col-12"},null,-1),Ae={class:"col-12"},Be={class:"flex align-items-center"},Ne=t("hr",null,null,-1),Me={class:"p-fluid formgrid grid"},Oe={class:"field col-12 md:col-3"},Re={class:"field col-12 md:col-3"},ze={class:"field col-12 md:col-2"},He={class:"field col-12 md:col-2"},Ke={class:"p-float-label"},Ye=t("p",{class:"mb-1"},"Tanggal Pengiriman",-1),Ge={class:"field col-12 md:col-2"},Je={class:"field col-12 md:col-3"},We={class:"field col-12 md:col-2"},Xe={class:"col-12 my-4"},Qe=t("div",{class:"text-center"},"Empty",-1),Ze={class:"flex align-items-center gap-2"},$e={class:"capitalize"},et={key:0},tt={key:1},at={key:0,class:"flex flex-column"},lt={class:"text-green-500"},st={key:2},ot={class:"flex flex-column"},it={class:""},nt={key:5},rt={class:"col-12 md:col-6"},dt=t("span",{class:"ql-formats"},[t("button",{class:"ql-bold",type:"button"}),t("button",{class:"ql-italic",type:"button"}),t("button",{class:"ql-underline",type:"button"})],-1),ut=t("span",{class:"ql-formats"},[t("button",{class:"ql-list",value:"ordered",type:"button"}),t("button",{class:"ql-list",value:"bullet",type:"button"}),t("select",{class:"ql-align"},[t("option",{defaultValue:""}),t("option",{value:"center"}),t("option",{value:"right"}),t("option",{value:"justify"})])],-1),mt=t("div",{class:"field col-12"},null,-1),ct={class:"col-12 md:col-6"},pt={key:0,class:"p-datatable col-6"},ht={class:"p-datatable-table p-datatable-striped"},_t=t("thead",{class:"p-datatable-thead"},[t("tr",{role:"row"},[t("th",{colspan:"7",class:"text-left"},"Harus Disetujui Oleh:")]),t("tr",null,[t("th",null,"No"),t("th",null,"Nama"),t("th",null,"Jabatan"),t("th",null,"Tanggal"),t("th",null,"Status"),t("th",null,"Keterangan")])],-1),gt={class:"p-datatable-tbody"},ft={key:0},yt={key:1},bt={key:2},vt={class:"grid"},kt=t("div",{class:"col-6"},[t("div",{class:"flex flex-wrap gap-3 justify-content-start"})],-1),Vt={class:"col-6"},St={class:"flex flex-wrap gap-3 justify-content-end"},wt=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Masukkan Catatan")],-1);function Dt(o,e,i,n,l,r){var T,I,A,B,N;const Y=y("Toast"),G=y("Tag"),f=y("Label"),F=y("AutoComplete"),V=y("ErrorMsg"),x=y("Calendar"),b=y("InputText"),J=y("Checkbox"),E=y("Column"),D=y("Button"),q=y("Dropdown"),W=y("InputNumber"),X=y("DataTable"),Q=y("Editor"),L=y("Textarea"),Z=y("SubmitButton"),$=y("Dialog"),U=oe("select-all-text");return m(),v(C,null,[s(Y),t("div",me,[t("div",ce,[t("div",pe,[t("h5",null,[g(h(l.isEdit?"Ubah":"Tambah")+" Pengiriman Barang ",1),s(G,{style:{float:"right"},value:o.$h.getLabel(l.item.status),severity:o.$h.getLabel(l.item.status)},null,8,["value","severity"])]),t("div",he,[t("div",_e,[s(f,{for:"pesanan",required:""},{default:c(()=>[g("No. Pesanan Penjualan")]),_:1}),s(F,{inputId:"pesanan",modelValue:l.selectedSo,"onUpdate:modelValue":e[0]||(e[0]=a=>l.selectedSo=a),suggestions:l.filteredlSo,optionLabel:"nomor",onComplete:r.searchSo,onItemSelect:r.selectSo,class:S(r.FormError.id_so&&"p-invalid"),onClear:r.clearSo,dropdown:""},{option:c(a=>[t("div",ge,[t("div",fe,[t("small",ye,h(o.$h.formatDate(a.option.tanggal)),1),t("div",be,h(a.option.nomor),1)]),t("div",ve,[t("small",ke,h(o.$h.formatDate(a.option.tanggal_referensi)),1),t("div",Ve,h(a.option.referensi),1)]),t("div",Se,[t("div",we,h(a.option.gudang),1),t("div",De,h(a.option.customer),1)])])]),_:1},8,["modelValue","suggestions","onComplete","onItemSelect","class","onClear"]),s(V,{error:r.FormError.id_so},null,8,["error"])]),t("div",Ce,[s(f,{required:"",class:"mb-1"},{default:c(()=>[g("Tanggal Pesanan")]),_:1}),s(x,{readonly:"",modelValue:l.item.date_so,"onUpdate:modelValue":e[1]||(e[1]=a=>l.item.date_so=a),inputId:"date_so"},null,8,["modelValue"]),s(V,{error:r.FormError.tanggal},null,8,["error"])]),t("div",je,[s(f,{required:"",for:"nopo"},{default:c(()=>[g("No. Referensi")]),_:1}),s(b,{modelValue:l.item.referensi,"onUpdate:modelValue":e[2]||(e[2]=a=>l.item.referensi=a),id:"nopo",readonly:"",class:S(r.FormError.referensi&&"p-invalid")},null,8,["modelValue","class"]),s(V,{error:r.FormError.referensi},null,8,["error"])]),xe,t("div",Ee,[s(f,{required:"",for:"customer"},{default:c(()=>[g("Pelanggan")]),_:1}),s(b,{modelValue:l.item.customer,"onUpdate:modelValue":e[3]||(e[3]=a=>l.item.customer=a),id:"customer",readonly:"",class:S(r.FormError.id_customer&&"p-invalid")},null,8,["modelValue","class"]),s(V,{error:r.FormError.id_customer},null,8,["error"])]),t("div",Ue,[s(f,{required:"",for:"phone"},{default:c(()=>[g("Telepon")]),_:1}),s(b,{modelValue:l.item.hp,"onUpdate:modelValue":e[4]||(e[4]=a=>l.item.hp=a),id:"phone",inputId:"withoutgrouping"},null,8,["modelValue"]),s(V,{error:r.FormError.hp},null,8,["error"])]),t("div",Pe,[s(f,{required:"",for:"contactpeson"},{default:c(()=>[g("Kepada")]),_:1}),s(b,{modelValue:l.item.kepada,"onUpdate:modelValue":e[5]||(e[5]=a=>l.item.kepada=a),id:"contactpeson",class:S(r.FormError.kepada&&"p-invalid")},null,8,["modelValue","class"]),s(V,{error:r.FormError.kepada},null,8,["error"])]),Fe,t("div",qe,[s(f,{required:"",class:"mb-1"},{default:c(()=>[g("Tanggal")]),_:1}),s(x,{modelValue:l.item.tanggal,"onUpdate:modelValue":e[6]||(e[6]=a=>l.item.tanggal=a),inputId:"tanggal",maxDate:o.$h.today},null,8,["modelValue","maxDate"])]),t("div",Le,[s(f,{for:"donumber"},{default:c(()=>[g("Nomor")]),_:1}),s(b,{modelValue:l.item.nomor,"onUpdate:modelValue":e[7]||(e[7]=a=>l.item.nomor=a),id:"donumber",disabled:""},null,8,["modelValue"]),s(V,{error:r.FormError.nomor},null,8,["error"])]),l.gudangStore.count>1?(m(),v("div",Te,[s(f,{required:"",for:"gudang"},{default:c(()=>[g("Gudang")]),_:1}),s(b,{modelValue:l.item.gudang,"onUpdate:modelValue":e[8]||(e[8]=a=>l.item.gudang=a),id:"gudang",readonly:""},null,8,["modelValue"]),s(V,{error:r.FormError.id_gudang},null,8,["error"])])):w("",!0),Ie,t("div",Ae,[t("div",Be,[s(J,{modelValue:l.isMore,"onUpdate:modelValue":e[9]||(e[9]=a=>l.isMore=a),inputId:"is_more",binary:!0},null,8,["modelValue"]),s(f,{for:"is_more",class:"ml-2"},{default:c(()=>[g(" More .. ")]),_:1})]),Ne]),t("div",{class:S(["col-12",{hidden:!l.isMore}])},[t("div",Me,[t("div",Oe,[s(f,{for:"sipb"},{default:c(()=>[g("SIPB")]),_:1}),s(b,{modelValue:l.item.sipb,"onUpdate:modelValue":e[10]||(e[10]=a=>l.item.sipb=a),id:"sipb"},null,8,["modelValue"])]),t("div",Re,[s(f,{for:"transporter"},{default:c(()=>[g("Kendaraan")]),_:1}),s(b,{modelValue:l.item.transporter,"onUpdate:modelValue":e[11]||(e[11]=a=>l.item.transporter=a),id:"transporter"},null,8,["modelValue"])]),t("div",ze,[s(f,{for:"licplate"},{default:c(()=>[g("Plat Nomor")]),_:1}),s(b,{modelValue:l.item.lic_plate,"onUpdate:modelValue":e[12]||(e[12]=a=>l.item.lic_plate=a),id:"licplate"},null,8,["modelValue"])]),t("div",He,[t("span",Ke,[Ye,s(x,{modelValue:l.datetransporter,"onUpdate:modelValue":e[13]||(e[13]=a=>l.datetransporter=a),inputId:"datetransporter"},null,8,["modelValue"])])]),t("div",Ge,[s(f,{for:"transtime"},{default:c(()=>[g("Waktu Pengiriman")]),_:1}),s(b,{modelValue:l.item.transporter_time,"onUpdate:modelValue":e[14]||(e[14]=a=>l.item.transporter_time=a),id:"transtime"},null,8,["modelValue"])]),t("div",Je,[s(f,{for:"driver"},{default:c(()=>[g("Nama Driver")]),_:1}),s(b,{modelValue:l.item.driver,"onUpdate:modelValue":e[15]||(e[15]=a=>l.item.driver=a),id:"driver"},null,8,["modelValue"])]),t("div",We,[s(f,{for:"driver_hp"},{default:c(()=>[g("No. HP")]),_:1}),s(b,{modelValue:l.item.driver_hp,"onUpdate:modelValue":e[16]||(e[16]=a=>l.item.driver_hp=a),id:"driver_hp"},null,8,["modelValue"])])])],2),t("div",Xe,[s(X,{value:l.item.detail,editMode:"cell",onCellEditComplete:r.onCellEditComplete,tableClass:"editable-cells-table p-datatable-small",tableStyle:"table-layout: auto;"},{empty:c(()=>[Qe]),default:c(()=>[s(E,{header:"#",headerStyle:"width:10px;"},{body:c(({index:a})=>[g(h(a+1),1)]),_:1}),s(E,{header:"Tipe",headerStyle:"width:5%;"},{body:c(({data:a})=>[t("div",Ze,[s(D,{icon:a.type=="produk"?"pi pi-box":"pi pi-briefcase",severity:a.type=="produk"?"primary":"secondary"},null,8,["icon","severity"]),t("span",$e,h(a.type),1)])]),_:1}),(m(!0),v(C,null,R(l.columns,a=>(m(),k(E,{key:a.field,field:a.field,header:a.header,headerStyle:a.width,class:S(a.class)},ie({body:c(({data:d,field:u,index:_})=>[u=="selectedSatuan"?(m(),v("div",et,h(d[u]&&d[u].satuan),1)):u=="nama_barang"?(m(),v("div",tt,[d.type=="produk"?(m(),v("span",at,[t("small",lt,h(d.kode_barang),1),t("span",null,h(d.nama_barang),1)])):(m(),k(b,{key:1,modelValue:d[u],"onUpdate:modelValue":ee=>d[u]=ee,name:"nama_barang",class:"min-w-max"},null,8,["modelValue","onUpdate:modelValue"]))])):(m(),v("div",st,h(d[u]),1)),r.FormError.detail&&r.FormError.detail[_]?(m(),k(V,{key:3,error:r.FormError.detail[_][a.error?a.error:u]},null,8,["error"])):w("",!0)]),_:2},[l.item.status!="C"&&a.editor?{name:"editor",fn:c(({data:d,field:u})=>[u=="nama_barang"?(m(),v(C,{key:0},[d.type=="produk"?(m(),k(F,{key:0,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,suggestions:o.filteredlProduk,optionLabel:"nama_barang",virtualScrollerOptions:{itemSize:50},onComplete:o.searchProduk,class:"min-w-max",dropdown:"",onDropdownClick:o.searchAllProduk},{option:c(_=>[t("div",ot,[t("small",{class:S(_.option.is_stok?"text-green-500":"text-blue-500")},h(_.option.kode_barang),3),t("div",it,h(_.option.nama_barang),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","suggestions","onComplete","onDropdownClick"])):(m(),k(b,{key:1,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,name:"nama_barang",class:"min-w-max"},null,8,["modelValue","onUpdate:modelValue"]))],64)):u=="keterangan"?P((m(),k(b,{key:1,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,id:"keterangan"},null,8,["modelValue","onUpdate:modelValue"])),[[U]]):u=="catatan"?P((m(),k(b,{key:2,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,id:"catatan"},null,8,["modelValue","onUpdate:modelValue"])),[[U]]):u=="selectedSatuan"?(m(),v(C,{key:3},[d.type=="produk"?(m(),k(q,{key:0,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,id:"satuan",options:d.option_satuan,optionLabel:"satuan",class:"min-w-max"},null,8,["modelValue","onUpdate:modelValue","options"])):(m(),k(q,{key:1,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,id:"satuan",options:l.lSatuan,optionLabel:"satuan",class:"min-w-max"},null,8,["modelValue","onUpdate:modelValue","options"]))],64)):u=="qty"?P((m(),k(W,{key:4,modelValue:d[u],"onUpdate:modelValue":_=>d[u]=_,id:"qty",minFractionDigits:1,maxFractionDigits:5},null,8,["modelValue","onUpdate:modelValue"])),[[U]]):(m(),v("div",nt,h(d[u]),1))]),key:"0"}:void 0]),1032,["field","header","headerStyle","class"]))),128))]),_:1},8,["value","onCellEditComplete"]),s(V,{error:(I=(T=r.FormError)==null?void 0:T.detail)==null?void 0:I.detail},null,8,["error"])]),t("div",rt,[s(f,{for:"notes"},{default:c(()=>[g("Catatan")]),_:1}),s(Q,{id:"syarat",rows:"5",modelValue:l.item.syarat,"onUpdate:modelValue":e[17]||(e[17]=a=>l.item.syarat=a),editorStyle:r.FormError.syarat&&"border: 1px red solid !important"},{toolbar:c(()=>[dt,ut]),_:1},8,["modelValue","editorStyle"])]),mt,t("div",ct,[s(f,{required:"",for:"address"},{default:c(()=>[g("Alamat Pengiriman")]),_:1}),s(L,{modelValue:l.item.alamat,"onUpdate:modelValue":e[18]||(e[18]=a=>l.item.alamat=a),id:"address",required:"true",rows:"3",class:S(r.FormError.alamat&&"p-invalid")},null,8,["modelValue","class"]),s(V,{error:r.FormError.alamat},null,8,["error"])])]),((A=l.item.persetujuan)==null?void 0:A.length)>0&&!this.$route.query.revisi?(m(),v("div",pt,[t("table",ht,[_t,t("tbody",gt,[(m(!0),v(C,null,R(l.item.persetujuan,(a,d)=>(m(),v("tr",{key:d},[t("td",null,h(d+1),1),t("td",null,h(a.nama),1),t("td",null,h(a.jabatan),1),t("td",null,h(o.$h.formatDate(a.tanggal_persetujuan,"DD-MM-YYYY HH:mm:ss")),1),a.tanggal_persetujuan!=null&&!a.status?(m(),v("td",ft,"Reject")):a.tanggal_persetujuan!=null&&a.status?(m(),v("td",yt,"Approve")):(m(),v("td",bt,"Menunggu Persetujuan")),t("td",null,h(a.keterangan),1)]))),128))])])])):w("",!0),t("div",vt,[kt,t("div",Vt,[t("div",St,[!r.canPersetujuan&&!((N=(B=l.item.persetujuan)==null?void 0:B[0])!=null&&N.tanggal_persetujuan)&&l.item.status!="C"?(m(),k(Z,{key:0,loading:o.$isLoading.value,data:l.item,onClick:e[19]||(e[19]=a=>{var d;return r.Save((d=l.settingStore.penjualan.persetujuan.deliveryorder)!=null&&d.persetujuan1?"S":"C")}),onDraft:e[20]||(e[20]=a=>r.Save("D")),showDraft:l.item.status=="D"||l.item.status==null},null,8,["loading","data","showDraft"])):w("",!0),l.item.status=="S"&&r.canPersetujuan?(m(),k(D,{key:1,label:"Reject",severity:"danger",iconPos:"right",icon:"pi pi-times",onClick:r.confirmReject,class:"mx-2"},null,8,["onClick"])):w("",!0),l.item.status=="S"&&r.canPersetujuan?(m(),k(D,{key:2,label:"Approve",severity:"success",iconPos:"right",icon:"pi pi-check",onClick:r.confirmApprove},null,8,["onClick"])):w("",!0)])])])]),s($,{visible:l.showPersetujuanDialog,"onUpdate:visible":e[24]||(e[24]=a=>l.showPersetujuanDialog=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:c(()=>[s(D,{label:"Close",icon:"pi pi-times",class:"p-button-text text-red-500",onClick:e[22]||(e[22]=a=>l.showPersetujuanDialog=!1)}),s(D,{label:o.isApprove?"Approve":"Reject",icon:"pi pi-check",class:"p-button-text",onClick:e[23]||(e[23]=a=>r.submitPersetujuan(o.isApprove))},null,8,["label"])]),default:c(()=>[wt,s(L,{class:"w-full",modelValue:l.item.keterangan,"onUpdate:modelValue":e[21]||(e[21]=a=>l.item.keterangan=a),rows:"5",cols:"30",placeholder:"Optional"},null,8,["modelValue"])]),_:1},8,["visible"])])])],64)}const qt=ae(ue,[["render",Dt]]);export{qt as default};
