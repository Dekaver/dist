import{a as k}from"./produk-90d88791.js";import{_ as x,$ as C,r as d,o as u,c as h,b as e,d as s,e as _,t as c,l as p,m as B,q as D,k as G,n as j}from"./index-11eb6111.js";const S={data(){return{item:{kode_barang:null,nama_barang:null,keterangan:null,kategori:null,satuan:null,detail:[{tanggal:null,id_barang:null,jumlah_pengeluaran:"0",jumlah_penerimaan:"0"}]},lBarang:[],lGudang:[],f:{selectedBarang:null,selectedGudang:null,selectedBulan:null,bulan:[{id:1,nama:"Januari"},{id:2,nama:"February"},{id:3,nama:"Maret"},{id:4,nama:"April"},{id:5,nama:"Mei"},{id:6,nama:"Juni"},{id:7,nama:"Juli"},{id:8,nama:"Agustus"},{id:9,nama:"September"},{id:10,nama:"Oktober"},{id:11,nama:"November"},{id:12,nama:"Desember"}],tahun:null,filteredBarang:[],filteredGudang:[]},columns:[{field:"jenis",header:"Jenis",width:"15%",class:"left"},{field:"nomor",header:"Nomor",width:"15%",class:"left"},{field:"tanggal",header:"Tanggal",width:"15%",class:"left"},{field:"keterangan",header:"Keterangan",width:"15%",class:"left"},{field:"jumlah_penerimaan",header:"Masuk",width:"15%",class:"right"},{field:"jumlah_pengeluaran",header:"Keluar",width:"15%",class:"right"},{field:"jumlah_stok",header:"Stok Akhir",width:"10%",class:"right"}],tanggal:null,tgl_mulai:null,tgl_selesai:null,submitted:!1,cancelDialog:!1}},computed:{label:function(){switch(this.item.status){case"D":return"draft";case"P":return"posting";case"C":return"close";case"X":return"cancel";default:return"-"}}},watch:{f:{handler:function(t){t.selectedBarang!=null&&t.selectedGudang!=null&&t.selectedBulan!=null&&typeof t.selectedBarang=="object"&&typeof t.selectedGudang=="object"&&this.getHistoryStok()},deep:!0,flush:"sync",immediate:!0}},mounted(){this.id=this.$route.params.id?this.$route.params.id:null,this.item.id=this.id,this.getData(),this.f.selectedBulan=this.f.bulan.find(t=>t.id==new Date().getMonth()+1),this.f.tahun=new Date().getFullYear()},methods:{getPriority(){switch(this.item.status_wo){case"N":return"Normal";case"P":return"Prioritas";case"U":return"Urgent";default:return"-"}},formatNumber(t){return t=t??0,t.toLocaleString("id-ID",{style:"currency",currency:"IDR"})},formatDate(t){if(t!=null){let a=new Date(t);return[a.getDate().toString().padStart(2,"0"),(a.getMonth()+1).toString().padStart(2,"0"),a.getFullYear()].join("-")}},async getData(){await k.index().then(t=>{this.lBarang=t.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Work Order",life:3e3})}),await C.index().then(t=>{this.lGudang=t.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Work Order",life:3e3})})},getHistoryStok(){let t=this.f.selectedBarang.id,a=this.f.selectedGudang.id,b=this.f.selectedBulan.id,y=this.f.tahun;k.getHistoryStok(t,a,b,y).then(n=>{this.item=n.data.data;var m=0;for(let i=0;i<this.item.detail.length;i++){const r=this.item.detail[i];r.jumlah_stok=m+parseFloat(r.jumlah_penerimaan)-r.jumlah_pengeluaran,m=r.jumlah_stok}}).finally(()=>{})},searchBarang(t){setTimeout(()=>{t.query.trim().length?this.f.filteredBarang=this.lBarang.filter(a=>a.nama_barang.toLowerCase().includes(t.query.toLowerCase())||a.kode_barang.toLowerCase().includes(t.query.toLowerCase())):this.f.filteredBarang=[...this.lBarang]},250)},searchGudang(t){setTimeout(()=>{t.query.trim().length?this.f.filteredGudang=this.lGudang.filter(a=>a.gudang.toLowerCase().includes(t.query.toLowerCase())):this.f.filteredGudang=[...this.lGudang]},250)},filters:{pretty:function(t){return JSON.stringify(JSON.parse(t),null,2)}}}},L={id:"form-card",class:"card"},N={class:"p-fluid formgrid grid"},T={class:"field col-4"},U=e("label",{for:"work_order",class:"mb-2"},"Barang",-1),F={class:"flex align-options-center"},q={class:"field col-4"},J=e("label",{for:"work_order",class:"mb-2"},"Gudang",-1),A={class:"flex align-options-center"},M={class:"field col-2"},O=e("label",{for:"bulan",class:"mb-2"},[p("Bulan"),e("small",{class:"text-red-500"},"*")],-1),I={class:"field col-2"},K=e("label",{for:"tahun",class:"mb-2"},[p("Tahun"),e("small",{class:"text-red-500"},"*")],-1),P={id:"form-card",class:"card"},H={class:"p-fluid formgrid grid"},W={class:"field col-2"},Y=e("label",{for:"nama_jobs"},"Nama Barang",-1),z={class:"field col-2"},E={class:"p-float-label"},R=e("p",{class:"mb-1"},"Kode Barang",-1),X={class:"field col-4"},Q=e("label",{for:"satuan"},"Satuan",-1),Z={class:"field col-4"},$=e("label",{for:"kategori_barang",class:"mb-2"},"Kategori Barang",-1),ee=e("div",{class:"col-12"},null,-1),te={class:"col-12 my-4"},ae={key:0},le={key:1},ne={key:2,style:{"text-align":"center"}},se=e("br",null,null,-1),oe={class:"grid"},ie={class:"col-6"},re={class:"flex flex-wrap gap-3 justify-content-start"};function de(t,a,b,y,n,m){const i=d("AutoComplete"),r=d("Dropdown"),g=d("InputText"),w=d("Column"),V=d("DataTable"),v=d("Button");return u(),h(B,null,[e("div",L,[e("div",N,[e("div",T,[U,s(i,{id:"work_order",modelValue:n.f.selectedBarang,"onUpdate:modelValue":a[0]||(a[0]=l=>n.f.selectedBarang=l),optionLabel:"nama_barang",suggestions:n.f.filteredBarang,onComplete:m.searchBarang,dropdown:""},{option:_(l=>[e("div",F,[e("table",null,[e("tr",null,[e("td",null,c(l.option.kode_barang),1),e("td",null,c(l.option.nama_barang),1)])])])]),_:1},8,["modelValue","suggestions","onComplete"])]),e("div",q,[J,s(i,{id:"work_order",modelValue:n.f.selectedGudang,"onUpdate:modelValue":a[1]||(a[1]=l=>n.f.selectedGudang=l),optionLabel:"gudang",suggestions:n.f.filteredGudang,onComplete:m.searchGudang,dropdown:""},{option:_(l=>[e("div",A,[e("table",null,[e("tr",null,[e("td",null,c(l.option.gudang),1)])])])]),_:1},8,["modelValue","suggestions","onComplete"])]),e("div",M,[O,s(r,{id:"bulan",modelValue:n.f.selectedBulan,"onUpdate:modelValue":a[2]||(a[2]=l=>n.f.selectedBulan=l),options:n.f.bulan,optionLabel:"nama"},null,8,["modelValue","options"])]),e("div",I,[K,s(g,{id:"tahun",type:"text",modelValue:n.f.tahun,"onUpdate:modelValue":a[3]||(a[3]=l=>n.f.tahun=l)},null,8,["modelValue"])])])]),e("div",P,[e("div",H,[e("div",W,[Y,s(g,{id:"nama_jobs",type:"text",modelValue:n.item.nama_barang,"onUpdate:modelValue":a[4]||(a[4]=l=>n.item.nama_barang=l),readonly:""},null,8,["modelValue"])]),e("div",z,[e("span",E,[R,s(g,{id:"kode_barang",type:"text",modelValue:n.item.kode_barang,"onUpdate:modelValue":a[5]||(a[5]=l=>n.item.kode_barang=l),readonly:""},null,8,["modelValue"])])]),e("div",X,[Q,s(g,{id:"satuan",type:"text",modelValue:n.item.satuan,"onUpdate:modelValue":a[6]||(a[6]=l=>n.item.satuan=l),readonly:""},null,8,["modelValue"])]),e("div",Z,[$,s(g,{id:"kategori_barang",type:"text",value:n.item.kategori_barang,readonly:""},null,8,["value"])]),ee,e("div",te,[s(V,{value:n.item.detail,tableClass:"editable-cells-table p-datatable-small",tableStyle:"table-layout: auto;"},{empty:_(()=>[p(" Barang belum ada transaksi. ")]),default:_(()=>[(u(!0),h(B,null,D(n.columns,l=>(u(),G(w,{key:l.field,field:l.field,header:l.header,headerStyle:l.width,class:j(l.class)},{body:_(({data:f,field:o})=>[o=="jenis"||o=="keterangan"||o=="nomor"?(u(),h("div",ae,c(f[o]),1)):o=="tanggal"?(u(),h("div",le,c(t.$h.formatDate(f[o])),1)):(u(),h("div",ne,c(f[o]),1))]),_:2},1032,["field","header","headerStyle","class"]))),128))]),_:1},8,["value"])])]),se,e("div",oe,[e("div",ie,[e("div",re,[s(v,{label:"Back",severity:"secondary",iconPos:"left",icon:"pi pi-arrow-left",onClick:a[7]||(a[7]=l=>this.$router.back())})])])])])],64)}const me=x(S,[["render",de]]);export{me as default};
