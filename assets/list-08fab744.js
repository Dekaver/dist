import{D as m,_ as T,v as P,X as L,F as B,r as n,o as k,c as D,b as s,d as l,e as a,t as h,l as p,f as K,p as M,g as U}from"./index-11eb6111.js";import{z as u}from"./index-0ec66d4d.js";const f={index(){return m.get("/initial-account/")},store(e){return m.post("/initial-account/",e)},update(e,t){return m.patch("/initial-account/"+e,t)},show(e){return m.get("/initial-account/"+e)},destroy(e){return m.delete("/initial-account/"+e)}};const j=u.object({id_account:u.number().nonnegative(),name:u.string().min(3),code:u.string().min(3),debit:u.number().nonnegative().optional(),kredit:u.number().nonnegative().optional()}),H={data(){return{akuntansiStore:P(),lItem:[],item:{id:null,id_account:null,name:null,code:null,category:null,debit:null,kredit:null},lAccount:null,selectedAccount:null,filteredAccount:null,saldoDialog:!1,deletesaldoDialog:!1,filters:{},FormError:{},isSubmitted:!1,isEdit:!1}},mounted(){this.getData()},created(){this.initFilters()},computed:{totalDebit(){return this.lItem&&this.lItem.reduce((e,t)=>parseFloat(e)+parseFloat(t.debit),0)},totalKredit(){return this.lItem&&this.lItem.reduce((e,t)=>parseFloat(e)+parseFloat(t.kredit),0)}},methods:{async getData(){await f.index().then(e=>{this.lItem=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load Data Saldo Awal",life:3e3})}),await L.indexByCategory("1,2,3").then(e=>{this.lAccount=e.data.data,this.filteredAccount=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load Data Akun",life:3e3})})},async Save(){this.isSubmitted=!0;const e=j.safeParse(this.item);if(e.success===!1){this.FormError=e.error.format();return}this.isEdit?await f.update(this.item.id_account,this.item).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.HideDialog()}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})}):await f.store(this.item).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.HideDialog()}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})})},async Destroy(e){await f.destroy(e.id_account).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.deletesaldoDialog=!1}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})})},HideDialog(){this.saldoDialog=!1,this.isSubmitted=!1,this.item={},this.selectedAccount=null,this.FormError={}},FormNew(){this.item={},this.FormError={},this.isSubmitted=!1,this.saldoDialog=!0,this.selectedAccount=null,this.isEdit=!1},FormEdit(e){this.FormError={},this.item={...e,debit:parseFloat(e.debit),kredit:parseFloat(e.kredit)},this.selectedAccount=this.lAccount.find(t=>t.id===e.id_account),this.isEdit=!0,this.isSubmitted=!1,this.saldoDialog=!0},confirmDelete(e){this.item=e,this.deletesaldoDialog=!0},selectAccount(e){this.item.id_account=e.value.id,this.item.category=e.value.id_category,this.item.name=e.value.name,this.item.code=e.value.code,this.item.debit=0,this.item.kredit=0},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}}},b=e=>(M("data-v-81584ef6"),e=e(),U(),e),R={class:"grid crud-demo"},X={class:"col-12"},z={class:"card"},O={class:"my-2"},Y={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},q={class:"m-0"},G={class:"block mt-2 md:mt-0 p-input-icon-left"},J=b(()=>s("i",{class:"pi pi-search"},null,-1)),Q=b(()=>s("div",{class:"text-center"},"Empty",-1)),W={class:"formgrid grid"},Z={class:"field col-12"},$={class:"field col-12 d-flex justifiy-content-center align-items-end"},ee={class:"field col-12 d-flex justifiy-content-center align-items-end"},te=b(()=>s("label",{for:"kredit"},"Kredit",-1)),ie={class:"flex align-items-center justify-content-center"},oe=b(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),le={key:0};function se(e,t,ae,re,i,r){var v;const S=n("Toast"),d=n("Button"),F=n("Toolbar"),x=n("InputText"),c=n("Column"),A=n("ActionButton"),w=n("Badge"),C=n("DataTable"),E=n("AutoCompleteAkun"),g=n("ErrorMsg"),I=n("Label"),_=n("InputNumber"),y=n("Dialog");return k(),D("div",R,[s("div",X,[s("div",z,[l(S),l(F,{class:"mb-4"},{start:a(()=>[s("div",O,[l(d,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:r.FormNew},null,8,["onClick"])])]),end:a(()=>[l(d,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:t[0]||(t[0]=o=>r.exportCSV(o))})]),_:1}),l(C,{ref:"dt",value:i.lItem,selection:e.selectedProduk,"onUpdate:selection":t[2]||(t[2]=o=>e.selectedProduk=o),dataKey:"id",paginator:!0,rows:10,filters:i.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{header:a(()=>[s("div",Y,[s("h5",q,"Saldo Awal Tahun "+h(i.akuntansiStore.year),1),s("span",G,[J,l(x,{modelValue:i.filters.global.value,"onUpdate:modelValue":t[1]||(t[1]=o=>i.filters.global.value=o),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:a(()=>[Q]),default:a(()=>[l(c,{header:"#",headerStyle:"width:10px"},{body:a(o=>[p(h(o.index+1),1)]),_:1}),l(c,{field:"code",header:"Code",sortable:!0}),l(c,{field:"name",header:"Account",footer:"Total",sortable:!0}),l(c,{field:"debit",header:"Debit",footer:e.$h.formatNumber(r.totalDebit),sortable:!0},{body:a(o=>[s("div",null,h(e.$h.formatNumber(o.data.debit)),1)]),_:1},8,["footer"]),l(c,{field:"kredit",header:"Kredit",footer:e.$h.formatNumber(r.totalKredit),sortable:!0},{body:a(o=>[s("div",null,h(e.$h.formatNumber(o.data.kredit)),1)]),_:1},8,["footer"]),l(c,{header:"Aksi",headerStyle:"width:14%; max-width:10rem;"},{body:a(({data:o,index:V})=>[l(A,{data:o,index:V,onEdit:N=>r.FormEdit(o),onDelete:N=>r.confirmDelete(o)},null,8,["data","index","onEdit","onDelete"])]),footer:a(()=>[l(w,{value:r.totalDebit==r.totalKredit?"Saldo balance":"Saldo tidak balance",severity:r.totalDebit==r.totalKredit?"success":"danger"},null,8,["value","severity"])]),_:1})]),_:1},8,["value","selection","filters"]),l(y,{visible:i.saldoDialog,"onUpdate:visible":t[6]||(t[6]=o=>i.saldoDialog=o),style:{width:"400px"},header:"Form Saldo Awal Tahun "+((v=i.akuntansiStore)==null?void 0:v.year),modal:!0,class:"p-fluid"},{footer:a(()=>[l(d,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:r.HideDialog},null,8,["onClick"]),l(d,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:r.Save},null,8,["onClick"])]),default:a(()=>[s("div",W,[s("div",Z,[l(E,{disabled:i.isEdit,modelValue:i.item.id_account,"onUpdate:modelValue":t[3]||(t[3]=o=>i.item.id_account=o),label:"Code",onSelectItem:r.selectAccount,min:1e3,level:4,max:3999,orderBy:"code",error:i.FormError.id_account},null,8,["disabled","modelValue","onSelectItem","error"]),l(g,{error:i.FormError.id_account},null,8,["error"])]),s("div",$,[l(I,{for:"debit"},{default:a(()=>[p("Debit")]),_:1}),l(_,{modelValue:i.item.debit,"onUpdate:modelValue":t[4]||(t[4]=o=>i.item.debit=o),modelModifiers:{number:!0},inputId:"debit",disabled:!i.item.category||i.item.category>1},null,8,["modelValue","disabled"]),l(g,{error:i.FormError.debit},null,8,["error"])]),s("div",ee,[te,l(_,{modelValue:i.item.kredit,"onUpdate:modelValue":t[5]||(t[5]=o=>i.item.kredit=o),modelModifiers:{number:!0},inputId:"kredit",disabled:!i.item.category||i.item.category===1},null,8,["modelValue","disabled"]),l(g,{error:i.FormError.kredit},null,8,["error"])])])]),_:1},8,["visible","header"]),l(y,{visible:i.deletesaldoDialog,"onUpdate:visible":t[9]||(t[9]=o=>i.deletesaldoDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[l(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[7]||(t[7]=o=>i.deletesaldoDialog=!1)}),l(d,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:t[8]||(t[8]=o=>r.Destroy(i.item))})]),default:a(()=>[s("div",ie,[oe,i.item?(k(),D("span",le,[p("Are you sure you want to delete "),s("b",null,h(i.item.nama_barang),1),p("?")])):K("",!0)])]),_:1},8,["visible"])])])])}const ce=T(H,[["render",se],["__scopeId","data-v-81584ef6"]]);export{ce as default};
