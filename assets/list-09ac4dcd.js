import{_ as L,F as P,r as n,o as v,c as b,b as l,d as t,e as a,l as d,t as x,n as y,f as V,p as T,g as N}from"./index-11eb6111.js";import{A as B}from"./index-b9e295bc.js";import{a as f}from"./api-10826abe.js";import{z as h}from"./index-0ec66d4d.js";const M=h.object({kode:h.string().min(1).max(25),proyek:h.string().min(1).max(100),lokasi:h.string().min(1).max(50)}),A={data(){return{lItem:[],item:{top:null,keterangan:null},itemDialog:!1,deleteItemDialog:!1,selectedColumns:[{field:"kode",header:"Kode",class:"w-20rem"},{field:"proyek",header:"Proyek",class:"w-20rem"},{field:"lokasi",header:"Lokasi",class:"w-20rem"}],isEdit:!1,isClean:!0,filters:{}}},created(){this.initFilters()},mounted(){this.$isLoading.value=!0,this.getData().finally(()=>{this.$timeoutLoading()})},computed:{FormError(){var e,s;return this.isClean?{}:((s=(e=M.safeParse(this.item))==null?void 0:e.error)==null?void 0:s.format())||{}}},methods:{async getData(){await f.index().then(e=>{this.lItem=e.data.data}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})})},HideDialog(){this.itemDialog=!1,this.isSubmitted=!1},async Save(){try{if(this.isClean=!1,this.$isLoading.value=!0,Object.keys(this.FormError).length>0)return;this.isEdit?await f.update(this.item.id,this.item).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem[this.lItem.findIndex(s=>s.id===e.data.data.id)]=this.item,this.itemDialog=!1}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})}):await f.store(this.item).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem.push(this.item),this.itemDialog=!1}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})}),this.isClean=!1}catch(e){e&&(e instanceof h.ZodError?this.FormError=e.format():e instanceof B&&this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})),console.log(e)}finally{this.$timeoutLoading()}},FormNew(){this.item={},this.isClean=!0,this.isEdit=!1,this.itemDialog=!0},FormEdit(e){this.item={...e},this.itemDialog=!0,this.isEdit=!0},confirmDelete(e){this.item=e,this.deleteItemDialog=!0},async Destroy(){this.deleteItemDialog=!1,await f.destroy(this.item.id).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem=this.lItem.filter(s=>s.id!==this.item.id)}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})}).finally(()=>{this.getData()})},initFilters(){this.filters={global:{value:null,matchMode:P.CONTAINS}}}}},m=e=>(T("data-v-b12ac4cf"),e=e(),N(),e),U={class:"grid crud-demo"},K={class:"col-12"},R={class:"card"},j={class:"my-2"},O={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},z=m(()=>l("h5",{class:"m-0"},"Proyek",-1)),H={class:"block mt-2 md:mt-0 p-input-icon-left"},Y=m(()=>l("i",{class:"pi pi-search"},null,-1)),Z=m(()=>l("hr",null,null,-1)),q=m(()=>l("div",{class:"text-center"},"Kosong",-1)),G=m(()=>l("hr",null,null,-1)),J={class:"field"},Q={class:"field"},W={class:"field"},X={class:"flex align-items-center justify-content-center"},$=m(()=>l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ee={key:0};function te(e,s,se,ie,i,r){const D=n("Toast"),c=n("Button"),E=n("MyExport"),C=n("Toolbar"),p=n("InputText"),u=n("Column"),w=n("ActionButton"),I=n("DataTable"),_=n("Label"),g=n("ErrorMsg"),k=n("Dialog");return v(),b("div",U,[l("div",K,[l("div",R,[t(D),t(C,{class:"mb-4"},{start:a(()=>[l("div",j,[t(c,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:r.FormNew},null,8,["onClick"])])]),end:a(()=>[t(E,{value:i.lItem,selectedColumns:i.selectedColumns,title:"Export Item"},null,8,["value","selectedColumns"])]),_:1}),t(I,{ref:"dt",value:i.lItem,dataKey:"id",paginator:!0,rows:10,filters:i.filters,sortMode:"single",sortField:"item",sortOrder:1,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Item",responsiveLayout:"scroll"},{header:a(()=>[l("div",O,[z,l("span",H,[Y,t(p,{modelValue:i.filters.global.value,"onUpdate:modelValue":s[0]||(s[0]=o=>i.filters.global.value=o),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:a(()=>[Z,q,G]),default:a(()=>[t(u,{header:"#",headerStyle:"width:5%"},{body:a(o=>[d(x(o.index+1),1)]),_:1}),t(u,{field:"kode",header:"Kode",headerStyle:"width:30%"}),t(u,{field:"proyek",header:"Proyek",headerStyle:"width:30%"}),t(u,{field:"lokasi",header:"Lokasi",headerStyle:"width:25%"}),t(u,{header:"Aksi",headerStyle:"width:10%"},{body:a(({data:o,index:S})=>[t(w,{data:o,index:S,onEdit:F=>r.FormEdit(o),onDelete:F=>r.confirmDelete(o)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","filters"]),t(k,{visible:i.itemDialog,"onUpdate:visible":s[4]||(s[4]=o=>i.itemDialog=o),style:{width:"450px"},header:"Proyek2",modal:!0,class:"p-fluid"},{footer:a(()=>[t(c,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:r.HideDialog},null,8,["onClick"]),t(c,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:r.Save,loading:e.$isLoading.value,disabled:e.$isLoading.value},null,8,["onClick","loading","disabled"])]),default:a(()=>[l("div",J,[t(_,{for:"kode"},{default:a(()=>[d("Kode")]),_:1}),t(p,{id:"kode",modelValue:i.item.kode,"onUpdate:modelValue":s[1]||(s[1]=o=>i.item.kode=o),placeholder:"00001",autofocus:"",class:y(r.FormError.kode&&"p-invalid")},null,8,["modelValue","class"]),t(g,{error:r.FormError.kode},null,8,["error"])]),l("div",Q,[t(_,{for:"proyek"},{default:a(()=>[d("Proyek")]),_:1}),t(p,{id:"proyek",modelValue:i.item.proyek,"onUpdate:modelValue":s[2]||(s[2]=o=>i.item.proyek=o),placeholder:"Rumah Sakit",class:y(r.FormError.proyek&&"p-invalid")},null,8,["modelValue","class"]),t(g,{error:r.FormError.proyek},null,8,["error"])]),l("div",W,[t(_,{for:"lokasi"},{default:a(()=>[d("Lokasi")]),_:1}),t(p,{id:"lokasi",modelValue:i.item.lokasi,"onUpdate:modelValue":s[3]||(s[3]=o=>i.item.lokasi=o),placeholder:"Balikpapan",class:y(r.FormError.lokasi&&"p-invalid")},null,8,["modelValue","class"]),t(g,{error:r.FormError.lokasi},null,8,["error"])])]),_:1},8,["visible"]),t(k,{visible:i.deleteItemDialog,"onUpdate:visible":s[6]||(s[6]=o=>i.deleteItemDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[t(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[5]||(s[5]=o=>i.deleteItemDialog=!1)}),t(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:r.Destroy},null,8,["onClick"])]),default:a(()=>[l("div",X,[$,i.item?(v(),b("span",ee,[d("Are you sure you want to delete "),l("b",null,x(i.item.proyek),1),d("?")])):V("",!0)])]),_:1},8,["visible"])])])])}const ne=L(A,[["render",te],["__scopeId","data-v-b12ac4cf"]]);export{ne as default};
