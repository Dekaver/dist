import{A as S}from"./index-b9e295bc.js";import{_ as I,F as L,r as n,o as h,c as _,b as a,d as i,e as o,l as d,t as v,m as M,q as B,n as c,f as P,k as j}from"./index-11eb6111.js";import"./custom-zod-e9521e5d.js";import{a as y}from"./absentempat-5495884d.js";import{a as T}from"./pegawai-9c760009.js";import{z as b}from"./index-0ec66d4d.js";const A=b.object({nama:b.string().min(1).max(255),jarak_absen:b.number()}),q={data(){return{lItem:[],item:{nama:null,latitude:null,longitude:null,jarak_absen:null},selectedItem:null,filters:{},f:{selectedBulan:null,bulan:[{id:1,nama:"Januari"},{id:2,nama:"February"},{id:3,nama:"Maret"},{id:4,nama:"April"},{id:5,nama:"Mei"},{id:6,nama:"Juni"},{id:7,nama:"Juli"},{id:8,nama:"Agustus"},{id:9,nama:"September"},{id:10,nama:"Oktober"},{id:11,nama:"November"},{id:12,nama:"Desember"}],tahun:null},selectedColumns:[{field:"nama",header:"Nama",class:"w-20rem"},{field:"jabatan",header:"Jabatan",class:"w-20rem"},{field:"departemen",header:"Departemen",class:"w-20rem"}],Columns:[{field:"nama",header:"Nama",class:"w-20rem"},{field:"jabatan",header:"Jabatan",class:"w-20rem"},{field:"departemen",header:"Departemen",class:"w-20rem"}],isClean:!0,isEdit:!1,formDialog:!1,deleteFormDialog:!1}},created(){this.initFilters()},mounted(){this.f.selectedBulan=this.f.bulan.find(s=>s.id==new Date().getMonth()+1),this.f.tahun=new Date().getFullYear(),this.getData()},computed:{FormError(){var s,e;return!this.isClean&&((e=(s=A.safeParse(this.item))==null?void 0:s.error)==null?void 0:e.format())||{}}},methods:{async getData(){await T.index().then(s=>{this.lItem=s.data.data})},async Save(){try{if(this.$isLoading.value=!0,this.isClean=!1,Object.keys(this.FormError).length>0)return;this.isEdit?await y.update(this.item.id,{...this.item,latitude:Number(this.item.latitude),longitude:Number(this.item.longitude)}).then(s=>{this.$toast.add({severity:"success",summary:"Successful",detail:s.data.message,life:3e3}),this.lItem[this.lItem.findIndex(e=>e.id===this.item.id)]=this.item,this.formDialog=!1}):await y.store({...this.item,latitude:Number(this.item.latitude),longitude:Number(this.item.longitude)}).then(s=>{this.$toast.add({severity:"success",summary:"Successful",detail:s.data.message,life:3e3}),this.lItem.push(s.data.data),this.formDialog=!1})}catch(s){console.log(s),s instanceof b.ZodError?this.FormError=s.format():s instanceof S&&this.$toast.add({severity:"error",summary:"Failed",detail:s.response.data.message,life:3e3})}finally{this.$timeoutLoading()}},async Destroy(s){this.lItem=this.lItem.filter(e=>e.id!==s.id),await y.destroy(s.id).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.getData(),this.deleteFormDialog=!1})},initFilters(){this.filters={global:{value:null,matchMode:L.CONTAINS}}},exportCSV(){this.$refs.dt.exportCSV()},FormNew(){this.item={},this.FormError={},this.formDialog=!0,this.isClean=!0},FormEdit(s){this.$router.push({name:"aktivitas-absen.edit",query:{id:s.id,name:s.nama,month:this.f.selectedBulan.id,bulan:this.f.selectedBulan.nama,year:this.f.tahun}})},confirmDelete(s){this.item={...s},this.deleteFormDialog=!0},HideDialog(){this.formDialog=!1}}},U={class:"grid crud-demo"},J={class:"col-12"},O={class:"card"},R={class:"p-fluid formgrid grid my-4"},z={class:"field col-2"},H=a("label",{for:"bulan",class:"mb-2"},[d("Bulan"),a("small",{class:"text-red-500"},"*")],-1),Y={class:"field col-2"},G=a("label",{for:"tahun",class:"mb-2"},[d("Tahun"),a("small",{class:"text-red-500"},"*")],-1),K={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Z=a("h5",{class:"m-0"},"Daftar Aktivitas Absen",-1),Q={class:"block mt-2 ml-2 md:mt-0 p-input-icon-left"},W=a("i",{class:"pi pi-search"},null,-1),X=a("div",{class:"text-center"},"Empty",-1),$={class:"formgrid grid"},ee={class:"field col-12"},te={class:"field col-12"},le={class:"field col-12"},ie={class:"field col-4"},se=a("div",{class:"field col-4 md:col-1 align-self-center mt-4"},[a("span",{class:"font-bold"},"Meter")],-1),ae={class:"flex align-items-center justify-content-center"},oe=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),re={key:0};function ne(s,e,de,me,l,r){const x=n("Toast"),F=n("Dropdown"),m=n("InputText"),C=n("MultiSelect"),g=n("Column"),u=n("Button"),V=n("DataTable"),f=n("Label"),p=n("ErrorMsg"),E=n("InputNumber"),w=n("Dialog");return h(),_("div",U,[a("div",J,[a("div",O,[i(x),a("div",R,[a("div",z,[H,i(F,{id:"bulan",modelValue:l.f.selectedBulan,"onUpdate:modelValue":e[0]||(e[0]=t=>l.f.selectedBulan=t),options:l.f.bulan,optionLabel:"nama"},null,8,["modelValue","options"])]),a("div",Y,[G,i(m,{id:"tahun",type:"text",modelValue:l.f.tahun,"onUpdate:modelValue":e[1]||(e[1]=t=>l.f.tahun=t)},null,8,["modelValue"])])]),i(V,{ref:"dt",value:l.lItem,dataKey:"id",paginator:!0,rows:10,filters:l.filters,rowGroupMode:"rowspan",groupRowsBy:"id",sortMode:"single",sortField:"id",sortOrder:1,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{header:o(()=>[a("div",K,[Z,i(C,{modelValue:l.selectedColumns,"onUpdate:modelValue":e[2]||(e[2]=t=>l.selectedColumns=t),options:l.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),a("span",Q,[W,i(m,{modelValue:l.filters.global.value,"onUpdate:modelValue":e[3]||(e[3]=t=>l.filters.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:o(()=>[X]),default:o(()=>[i(g,{header:"#",headerStyle:"width:10px"},{body:o(t=>[d(v(t.index+1),1)]),_:1}),(h(!0),_(M,null,B(l.selectedColumns,(t,D)=>(h(),j(g,{field:t.field,header:t.header,class:c(t.class),key:t.field+"_"+D,sortable:!0},{body:o(({data:k,field:N})=>[a("div",null,v(k[N]),1)]),_:2},1032,["field","header","class"]))),128)),i(g,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:o(({data:t,_:D})=>[i(u,{icon:"pi pi-eye",class:"p-button p-button-primary mr-2",onClick:k=>r.FormEdit(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters"]),i(w,{visible:l.formDialog,"onUpdate:visible":e[8]||(e[8]=t=>l.formDialog=t),style:{width:"450px"},header:"Form Item",modal:!0,class:"p-fluid"},{footer:o(()=>[i(u,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:r.HideDialog},null,8,["onClick"]),i(u,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:r.Save},null,8,["onClick"])]),default:o(()=>[a("div",$,[a("div",ee,[i(f,{required:"",for:"item"},{default:o(()=>[d("Nama")]),_:1}),i(m,{id:"item",modelValue:l.item.nama,"onUpdate:modelValue":e[4]||(e[4]=t=>l.item.nama=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:c(r.FormError.nama&&"p-invalid")},null,8,["modelValue","class"]),i(p,{error:r.FormError.nama},null,8,["error"])]),a("div",te,[i(f,{required:"",for:"item"},{default:o(()=>[d("Latitude")]),_:1}),i(m,{id:"item",modelValue:l.item.latitude,"onUpdate:modelValue":e[5]||(e[5]=t=>l.item.latitude=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:c(r.FormError.latitude&&"p-invalid"),type:"number"},null,8,["modelValue","class"]),i(p,{error:r.FormError.latitude},null,8,["error"])]),a("div",le,[i(f,{required:"",for:"item"},{default:o(()=>[d("Longitude")]),_:1}),i(m,{id:"item",modelValue:l.item.longitude,"onUpdate:modelValue":e[6]||(e[6]=t=>l.item.longitude=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:c(r.FormError.longitude&&"p-invalid"),type:"number"},null,8,["modelValue","class"]),i(p,{error:r.FormError.longitude},null,8,["error"])]),a("div",ie,[i(f,{required:"",for:"item"},{default:o(()=>[d("Jarak Absen")]),_:1}),i(E,{id:"item",modelValue:l.item.jarak_absen,"onUpdate:modelValue":e[7]||(e[7]=t=>l.item.jarak_absen=t),min:0,required:"true",autofocus:"",class:c(r.FormError.jarak_absen&&"p-invalid")},null,8,["modelValue","class"]),i(p,{error:r.FormError.jarak_absen},null,8,["error"])]),se])]),_:1},8,["visible"]),i(w,{visible:l.deleteFormDialog,"onUpdate:visible":e[11]||(e[11]=t=>l.deleteFormDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:o(()=>[i(u,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[9]||(e[9]=t=>l.deleteFormDialog=!1)}),i(u,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:e[10]||(e[10]=t=>r.Destroy(l.item))})]),default:o(()=>[a("div",ae,[oe,l.item?(h(),_("span",re,[d("Are you sure you want to delete "),a("b",null,v(l.item.nama),1),d("?")])):P("",!0)])]),_:1},8,["visible"])])])])}const ge=I(q,[["render",ne]]);export{ge as default};
