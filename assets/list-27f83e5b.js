import{_ as U,s as w,F as B,r as n,o as r,c as p,b as a,d as o,e as i,n as y,k as P,f as C,l as h,t as f,m as I,q as M}from"./index-11eb6111.js";import{a as S}from"./paymentap-dead24ec.js";const q={data(){return{lPaymentAp:[],selectedPaymentAp:null,lPersetujuan:[],filter:!1,deleteDialog:!1,f:{awal:null,akhir:null,selectedStatus:{label:"All",value:""},id_supplier:null},statuses:[{label:"All",value:""},{label:"DRAFT",value:"D"},{label:"CLOSE",value:"C"}],selectedColumns:[{field:"date",header:"Tanggal"},{field:"number",header:"Nomor"},{field:"supplier",header:"Nama Supplier"},{field:"description",header:"Deskripsi"},{field:"total",header:"Jumlah",type:"currency"},{field:"status",header:"Status"}],Columns:[{field:"date",header:"Tanggal"},{field:"number",header:"Nomor"},{field:"supplier",header:"Nama Supplier"},{field:"description",header:"Deskripsi"},{field:"total",header:"Jumlah",type:"currency"},{field:"status",header:"Status"}],filters:null}},created(){this.initFilters()},mounted(){this.$isLoading.value=!0,this.getData().finally(()=>{this.$timeoutLoading()}),w.on("update-persetujuan-payment-ap",()=>{this.getDataPersetujuan()})},beforeUnmount(){w.off("update-persetujuan-payment-ap")},computed:{filteredlPaymentAp(){return this.lPaymentAp.filter(e=>(this.f.selectedStatus.value==""?!0:this.f.selectedStatus.value==e.status)&&(this.f.id_supplier==null?!0:this.f.id_supplier==e.id_supplier)&&(this.f.awal==null?!0:this.f.awal.toLocaleDateString()<=new Date(e.date).toLocaleDateString())&&(this.f.akhir==null?!0:this.f.akhir.toLocaleDateString()>=new Date(e.date).toLocaleDateString()))}},methods:{async getData(){await S.index().then(e=>{this.lPaymentAp=e.data.data}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})})},async Destroy(e){await S.destroy(e.id).then(l=>{this.$toast.add({severity:"success",summary:"Success",detail:l.data.message,life:3e3}),this.lPaymentAp=this.lPaymentAp.filter(g=>g.id!==e.id),this.deleteDialog=!1}).catch(l=>{this.$toast.add({severity:"error",summary:"Failed",detail:l.response.data.message,life:3e3})})},onRowDblclick(e){this.$router.push({name:"paymentap.edit",params:{id:e.data.id}})},FormEdit(e){this.$router.push({name:"paymentap.edit",params:{id:e.id}})},confirmDelete(e){this.deleteDialog=!0,this.item={...e}},Cetak(e){this.$router.push({name:"paymentap.print",params:{id:e.id}})},button(e){let l=[];return e.status=="C"&&l.push({label:"Journal Voucher",icon:"pi pi-book",action:"journal",command:()=>{this.Cetak(e)}}),l.push({label:"Edit",icon:"pi pi-pencil",action:"edit",command:()=>{this.FormEdit(e)}}),e.status!="A"&&l.push({label:"Delete",icon:"pi pi-trash",action:"delete",command:()=>{this.Destroy(e)}}),l},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}}},O={class:"grid crud-demo"},J={class:"col-12"},K={class:"card"},z={class:"my-2"},H=a("h5",{class:"mbe-4"},"Filter Payment AR",-1),Y={class:"p-fluid formgrid grid"},G={class:"field col-2"},Q={class:"field col-2"},W={class:"field col-2"},X={class:"field col-2 d-flex justifiy-content-center align-items-end mb-0"},Z=a("label",{for:"salesquotation"},"Status",-1),$={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ee=a("h5",{class:"m-0"},"Pembayaran Hutang Usaha",-1),te={class:"block mt-2 md:mt-0 p-input-icon-left"},le=a("i",{class:"pi pi-search"},null,-1),se={key:0},oe={key:1},ae={key:2},ne={key:3,class:"text-right"},ie={key:4},re={class:"flex align-items-center justify-content-center"},de=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ue={key:0};function pe(e,l,g,ce,s,c){const A=n("Toast"),m=n("Button"),v=n("router-link"),x=n("MyExport"),V=n("Toolbar"),D=n("Label"),k=n("Calendar"),L=n("AutoCompleteKontak"),T=n("Dropdown"),F=n("InputText"),_=n("Column"),N=n("Tag"),j=n("ActionButton"),E=n("DataTable"),R=n("Dialog");return r(),p("div",O,[a("div",J,[a("div",K,[o(A),o(V,{class:"mb-4"},{start:i(()=>{var t;return[a("div",z,[o(v,{to:"/finance/ap/payment/create",class:"btn btn-added me-2"},{default:i(()=>[o(m,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2"})]),_:1}),o(m,{icon:"pi pi-filter",class:y(["p-button mx-2",{"p-button-block":s.filter,"p-button-outlined":!s.filter}]),label:"Filter",onClick:l[0]||(l[0]=b=>s.filter=!s.filter)},null,8,["class"]),(t=s.lPersetujuan)!=null&&t.length?(r(),P(v,{key:0,to:"/finance/ap/payment/persetujuan",class:"btn btn-added mx-2"},{default:i(()=>[o(m,{icon:"pi pi-shield",class:"p-button p-button-outlined",label:"Persetujuan",badge:s.lPersetujuan.length,severity:"warning",badgeSeverity:"warning"},null,8,["badge"])]),_:1})):C("",!0)])]}),end:i(()=>[o(x,{value:e.filteredItems,selectedColumns:s.selectedColumns,title:"Export Purchase Order"},null,8,["value","selectedColumns"])]),_:1}),a("div",{class:y(["card fadein",{hidden:!s.filter}])},[H,a("div",Y,[a("div",G,[o(D,null,{default:i(()=>[h("Start Date")]),_:1}),o(k,{modelValue:s.f.awal,"onUpdate:modelValue":l[1]||(l[1]=t=>s.f.awal=t),inputId:"periodeawal"},null,8,["modelValue"])]),a("div",Q,[o(D,null,{default:i(()=>[h("End Date")]),_:1}),o(k,{modelValue:s.f.akhir,"onUpdate:modelValue":l[2]||(l[2]=t=>s.f.akhir=t),inputId:"periodeakhir"},null,8,["modelValue"])]),a("div",W,[o(L,{modelValue:s.f.id_supplier,"onUpdate:modelValue":l[3]||(l[3]=t=>s.f.id_supplier=t),label:"Supplier",required:!1,"is-supplier":""},null,8,["modelValue"])]),a("div",X,[Z,o(T,{id:"salesquotation",modelValue:s.f.selectedStatus,"onUpdate:modelValue":l[4]||(l[4]=t=>s.f.selectedStatus=t),options:s.statuses,optionLabel:"label",placeholder:"All"},null,8,["modelValue","options"])])])],2),o(E,{ref:"dt",value:c.filteredlPaymentAp,selection:s.selectedPaymentAp,"onUpdate:selection":l[6]||(l[6]=t=>s.selectedPaymentAp=t),dataKey:"id",paginator:!0,rows:10,onRowDblclick:c.onRowDblclick,filters:s.filters,selectionMode:"single",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll",tableStyle:"table-layout:auto"},{header:i(()=>[a("div",$,[ee,a("span",te,[le,o(F,{modelValue:s.filters.global.value,"onUpdate:modelValue":l[5]||(l[5]=t=>s.filters.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),default:i(()=>[o(_,{header:"#",headerStyle:"width:10px"},{body:i(t=>[h(f(t.index+1),1)]),_:1}),(r(!0),p(I,null,M(s.selectedColumns,(t,b)=>(r(),P(_,{field:t.field,header:t.header,class:y(t.class),key:t.field+"_"+b,sortable:!0},{body:i(({data:u,field:d})=>[d=="icon"?(r(),p("div",se,[o(m,{icon:u[d],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):d=="status"?(r(),p("div",oe,[o(N,{value:e.$h.getLabel(u[d]),severity:e.$h.getLabel(u[d])},null,8,["value","severity"])])):d=="date"?(r(),p("div",ae,f(e.$h.formatDate(u[d])),1)):t.type=="currency"?(r(),p("div",ne,f(e.$h.formatNumber(u[d])),1)):(r(),p("div",ie,f(u[d]),1))]),_:2},1032,["field","header","class"]))),128)),o(_,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:i(({data:t,index:b})=>[o(j,{data:t,index:b,onEdit:u=>c.FormEdit(t),onDelete:u=>c.confirmDelete(t),onPrint:c.Cetak,showDelete:t.status=="D",showPrint:t.status!="D"},null,8,["data","index","onEdit","onDelete","onPrint","showDelete","showPrint"])]),_:1})]),_:1},8,["value","selection","onRowDblclick","filters"]),o(R,{visible:s.deleteDialog,"onUpdate:visible":l[9]||(l[9]=t=>s.deleteDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[o(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[7]||(l[7]=t=>s.deleteDialog=!1)}),o(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:l[8]||(l[8]=t=>c.Destroy(e.item))})]),default:i(()=>[a("div",re,[de,e.item?(r(),p("span",ue,[h("Are you sure you want to delete "),a("b",null,f(e.item.number),1),h("?")])):C("",!0)])]),_:1},8,["visible"])])])])}const fe=U(q,[["render",pe]]);export{fe as default};
