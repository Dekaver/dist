import{_ as F,a1 as b,F as j,r as d,o as n,c as r,b as a,d as i,e as o,l as p,t as c,m as L,q as U,n as h,f,k as P}from"./index-11eb6111.js";import{a as N}from"./pegawai-9c760009.js";import{a as E}from"./role-1adf88f1.js";const q={data(){return{lPengguna:[],pengguna:{},selectedPengguna:null,lRole:[],selectedRole:null,filteredRole:null,lPegawai:[],selectedPegawai:null,filteredPegawai:null,selectedColumns:[{header:"Username",field:"usernamenya",class:"w-20rem"},{header:"Aktif",field:"enabled",class:"w-20rem"}],Columns:[{header:"Username",field:"usernamenya",class:"w-20rem"},{header:"Email",field:"email",class:"w-20rem"},{header:"Aktif",field:"enabled",class:"w-20rem"},{header:"Jabatan  ",field:"jabatan",class:"w-20rem"},{header:"Di Buat",field:"dibuat",class:"w-20rem",type:"date"},{header:"Login Terakhir",field:"loginterakhir",class:"w-20rem",type:"date"}],filters:{},isSubmitted:!1,isEdit:!1,formDialog:!1,deleteFormDialog:!1}},methods:{getData(){b.index().then(t=>{this.lPengguna=t.data.data}),E.index().then(t=>{this.lRole=t.data.data}),N.available().then(t=>{this.lPegawai=t.data.data})},initFilters(){this.filters={global:{value:null,matchMode:j.CONTAINS}}},selectPegawai(t){t.value==null?(this.pengguna.id_pegawai=null,this.pengguna.jabatan=null):(this.pengguna.id_pegawai=t.value.id_pegawai,this.pengguna.jabatan=t.value.jabatan)},HideDialog(){this.lPegawai=this.lPegawai.filter(t=>t.id_pegawai!=this.pengguna.id_pegawai),this.selectedPegawai=null,this.pengguna={},this.formDialog=!1,this.isSubmitted=!1},FormNew(){this.pengguna={},this.isSubmitted=!1,this.formDialog=!0,this.isEdit=!1},FormEdit(t){this.oldUsernamenya=t.usernamenya,this.pengguna={...t},this.selectedRole=this.lRole.find(l=>l.id===t.role),this.pengguna.id_pegawai!=null&&(this.lPegawai.push({id_pegawai:t.id_pegawai,nama:t.nama,jabatan:t.jabatan}),this.selectedPegawai=this.lPegawai.find(l=>l.id_pegawai===t.id_pegawai)),this.isSubmitted=!1,this.formDialog=!0,this.isEdit=!0},FormDelete(t){this.pengguna={...t},this.deleteFormDialog=!0},Save(){this.isSubmitted=!0,this.isEdit?b.update(this.oldUsernamenya,this.pengguna).then(t=>{this.$toast.add({severity:"success",summary:"Successful",detail:t.data.message,life:3e3}),this.getData(),this.formDialog=!1}):b.store(this.pengguna).then(t=>{this.$toast.add({severity:"success",summary:"Successful",detail:t.data.message,life:3e3}),this.getData(),this.formDialog=!1})},Destroy(t){this.lPengguna=this.lPengguna.filter(l=>l.usernamenya!==t.usernamenya),b.destroy(t.usernamenya).then(l=>{this.$toast.add({severity:"success",summary:"Successful",detail:l.data.message,life:3e3}),this.getData(),this.deleteFormDialog=!1})},searchRole(t){this.lRole!=null&&setTimeout(()=>{t.query.trim().length?this.filteredRole=this.lRole.filter(l=>l.role.toLowerCase().includes(t.query.toLowerCase())):this.filteredRole=[...this.lRole]},250)},searchPegawai(t){this.lPegawai!=null&&setTimeout(()=>{t.query.trim().length?this.filteredPegawai=this.lPegawai.filter(l=>l.nama.toLowerCase().includes(t.query.toLowerCase())):this.filteredPegawai=[...this.lPegawai]},250)}},created(){this.initFilters(),this.getData()},mounted(){this.getData()},watch:{selectedPegawai(){this.pengguna.id_pegawai=this.selectedPegawai?this.selectedPegawai.id_pegawai:null,this.pengguna.jabatan=this.selectedPegawai?this.selectedPegawai.jabatan:null},selectedRole(){this.pengguna.role=this.selectedRole?this.selectedRole.id:null},formDialog(t){t||this.HideDialog()}}},M={class:"grid"},A={class:"col-12"},B={class:"card"},I={class:"my-2"},z={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},H=a("h5",{class:"m-0"},"Manage Pengguna",-1),O={class:"block mt-2 md:mt-0 p-input-icon-left"},K=a("i",{class:"pi pi-search"},null,-1),J={key:0},Y={key:1},G={key:2},Q={key:3},W={class:"formgrid grid"},X={class:"field col-6 d-flex justifiy-content-center align-items-end"},Z=a("label",{for:"id"},"Username",-1),$={key:0,class:"p-invalid"},ee={class:"field col-6 d-flex justifiy-content-center align-items-end"},te={key:0,for:"id"},se={key:1,for:"id"},le={key:2,class:"p-invalid"},ie={class:"field col-6 d-flex justifiy-content-center align-items-end"},ae=a("label",{for:"pegawai"},"Pegawai",-1),ne={class:"flex flex-column align-items-start justify-content-center"},oe={class:"text-sm font-semibold text-green-500"},re={class:""},de={key:0,class:"p-invalid"},ue={class:"field col-6 d-flex justifiy-content-center align-items-end"},ge=a("label",{for:"role"},"Role",-1),ce={key:0,class:"p-invalid"},me={class:"flex align-items-center justify-content-center"},pe=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),he={key:0};function fe(t,l,_e,we,e,u){const x=d("Toast"),g=d("Button"),S=d("MyExport"),R=d("Toolbar"),V=d("MultiSelect"),y=d("InputText"),_=d("Column"),k=d("Tag"),T=d("DataTable"),C=d("AutoComplete"),D=d("Dialog");return n(),r("div",M,[a("div",A,[a("div",B,[i(x),i(R,null,{start:o(()=>[a("div",I,[i(g,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:u.FormNew},null,8,["onClick"])])]),end:o(()=>[i(S,{value:t.filteredItems,selectedColumns:e.selectedColumns,title:"Export Purchase Order"},null,8,["value","selectedColumns"])]),_:1}),i(T,{ref:"dt",value:e.lPengguna,selection:t.selectedlPengguna,"onUpdate:selection":l[2]||(l[2]=s=>t.selectedlPengguna=s),dataKey:"id",paginator:!0,rows:10,filters:e.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Kontak",responsiveLayout:"scroll"},{empty:o(()=>[p("Tidak ada pengguna ditemukan. ")]),header:o(()=>[a("div",z,[H,i(V,{modelValue:e.selectedColumns,"onUpdate:modelValue":l[0]||(l[0]=s=>e.selectedColumns=s),options:e.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),a("span",O,[K,i(y,{modelValue:e.filters.global.value,"onUpdate:modelValue":l[1]||(l[1]=s=>e.filters.global.value=s),placeholder:"Search..."},null,8,["modelValue"])])])]),default:o(()=>[i(_,{header:"#",headerStyle:"width:10px"},{body:o(s=>[p(c(s.index+1),1)]),_:1}),i(_,{field:"nama",header:"Nama",sortable:!0},{body:o(s=>[p(c(s.data.usernamenya),1)]),_:1}),(n(!0),r(L,null,U(e.selectedColumns,(s,v)=>(n(),P(_,{field:s.field,header:s.header,class:h(s.class),key:s.field+"_"+v,sortable:!0},{body:o(({data:w,field:m})=>[m=="icon"?(n(),r("div",J,[i(g,{icon:w[m],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):m=="enabled"?(n(),r("div",Y,[w[m]?(n(),P(k,{key:0,class:"w-fit",severity:"success",value:"Aktif"})):(n(),P(k,{key:1,class:"w-fit",severity:"danger",value:"Tidak Aktif"}))])):s.type=="date"?(n(),r("div",G,c(t.$h.formatDate(w[m])),1)):(n(),r("div",Q,c(w[m]),1))]),_:2},1032,["field","header","class"]))),128)),i(_,{header:"Action",class:"ml-auto",headerStyle:"width:14%;min-width:10rem"},{body:o(s=>[i(g,{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning mr-2",onClick:v=>u.FormEdit(s.data)},null,8,["onClick"]),i(g,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:v=>u.FormDelete(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),i(D,{visible:e.formDialog,"onUpdate:visible":l[7]||(l[7]=s=>e.formDialog=s),style:{width:"720px"},header:"Detail Pengguna",modal:!0,maximizable:"",class:"p-fluid"},{footer:o(()=>[i(g,{label:"Save",icon:"pi pi-check",class:"p-button-primary",onClick:u.Save},null,8,["onClick"]),i(g,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:u.HideDialog},null,8,["onClick"])]),default:o(()=>[a("div",W,[a("div",X,[Z,i(y,{id:"id",modelValue:e.pengguna.usernamenya,"onUpdate:modelValue":l[3]||(l[3]=s=>e.pengguna.usernamenya=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:h({"p-invalid":e.isSubmitted&&!e.pengguna.usernamenya})},null,8,["modelValue","class"]),e.isSubmitted&&!e.pengguna.usernamenya?(n(),r("small",$,"required.")):f("",!0)]),a("div",ee,[e.isEdit?(n(),r("label",te,"New Password")):(n(),r("label",se,"Password")),i(y,{id:"id",modelValue:e.pengguna.passwordnya,"onUpdate:modelValue":l[4]||(l[4]=s=>e.pengguna.passwordnya=s),modelModifiers:{trim:!0},type:"password",required:"true",autofocus:"",class:h({"p-invalid":e.isSubmitted&&!e.pengguna.passwordnya})},null,8,["modelValue","class"]),e.isSubmitted&&!e.pengguna.passwordnya?(n(),r("small",le,"required.")):f("",!0)]),a("div",ie,[ae,i(C,{modelValue:e.selectedPegawai,"onUpdate:modelValue":l[5]||(l[5]=s=>e.selectedPegawai=s),optionLabel:"nama",suggestions:e.filteredPegawai,onComplete:u.searchPegawai,onChange:u.selectPegawai,dropdown:"",forceSelection:"",class:h({"p-invalid":e.isSubmitted&&!e.pengguna.id_pegawai})},{option:o(s=>[a("div",ne,[a("div",oe,c(s.option.jabatan),1),a("div",re,c(s.option.nama),1)])]),_:1},8,["modelValue","suggestions","onComplete","onChange","class"]),e.isSubmitted&&!e.pengguna.pegawai?(n(),r("small",de,"required")):f("",!0)]),a("div",ue,[ge,i(C,{modelValue:e.selectedRole,"onUpdate:modelValue":l[6]||(l[6]=s=>e.selectedRole=s),dropdown:"",optionLabel:"role",suggestions:e.filteredRole,onComplete:u.searchRole,class:h({"p-invalid":e.isSubmitted&&!e.pengguna.role})},null,8,["modelValue","suggestions","onComplete","class"]),e.isSubmitted&&!e.pengguna.role?(n(),r("small",ce,"required")):f("",!0)])])]),_:1},8,["visible"]),i(D,{visible:e.deleteFormDialog,"onUpdate:visible":l[10]||(l[10]=s=>e.deleteFormDialog=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:o(()=>[i(g,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[8]||(l[8]=s=>e.deleteFormDialog=!1)}),i(g,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:l[9]||(l[9]=s=>u.Destroy(e.pengguna))})]),default:o(()=>[a("div",me,[pe,e.pengguna?(n(),r("span",he,[p("Are you sure you want to delete "),a("b",null,c(e.pengguna.usernamenya),1),p("?")])):f("",!0)])]),_:1},8,["visible"])])])])}const Pe=F(q,[["render",fe]]);export{Pe as default};
