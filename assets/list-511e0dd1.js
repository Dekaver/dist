import{_ as I,o as n,c as d,b as t,m as h,q as v,t as l,p as S,g as X,F as N,r as g,d as y,e as T,k as D}from"./index-11eb6111.js";import{a as L}from"./index-fa5c02f8.js";import{a as c}from"./xlsx.min-b21a3818.js";const C={data(){return{lItem:[],columns:[{field:"akun_code",header:"Nomor"},{field:"akun",header:"Akun"},{field:"debit",header:"Debit",class:"text-right",type:"currency"},{field:"kredit",header:"Kredit",class:"text-right",type:"currency"},{field:"description",header:"Note"}]}},methods:{async getData(){await L.getJurnalExport().then(e=>{this.lItem=e.data.data})},exportToXLSX(){const e=c.utils.table_to_sheet(document.getElementById("table")),i=[{width:25},{wch:25},{width:15},{width:15},{width:30}];e["!cols"]=i;for(const p in e)if(Object.prototype.hasOwnProperty.call(e,p)){const m=e[p];m.t==="n"&&(m.z="0")}e.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}},e.A2.s={font:{name:"Arial Black",sz:16,bold:!0},alignment:{vertical:"center",horizontal:"center"}};const x=c.utils.decode_range(e["!ref"]),$=c.utils.encode_cell({r:x.e.r,c:x.e.c});console.log("Last cell address:",$);const u="A6",f=$,o={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}};let r=0;for(let p=c.utils.decode_cell(u).r;p<=c.utils.decode_cell(f).r;p++)for(let m=c.utils.decode_cell(u).c;m<=c.utils.decode_cell(f).c;m++){const b=c.utils.encode_cell({r:p,c:m}),k=e[b],s=c.utils.decode_cell(b).r;if(console.log(r,s,b,k.v,"ini cell"),k.v&&k.v.includes("GL")){r=s;for(let _=0;_<c.utils.decode_cell(s).c+5;_++){const a=c.utils.encode_cell({r:s,c:_});console.log(c.utils.decode_cell(a),r,s,a,"ini ada gl"),e[a]=e[a]||{t:"s",v:""},e[a].s={border:o,font:{bold:!0}}}r=0;break}else e[b]=e[b]||{},e[b].s={border:o}}const A=c.utils.book_new();c.utils.book_append_sheet(A,e,"Sheet1"),c.writeFile(A,"exported_data.xlsx")}},created(){},mounted(){this.getData()},computed:{totalDataObjects(){let e=0;for(const i of this.lItem)if(e++,i.children&&Array.isArray(i.children))for(const x of i.children)e++;return e}}},w=e=>(S("data-v-7f780d83"),e=e(),X(),e),E={border:"1",id:"table"},B=w(()=>t("tr",null,[t("td",{colspan:"5"},"PT Planet IT (PRODUK)")],-1)),O=w(()=>t("tr",null,[t("td",{colspan:"5"},"LAPORAN JURNAL")],-1)),R={class:"text-right"},j={class:"text-right"},F=w(()=>t("td",null,null,-1));function z(e,i,x,$,u,f){return n(),d("div",null,[t("button",{onClick:i[0]||(i[0]=(...o)=>f.exportToXLSX&&f.exportToXLSX(...o))},"Export to XLSX"),t("div",null,[t("table",E,[t("thead",null,[B,O,t("tr",null,[(n(),d(h,null,v(5,o=>t("td",{key:o},l(" "))),64))]),t("tr",null,[(n(),d(h,null,v(5,o=>t("td",{key:o},l(" "))),64))]),t("tr",null,[(n(),d(h,null,v(5,o=>t("td",{key:o},l(" "))),64))]),t("tr",null,[(n(!0),d(h,null,v(u.columns,(o,r)=>(n(),d("th",{key:r},l(o.header),1))),128))])]),t("tbody",null,[(n(!0),d(h,null,v(u.lItem,o=>(n(),d(h,{key:o.gl_number},[t("tr",null,[t("td",null,l(o.gl_number),1),t("td",null,l(o.reference),1),t("td",null,l(e.$h.formatDate(o.gl_date)),1),t("td",null,l(o.journal_code),1),t("td",null,l(o.description||" "),1)]),(n(!0),d(h,null,v(o.children,r=>(n(),d("tr",{key:r.gl_number},[t("td",null,l(r.akun_code),1),t("td",null,l(r.akun),1),t("td",R,l(r.is_debit?e.$h.formatNumber(r.amount):0),1),t("td",j,l(r.is_debit?0:e.$h.formatNumber(r.amount)),1),F]))),128))],64))),128))])])])])}const J=I(C,[["render",z],["__scopeId","data-v-7f780d83"]]),M={data(){return{lItem:[],item:{},columns:[{field:"akun_code",header:"Nomor"},{field:"akun",header:"Akun"},{field:"debit",header:"Debit",class:"text-right",type:"currency"},{field:"kredit",header:"Kredit",class:"text-right",type:"currency"}]}},methods:{async getData(){L.getJurnal("","").then(e=>{this.lItem=e.data.data}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.message})})},exportToXLSX(){this.$refs.Export.exportToXLSX()},initFilters(){this.filters={global:{value:null,matchMode:N.CONTAINS}}}},mounted(){this.getData()},components:{Export:J}},P={class:"grid crud-demo"},K={class:"col-12"},G={class:"card"},U=t("h5",{class:"mb-0"},"Laporan Jurnal",-1),V={class:"card-body"},q={key:0},H={key:1},Q={class:"w-full flex justify-content-center"},W={key:2},Y={key:3,class:"text-right"},Z={key:4},tt={class:"w-full"},et={class:"flex gap-2 p-2"},ot=t("div",{class:"text-md font-bold"},"Nomor:",-1),lt={class:"text-md"},st={class:"flex gap-2 p-2"},nt=t("div",{class:"text-md font-bold"},"Referensi:",-1),rt={class:"text-md"},dt={class:"flex gap-2 p-2"},ct=t("div",{class:"text-md font-bold"},"Tanggal:",-1),at={class:"text-md"},it={class:"flex gap-2 p-2"},ut=t("div",{class:"text-md font-bold"},"Jurnal:",-1),_t={class:"text-md"},ht={colspan:"4"},pt={class:"flex gap-2 p-2"},mt=t("div",{class:"text-md font-bold"},"Note:",-1),bt={class:"text-md"};function ft(e,i,x,$,u,f){const o=g("Toast"),r=g("Button"),A=g("Toolbar"),p=g("Tag"),m=g("Column"),b=g("DataTable"),k=g("Export");return n(),d(h,null,[t("div",P,[t("div",K,[t("div",G,[y(o),y(A,{class:"mb-2"},{start:T(()=>[U]),end:T(()=>[y(r,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:i[0]||(i[0]=s=>f.exportToXLSX()),disabled:!u.lItem.length>0,loading:!u.lItem.length>0},null,8,["disabled","loading"])]),_:1}),t("div",V,[y(b,{value:u.lItem,rowGroupMode:"subheader",groupRowsBy:"parent.gl_number",sortMode:"single",sortField:"parent.gl_number",sortOrder:1,scrollable:"",tableStyle:"min-width: 50rem"},{groupheader:T(({data:s})=>[t("table",tt,[t("tr",null,[t("td",null,[t("div",et,[ot,t("div",lt,l(s.parent.gl_number),1)])]),t("td",null,[t("div",st,[nt,t("div",rt,l(s.parent.reference),1)])]),t("td",null,[t("div",dt,[ct,t("div",at,l(e.$h.formatDate(s.parent.gl_date)),1)])]),t("td",null,[t("div",it,[ut,t("div",_t,l(s.parent.journal_code),1)])])]),t("tr",null,[t("td",ht,[t("div",pt,[mt,t("div",bt,l(s.parent.description),1)])])])])]),default:T(()=>[(n(!0),d(h,null,v(u.columns,s=>(n(),D(m,{key:s.field,field:s.field,header:s.header},{body:T(({data:_,field:a})=>[a=="icon"?(n(),d("div",q,[y(r,{icon:_[a],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):a=="status"?(n(),d("div",H,[t("div",Q,[y(p,{value:e.$h.getLabel(_[a]),severity:e.$h.getLabel(_[a])},null,8,["value","severity"])])])):s.type=="date"?(n(),d("div",W,l(e.$h.formatDate(_[a])),1)):s.type=="currency"?(n(),d("div",Y,l(e.$h.formatNumber(_[a])),1)):(n(),d("div",Z,l(_[a]),1))]),_:2},1032,["field","header"]))),128))]),_:1},8,["value"])])])])]),y(k,{ref:"Export",style:{display:"none"}},null,512)],64)}const xt=I(M,[["render",ft]]);export{xt as default};
