import{_ as L,o as r,c as d,b as t,m as y,q as v,t as o,W as x,p as S,g as I,F as B,r as _,d as p,e as k,n as D,k as O,C as P}from"./index-11eb6111.js";import{a as V}from"./index-fa5c02f8.js";import{a as C}from"./xlsx.min-b21a3818.js";import{a as M}from"./options-b2eb7ae6.js";import{_ as K}from"./data-empty-73bd2e8a.js";const X={props:{lItem:{type:Array,default:()=>[]}},data(){return{columns:[{field:"ap_number",header:"Nomor",expander:!0},{field:"date",header:"Tanggal",type:"date"},{field:"invoice_number",header:"Invoice"},{field:"invoice_date",header:"Tanggal Invoice",type:"date"},{field:"due_date",header:"Jatuh Tempo",type:"date"},{field:"amount",header:"Nilai Invoice",class:"justify-content-end",type:"currency"},{field:"pay",header:"Bayar",class:"justify-content-end",type:"currency"},{field:"discount",header:"Diskon",class:"justify-content-end",type:"currency"},{field:"sisa",header:"Sisa Tagihan",class:"justify-content-end",type:"currency"},{field:"umur_overdue",header:"Umur Jatuh Tempo",type:"number"},{field:"po_number",header:"Nomor PO"},{field:"keterangan",header:"Keterangan"}]}},methods:{exportToXLSX(){const e=C.utils.table_to_sheet(document.getElementById("table")),n=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];e["!cols"]=n;for(const u in e)if(Object.prototype.hasOwnProperty.call(e,u)){const l=e[u];l.t==="n"&&(l.z="0")}e.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}},e.A2.s={font:{name:"Arial Black",sz:16,bold:!0},alignment:{vertical:"center",horizontal:"center"}};let f={fill:{patternType:"solid",fgColor:{rgb:"49b1fb"},bgColor:{rgb:"49b1fb"}},alignment:{vertical:"center",horizontal:"center"}};const i={s:{c:0,r:5},e:{c:11,r:5}};for(let u=i.s.r;u<=i.e.r;u++)for(let l=i.s.c;l<=i.e.c;l++){const b=C.utils.encode_cell({r:u,c:l});e[b].s=f}["F","G","H","I"].forEach(u=>{for(let l=7;l<=this.totalDataObjects+7;l++){const b=u+l,g=e[b];g&&g.v&&(g.s={alignment:{vertical:"center",horizontal:"right"}})}});const m=C.utils.book_new();C.utils.book_append_sheet(m,e,"Sheet1"),C.writeFile(m,"exported_data.xlsx")}},created(){},mounted(){},computed:{totalDataObjects(){let e=0;for(const n of this.lItem)if(e++,n.children&&Array.isArray(n.children))for(const f of n.children)e++;return e}}},F=e=>(S("data-v-128f6523"),e=e(),I(),e),E={border:"1",id:"table"},R=F(()=>t("tr",null,[t("td",{colspan:"12"},"PT Planet IT (PRODUK)")],-1)),Y=F(()=>t("tr",null,[t("td",{colspan:"12"},"LAPORAN HUTANG (AP) BELUM LUNAS")],-1));function U(e,n,f,i,s,m){return r(),d("div",null,[t("button",{onClick:n[0]||(n[0]=(...u)=>m.exportToXLSX&&m.exportToXLSX(...u))},"Export to XLSX"),t("div",null,[t("table",E,[t("thead",null,[R,Y,t("tr",null,[(r(),d(y,null,v(12,u=>t("td",{key:u},o(" "))),64))]),t("tr",null,[(r(),d(y,null,v(12,u=>t("td",{key:u},o(" "))),64))]),t("tr",null,[(r(),d(y,null,v(12,u=>t("td",{key:u},o(" "))),64))]),t("tr",null,[(r(!0),d(y,null,v(s.columns,(u,l)=>(r(),d("th",{key:l},o(u.header),1))),128))])]),t("tbody",null,[(r(!0),d(y,null,v(f.lItem,({key:u,data:l,children:b,style:g})=>(r(),d(y,{key:u},[t("tr",{style:x(g==="font-bold"?"font-weight: bold;":"")},[t("td",null,o(l.invoice_number),1),t("td",null,o(e.$h.formatDate(l.invoice_date)),1),t("td",null,o(l.due_date!="Total"?e.$h.formatDate(l.due_date):l.due_date),1),t("td",null,o(l.amount?e.$h.formatNumber(l.amount):null),1),t("td",null,o(l.pay?e.$h.formatNumber(l.pay):null),1),t("td",null,o(l.discount?e.$h.formatNumber(l.discount):null),1),t("td",null,o(l.sisa?e.$h.formatNumber(l.sisa):null),1),t("td",null,o(l.umur_overdue),1),t("td",null,o(l.po_number),1),t("td",null,o(l.keterangan),1)],4),(r(!0),d(y,null,v(b,({key:T,data:c})=>(r(),d("tr",{key:T,style:x(c.style==="font-bold"?"font-weight: bold;":"")},[t("td",null,o(c.invoice_number),1),t("td",null,o(e.$h.formatDate(c.invoice_date)),1),t("td",null,o(c.due_date!="Total"?e.$h.formatDate(c.due_date):c.due_date),1),t("td",null,o(c.amount?e.$h.formatNumber(c.amount):null),1),t("td",null,o(c.pay?e.$h.formatNumber(c.pay):null),1),t("td",null,o(c.discount?e.$h.formatNumber(c.discount):null),1),t("td",null,o(c.sisa?e.$h.formatNumber(c.sisa):null),1),t("td",null,o(c.umur_overdue),1),t("td",null,o(c.po_number),1),t("td",null,o(c.keterangan),1)],4))),128))],64))),128))])])])])}const z=L(X,[["render",U],["__scopeId","data-v-128f6523"]]);const $={components:{Export:z},data(){return{columns:[{field:"date",header:"",expander:!0},{field:"tanggal",header:"Tanggal",type:"date"},{field:"kode_barang",header:"Kode Barang"},{field:"nama_barang",header:"Nama Barang"},{field:"qty",header:"QTY",class:"justify-content-end",type:"currency"},{field:"satuan",header:"Satuan",class:"justify-content-end"},{field:"jumlah_tagihan",header:"Jumlah Tagihan",class:"justify-content-end",type:"currency"},{field:"total",header:"Total",class:"justify-content-end",type:"currency"}],lItem:[],filter:!1,filters:{},expandedKeys:{},grandtotal:null,lCustomer:[],selectedCustomer:null,selectedStatus:null,periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],f:{awal:null,akhir:null,selectedStatus:{label:"All",value:""}},selectedPeriode:{label:"All",value:""}}},created(){this.initFilters()},mounted(){this.getData()},methods:{ubahCustomer(e){e.value===null?this.f.id_supplier=null:this.f.id_supplier=this.selectedCustomer.id,this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},ubahPeriode(){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=n,this.f.akhir=f;break}case"Kemarin":{const i=new Date(new Date(n).setDate(n.getDate()-1));this.f.awal=i,this.f.akhir=i;break}case"Perminggu":{const i=new Date(new Date(n).setDate(n.getDate()-7));this.f.awal=i,this.f.akhir=f;break}case"Perbulan":{const i=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=i,this.f.akhir=f;break}case"Pertahun":{const i=new Date(e.getFullYear(),0,1);this.f.awal=i,this.f.akhir=f;break}case"MingguLalu":{const i=new Date(new Date(n).setDate(n.getDate()-n.getDay()-7)),s=new Date(new Date(i).setDate(i.getDate()+6));this.f.awal=i,this.f.akhir=s;break}case"BulanLalu":{const i=new Date(e.getFullYear(),e.getMonth()-1,1),s=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=i,this.f.akhir=s;break}case"TahunLalu":{const i=new Date(e.getFullYear()-1,0,1),s=new Date(e.getFullYear()-1,11,31);this.f.awal=i,this.f.akhir=s;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},exportToXLSX(){this.$refs.Export.exportToXLSX()},async getData(){M.getKontakCustomer().then(e=>{this.lCustomer=e.data.data,e.data.data.length==1&&(this.selectedCustomer=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),await this.getReport()},getReport(){V.getPenjualanCustomer(this.f).then(e=>{this.grandtotal=e.data.total,this.lItem=e.data.data,this.lItem.map(n=>this.expandedKeys[n.key]=!0)}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})})},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}},showHideFilter(){this.filter=!this.filter}}},w=e=>(S("data-v-dbfe3cef"),e=e(),I(),e),H={class:"grid crud-demo"},J={class:"col-12"},W={class:"card"},q={class:"my-2"},G=w(()=>t("h5",{class:"mbe-4"},"Filter Penjualan Customer",-1)),Q={class:"p-fluid formgrid grid"},Z={class:"field col-2 d-flex justifiy-content-center align-items-end"},ee=w(()=>t("label",{for:"supplier",class:"mb-1"},"Customer",-1)),te={class:"field col-2 d-flex justifiy-content-center align-items-end"},le=w(()=>t("label",{for:"periode",class:"mb-1"},"Periode",-1)),ae={class:"field col-2"},ne={class:"p-float-label"},oe=w(()=>t("p",{class:"mb-1"},"Periode Awal",-1)),se={class:"field col-2"},re={class:"p-float-label"},ie=w(()=>t("p",{class:"mb-1"},"Periode Akhir",-1)),de={key:0},ue={key:0},ce={key:1,class:"text-right"},he={key:1},me={key:2,class:"text-right"},fe={key:0},pe={key:1},_e={key:3},ye={class:"text-right"},ge=w(()=>t("div",{class:"flex flex-column gap-2 justify-content-center align-items-center"},[t("div",{class:"text-4xl"},"Loading...")],-1)),be=w(()=>t("div",{class:"flex flex-column gap-2 justify-content-center align-items-center"},[t("img",{src:K,alt:"",style:{width:"300px"}}),t("div",{class:"text-4xl"},"Belum ada data.")],-1));function ve(e,n,f,i,s,m){const u=_("Toast"),l=_("Button"),b=_("Toolbar"),g=_("Dropdown"),T=_("Calendar"),c=_("Tag"),N=_("Column"),A=_("TreeTable"),j=_("Export");return r(),d(y,null,[t("div",H,[t("div",J,[t("div",W,[p(u),p(b,{class:"mb-2"},{start:k(()=>[t("div",q,[p(l,{icon:"pi pi-filter",label:"Filter",class:D(["p-button mx-2",{"p-button-block":s.filter,"p-button-outlined":!s.filter}]),onClick:m.showHideFilter},null,8,["onClick","class"])])]),_:1}),t("div",{class:D(["card",{hidden:!s.filter}])},[G,t("div",Q,[t("div",Z,[ee,p(g,{id:"supplier",modelValue:s.selectedCustomer,"onUpdate:modelValue":n[0]||(n[0]=a=>s.selectedCustomer=a),onChange:m.ubahCustomer,options:s.lCustomer,placeholder:"Customer",optionLabel:"kontak",showClear:""},null,8,["modelValue","onChange","options"])]),t("div",te,[le,p(g,{id:"periode",modelValue:s.selectedPeriode,"onUpdate:modelValue":n[1]||(n[1]=a=>s.selectedPeriode=a),onChange:m.ubahPeriode,options:s.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),t("div",ae,[t("span",ne,[oe,p(T,{dateFormat:"dd-mm-yy",modelValue:s.f.awal,"onUpdate:modelValue":n[2]||(n[2]=a=>s.f.awal=a),onDateSelect:m.getReportCustom,inputId:"periodeawal"},null,8,["modelValue","onDateSelect"])])]),t("div",se,[t("span",re,[ie,p(T,{dateFormat:"dd-mm-yy",modelValue:s.f.akhir,"onUpdate:modelValue":n[3]||(n[3]=a=>s.f.akhir=a),onDateSelect:m.getReportCustom,inputId:"periodeakhir"},null,8,["modelValue","onDateSelect"])])])])],2),p(A,{expandedKeys:s.expandedKeys,"onUpdate:expandedKeys":n[4]||(n[4]=a=>s.expandedKeys=a),value:s.lItem,indentation:"1",scrollable:"",scrollDirection:"both"},{default:k(()=>[(r(!0),d(y,null,v(s.columns,a=>(r(),O(N,{key:a.field,field:a.field,header:a.header,class:D(a.class),expander:a.expander,style:x([a.style,{width:"250px"}])},P({body:k(h=>[a.type=="date"?(r(),d("div",de,[new Date(h.node.data[a.field])instanceof Date&&!isNaN(new Date(h.node.data[a.field]))?(r(),d("div",ue,o(e.$h.formatDate(new Date(h.node.data[a.field]))),1)):(r(),d("div",{key:1,class:D(h.node.data.style)},o(h.node.data[a.field]),3))])):a.type=="currency"?(r(),d("div",ce,[h.node.data[a.field]?(r(),d("div",{key:0,class:D(h.node.data.style)},o(e.$h.formatNumber(h.node.data[a.field])),3)):(r(),d("div",he))])):a.type=="number"?(r(),d("div",me,[h.node.data[a.field]?(r(),d("div",fe,o(e.$h.formatNumber(h.node.data[a.field])),1)):(r(),d("div",pe))])):e.field=="status"?(r(),d("div",_e,[p(c,{style:{float:"right"},value:e.$h.getLabel(h.node.data[a.field]),severity:e.$h.getLabel(h.node.data[a.field])},null,8,["value","severity"])])):(r(),d("div",{key:4,class:D(h.node.data.style)},o(h.node.data[a.field]),3))]),loading:k(()=>[ge]),empty:k(()=>[be]),_:2},[a.field=="total"?{name:"footer",fn:k(()=>[t("div",ye,o(e.$h.formatNumber(s.grandtotal)),1)]),key:"0"}:void 0]),1032,["field","header","class","expander","style"]))),128))]),_:1},8,["expandedKeys","value"])])])]),p(j,{ref:"Export",style:{display:"none"},lItem:s.lItem},null,8,["lItem"])],64)}const xe=L($,[["render",ve],["__scopeId","data-v-dbfe3cef"]]);export{xe as default};
