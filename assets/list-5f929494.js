import{D as b,_ as U,F as B,r as n,A as K,o as h,c as _,b as a,d as o,e as r,n as v,l as u,t as w,m as q,q as H,B as R,f as J,k as M,p as j,g as z}from"./index-11eb6111.js";import"./custom-zod-e9521e5d.js";import{A as O}from"./index-b9e295bc.js";import{z as d}from"./index-0ec66d4d.js";const x={index(){return b.get("/saldo-awal-ap/")},store(e){return b.post("/saldo-awal-ap/",e)},update(e,t){return b.patch("/saldo-awal-ap/"+e,t)},show(e){return b.get("/saldo-awal-ap/"+e)},destroy(e){return b.delete("/saldo-awal-ap/"+e)}};const X=d.object({date:d.date(),ap_number:d.string().nullish(),invoice_date:d.date(),invoice_number:d.string(),amount:d.number().gt(0),top:d.number().nullish(),due_date:d.date(),id_supplier:d.number().int().gt(0),id_top:d.number().int().gt(0)}),Y={components:{},data(){return{lItem:[],item:{date:null,invoice_date:null,invoice_number:null,amount:0,top:0,due_date:null},nullItem:null,old_number:null,filter:!1,filters:{},f:{awal:null,akhir:null,id_supplier:null},selectedColumns:[{field:"ap_number",header:"Nomor AP",class:"text-left"},{field:"date",header:"Tanggal",class:"text-left"},{field:"kontak",header:"Supplier",class:"text-left"},{field:"invoice_number",header:"Nomor Invoice",class:"text-left"},{field:"invoice_date",header:"Tanggal Invoice",class:"text-left"},{field:"due_date",header:"Tanggal Jatuh Tempo",class:"text-left"},{field:"amount",header:"Jumlah",class:"text-right"}],Columns:[{field:"ap_number",header:"Nomor AP",class:"text-left"},{field:"date",header:"Tanggal",class:"text-left"},{field:"kontak",header:"Supplier",class:"text-left"},{field:"invoice_number",header:"Nomor Invoice",class:"text-left"},{field:"invoice_date",header:"Tanggal Invoice",class:"text-left"},{field:"due_date",header:"Tanggal Jatuh Tempo",class:"text-left"},{field:"amount",header:"Jumlah",class:"text-right"}],formDialog:!1,deleteformDialog:!1,isClean:!0}},computed:{filteredSaldoAwal(){return this.lItem.filter(e=>(this.f.id_supplier?this.f.id_supplier==e.id_supplier:!0)&&(this.f.awal?this.f.awal.toLocaleDateString()<=new Date(e.date).toLocaleDateString():!0)&&(this.f.akhir?this.f.akhir.toLocaleDateString()>=new Date(e.date).toLocaleDateString():!0))},FormError(){var e,t;return this.isClean?{}:((t=(e=X.safeParse(this.item))==null?void 0:e.error)==null?void 0:t.format())||{}}},created(){this.initFilters()},mounted(){this.nullItem={...this.item},this.$isLoading.value=!0,this.getData().finally(()=>{this.$timeoutLoading()})},watch:{"item.top"(e){if(this.item){const t=new Date(this.item.date);t.setDate(new Date(this.item.date).getDate()+e),this.item.due_date=t}},"item.date"(e){if(this.item){const t=new Date(e);t.setDate(new Date(e).getDate()+this.item.top),this.item.due_date=t}}},methods:{async getData(){await x.index().then(e=>{this.lItem=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data Saldo Awal",life:3e3})})},FormNew(){this.item={date:new Date,invoice_date:new Date,invoice_number:null,amount:0,top:0,due_date:new Date},this.formDialog=!0,this.isClean=!0},HideDialog(){this.formDialog=!1,this.isClean=!0},confirmDelete(e){this.old_number=e.ap_number,this.item={...e},this.deleteformDialog=!0},async Save(){try{if(this.isClean=!1,this.$isLoading.value=!0,Object.keys(this.FormError).length>0){this.$toast.add({severity:"warn",summary:"Failed",detail:"validate error",life:3e3});return}this.isEdit?await x.update(this.old_number,this.item).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem[this.lItem.findIndex(t=>t.ap_number==e.data.data.ap_number)]=this.item,this.isEdit=!1,this.formDialog=!1,this.isClean=!0,this.item={}}):await x.store(this.item).then(()=>{this.getData(),this.item.amount=0,this.item.top=0,this.item.invoice_number=null,this.selectedKontak=null,this.formDialog=!1,this.isClean=!0,this.$toast.add({severity:"success",summary:"Successful",detail:"Created Saldo Awal",life:3e3})})}catch(e){e instanceof O&&this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}finally{this.$timeoutLoading()}},searchFilterKontak(e){setTimeout(()=>{this.f.filteredlKontak=e.query.trim().length?this.lKontak.filter(t=>t.kontak.toLowerCase().includes(e.query.toLowerCase())):[...this.lKontak]},250)},FormEdit(e){this.isEdit=!0,this.old_number=e.ap_number,this.item={...e},this.item.date=new Date(this.item.date),this.item.due_date=new Date(this.item.due_date),this.item.invoice_date=new Date(this.item.invoice_date),this.item.amount=parseFloat(e.amount),this.formDialog=!0},ondblclick(e){this.isEdit=!0,this.old_number=e.data.ap_number,this.item={...e.data},this.item.amount=parseFloat(e.data.amount),this.item.date=new Date(this.item.date),this.item.due_date=new Date(this.item.due_date),this.item.invoice_date=new Date(this.item.invoice_date),this.formDialog=!0},async Destroy(){this.deleteformDialog=!1;try{const e=await x.destroy(this.old_number);e&&(console.log(this.item,this.lItem),this.lItem=this.lItem.filter(t=>t.ap_number!==this.item.ap_number),this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}))}finally{this.item={}}},showHideFilter(){this.filter=!this.filter},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}}},m=e=>(j("data-v-ea21cefc"),e=e(),z(),e),G={class:"grid crud-demo"},Q={class:"col-12"},W={class:"card"},Z={class:"my-2"},$=m(()=>a("h5",{class:"mbe-4"},"Pencarian Saldo Awal Hutang",-1)),ee={class:"p-fluid formgrid grid"},te={class:"field col-2"},le={class:"p-float-label"},ie=m(()=>a("p",{class:"mb-2"},"Periode Awal",-1)),oe={class:"field col-2"},ae={class:"p-float-label"},se=m(()=>a("p",{class:"mb-2"},"Periode Akhir",-1)),re={class:"field col-2"},ne={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},de=m(()=>a("h5",{class:"m-0"},"Saldo Awal Hutang",-1)),me={class:"block mt-2 md:mt-0 p-input-icon-left"},ue=m(()=>a("i",{class:"pi pi-search"},null,-1)),ce=m(()=>a("div",{class:"text-center"},"Empty",-1)),pe={key:0},he={key:1},_e={key:2},fe={class:"formgrid grid"},ge={class:"field col-12 md:col-6"},be={class:"field col-12 md:col-6"},ve={class:"field col-12 md:col-6"},we={class:"field col-12 md:col-6"},De={class:"field col-12 md:col-4"},ye={class:"field col-12 md:col-4"},ke={class:"field col-12 md:col-4"},xe=m(()=>a("label",{required:""},"Tanggal Jatuh Tempo ",-1)),Ce={class:"field col-12 md:col-12"},Se=m(()=>a("label",null,[u("Jumlah "),a("small",{class:"text-red-500"},"*")],-1)),Ve={class:"flex align-items-center justify-content-center"},Fe=m(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ie={key:0};function Te(e,t,Ee,Ae,i,s){const I=n("Toast"),c=n("Button"),T=n("Toolbar"),D=n("Calendar"),V=n("AutoCompleteKontak"),y=n("InputText"),C=n("Column"),E=n("ActionButton"),A=n("DataTable"),k=n("Label"),f=n("ErrorMsg"),L=n("InputTop"),N=n("InputNumber"),F=n("Dialog"),P=K("select-all-text");return h(),_("div",G,[a("div",Q,[a("div",W,[o(I),o(T,{class:"mb-4"},{start:r(()=>[a("div",Z,[o(c,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:s.FormNew},null,8,["onClick"])]),o(c,{icon:"pi pi-filter",label:"Filter",class:v(["p-button mx-2",{"p-button-block":i.filter,"p-button-outlined":!i.filter}]),onClick:s.showHideFilter},null,8,["onClick","class"])]),end:r(()=>[o(c,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:t[0]||(t[0]=l=>s.exportCSV(l))})]),_:1}),a("div",{class:v(["card fadein",{hidden:!i.filter}])},[$,a("div",ee,[a("div",te,[a("span",le,[ie,o(D,{dateFormat:"dd-mm-yy",modelValue:i.f.awal,"onUpdate:modelValue":t[1]||(t[1]=l=>i.f.awal=l),inputId:"periodeawal"},null,8,["modelValue"])])]),a("div",oe,[a("span",ae,[se,o(D,{dateFormat:"dd-mm-yy",modelValue:i.f.akhir,"onUpdate:modelValue":t[2]||(t[2]=l=>i.f.akhir=l),inputId:"periodeakhir"},null,8,["modelValue"])])]),a("div",re,[o(V,{modelValue:i.f.id_supplier,"onUpdate:modelValue":t[3]||(t[3]=l=>i.f.id_supplier=l),label:"Supplier",required:!1,"is-supplier":""},null,8,["modelValue"])])])],2),o(A,{ref:"dt",value:s.filteredSaldoAwal,selection:i.item,"onUpdate:selection":t[5]||(t[5]=l=>i.item=l),"selection-mode":"single",onRowDblclick:s.ondblclick,dataKey:"id",paginator:!0,rows:10,filters:i.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{header:r(()=>[a("div",ne,[de,a("span",me,[ue,o(y,{modelValue:i.filters.global.value,"onUpdate:modelValue":t[4]||(t[4]=l=>i.filters.global.value=l),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:r(()=>[ce]),default:r(()=>[o(C,{header:"#",headerStyle:"width:10px"},{body:r(l=>[u(w(l.index+1),1)]),_:1}),(h(!0),_(q,null,H(i.selectedColumns,(l,S)=>(h(),M(C,{field:l.field,header:l.header,class:v(l.class),key:l.field+"_"+S,sortable:!0},{body:r(({data:g,field:p})=>[p=="date"||p=="due_date"||p=="invoice_date"?(h(),_("div",pe,w(e.$h.formatDate(g[p])),1)):p=="amount"?(h(),_("div",he,w(e.$h.formatNumber(g[p])),1)):(h(),_("div",_e,w(g[p]),1))]),_:2},1032,["field","header","class"]))),128)),o(C,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:r(({data:l,index:S})=>[o(E,{data:l,index:S,onEdit:g=>s.FormEdit(l),onDelete:g=>s.confirmDelete(l)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","selection","onRowDblclick","filters"]),o(F,{visible:i.formDialog,"onUpdate:visible":t[14]||(t[14]=l=>i.formDialog=l),style:{width:"640px"},header:"Form Saldo Awal Hutang",modal:!0,class:"p-fluid"},{footer:r(()=>[o(c,{label:"Cancel",icon:"pi pi-times",class:"p-button-text p-button-danger",onClick:s.HideDialog},null,8,["onClick"]),o(c,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:s.Save},null,8,["onClick"])]),default:r(()=>[a("div",fe,[a("div",ge,[o(k,{for:"ap_numberap"},{default:r(()=>[u("Nomor AP")]),_:1}),o(y,{id:"ap_numberap",modelValue:i.item.ap_number,"onUpdate:modelValue":t[6]||(t[6]=l=>i.item.ap_number=l),disabled:""},null,8,["modelValue"]),o(f,{error:s.FormError.ap_number},null,8,["error"])]),a("div",be,[o(k,{for:"tglap",required:""},{default:r(()=>[u("Tanggal")]),_:1}),o(D,{modelValue:i.item.date,"onUpdate:modelValue":t[7]||(t[7]=l=>i.item.date=l),inputId:"tglap",maxDate:e.$h.today,class:v(s.FormError.date&&"p-invalid")},null,8,["modelValue","maxDate","class"])]),a("div",ve,[o(V,{modelValue:i.item.id_supplier,"onUpdate:modelValue":t[8]||(t[8]=l=>i.item.id_supplier=l),onSelectItem:e.selectKontak,label:"Supplier",error:s.FormError.id_supplier,"is-supplier":""},null,8,["modelValue","onSelectItem","error"])]),a("div",we,[o(k,{required:"",for:"ap_numberinvoice"},{default:r(()=>[u("Nomor Invoice ")]),_:1}),o(y,{id:"ap_numberap",modelValue:i.item.invoice_number,"onUpdate:modelValue":t[9]||(t[9]=l=>i.item.invoice_number=l),error:s.FormError.invoice_number&&"p-invalid"},null,8,["modelValue","error"]),o(f,{error:s.FormError.invoice_number},null,8,["error"])]),a("div",De,[o(k,{required:""},{default:r(()=>[u("Tanggal Invoice ")]),_:1}),o(D,{modelValue:i.item.invoice_date,"onUpdate:modelValue":t[10]||(t[10]=l=>i.item.invoice_date=l),inputId:"tglinvoice"},null,8,["modelValue"]),o(f,{error:s.FormError.invoice_date},null,8,["error"])]),a("div",ye,[o(L,{top:i.item.top,"onUpdate:top":t[11]||(t[11]=l=>i.item.top=l),id:i.item.id_top,"onUpdate:id":t[12]||(t[12]=l=>i.item.id_top=l),error:s.FormError.id_top},null,8,["top","id","error"])]),a("div",ke,[xe,o(y,{id:"ap_numberap",value:e.$h.formatDate(i.item.due_date),disabled:""},null,8,["value"]),o(f,{error:s.FormError.due_date},null,8,["error"])]),a("div",Ce,[Se,R(o(N,{modelValue:i.item.amount,"onUpdate:modelValue":t[13]||(t[13]=l=>i.item.amount=l),name:"harga",mode:"currency",min:"0",locale:"id-ID",currency:"IDR",class:v(["min-w-max text-right",s.FormError.amount&&"p-invalid"])},null,8,["modelValue","class"]),[[P]]),o(f,{error:s.FormError.amount},null,8,["error"])])])]),_:1},8,["visible"]),o(F,{visible:i.deleteformDialog,"onUpdate:visible":t[16]||(t[16]=l=>i.deleteformDialog=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[o(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[15]||(t[15]=l=>i.deleteformDialog=!1)}),o(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:s.Destroy},null,8,["onClick"])]),default:r(()=>[a("div",Ve,[Fe,i.item?(h(),_("span",Ie,[u("Are you sure you want to delete "),a("b",null,w(i.item.ap_number),1),u("?")])):J("",!0)])]),_:1},8,["visible"])])])])}const Be=U(Y,[["render",Te],["__scopeId","data-v-ea21cefc"]]);export{Be as default};
