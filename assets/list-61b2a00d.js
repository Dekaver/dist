import{_ as T,$ as R,F as B,r as i,o as c,c as h,b as s,d as n,e as u,n as b,k,l as v,t as m,m as M,q as j}from"./index-11eb6111.js";import{a as K}from"./options-b2eb7ae6.js";import{a as N}from"./kategoriproduk-68d52205.js";import{a as O}from"./index-fa5c02f8.js";import{a as f}from"./xlsx.min-b21a3818.js";const U={data(){return{items:[],statuses:[{label:"All",value:""},{label:"Lunas",value:"Lunas"},{label:"Belum Lunas",value:"Belum Lunas"},{label:"Belum Bayar",value:"Belum Bayar"}],periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],periode:{awal:null,akhir:null},f:{awal:null,akhir:null},selectedPeriode:{label:"All",value:""},selectedColumns:[{field:"invoice",header:"Nomor",class:"text-left"},{field:"customer",header:"Customer",class:"text-left"},{field:"amount",header:"Total",class:"text-left",type:"currency"},{field:"pay",header:"Bayar",class:"text-left",type:"currency"},{field:"sisa_tagihan",header:"Sisa Tagihan",class:"text-left",type:"currency"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],Columns:[{field:"invoice",header:"Nomor",class:"text-left"},{field:"customer",header:"Customer",class:"text-left"},{field:"amount",header:"Total",class:"text-left",type:"currency"},{field:"pay",header:"Bayar",class:"text-left",type:"currency"},{field:"sisa_tagihan",header:"Sisa Tagihan",class:"text-left",type:"currency"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],lKategori:[],selectedKategori:null,lGudang:[],selectedGudang:null,lCustomer:[],selectedCustomer:null,lStatus:[],selectedStatus:null,filter:!1,filters:{}}},created(){this.initFilters()},mounted(){this.getData()},methods:{ubahCustomer(e){e.value===null?this.f.id_customer=null:this.f.id_customer=this.selectedCustomer.id,this.getReport()},ubahStatus(e){this.f.status=e.value.value,this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},exportToXLSX(){const e=f.utils.table_to_sheet(document.querySelector("table")),a=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];e["!cols"]=a;const r=f.utils.book_new();f.utils.book_append_sheet(r,e,"Sheet1"),f.writeFile(r,`Report Penjualan ${new Date().getTime()}.xlsx`)},ubahPeriode(){const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=a,this.f.akhir=r;break}case"Kemarin":{const o=new Date(new Date(a).setDate(a.getDate()-1));this.f.awal=o,this.f.akhir=o;break}case"Perminggu":{const o=new Date(new Date(a).setDate(a.getDate()-7));this.f.awal=o,this.f.akhir=r;break}case"Perbulan":{const o=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=o,this.f.akhir=r;break}case"Pertahun":{const o=new Date(e.getFullYear(),0,1);this.f.awal=o,this.f.akhir=r;break}case"MingguLalu":{const o=new Date(new Date(a).setDate(a.getDate()-a.getDay()-7)),t=new Date(new Date(o).setDate(o.getDate()+6));this.f.awal=o,this.f.akhir=t;break}case"BulanLalu":{const o=new Date(e.getFullYear(),e.getMonth()-1,1),t=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=o,this.f.akhir=t;break}case"TahunLalu":{const o=new Date(e.getFullYear()-1,0,1),t=new Date(e.getFullYear()-1,11,31);this.f.awal=o,this.f.akhir=t;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},getReport(){O.getPenjualan(this.f).then(e=>{this.items=e.data.data,console.log(this.items,"itemmss")}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Report Penjualan",life:3e3})}).finally(()=>{this.loading=!1})},getData(){this.getReport(),this.loading=!0,N.index().then(e=>{this.lKategori=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Kategori Barang",life:3e3})}).finally(()=>{this.loading=!1}),K.getKontakCustomer().then(e=>{this.lCustomer=e.data.data,e.data.data.length==1&&(this.selectedCustomer=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),R.index().then(e=>{this.lGudang=e.data.data,e.data.data.length==1&&(this.selectedGudang=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Gudang",life:3e3})}).finally(()=>{this.loading=!1})},selectKontak(e){this.id_customer=e.value.id,this.customer=e.value.text},formatNumber(e){if(e)return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},exportCSV(){this.$refs.dt.exportCSV({filename:"Penjualan.csv"})},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}},components:{}},Y={class:"grid crud-demo"},A={class:"col-12"},I={class:"card"},E={class:"my-2"},G=s("h5",{class:"mbe-4"},"Filter Report Penjualan",-1),q={class:"p-fluid formgrid grid"},H={class:"field col-2 d-flex justifiy-content-center align-items-end"},W=s("label",{for:"customer",class:"mb-1"},"Customer",-1),X={class:"field col-2 d-flex justifiy-content-center align-items-end"},z=s("label",{for:"status",class:"mb-1"},"Status",-1),J={class:"field col-2 d-flex justifiy-content-center align-items-end"},Q=s("label",{for:"periode",class:"mb-1"},"Periode",-1),Z={class:"field col-2"},$={class:"p-float-label"},ee=s("p",{class:"mb-1"},"Periode Awal",-1),te={class:"field col-2"},ae={class:"p-float-label"},le=s("p",{class:"mb-1"},"Periode Akhir",-1),se={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},oe=s("h5",{class:"m-0"},"Report Penjualan",-1),ne={class:"flex gap-2 col-12 md:col-5"},ie={class:"block p-input-icon-left w-full"},re=s("i",{class:"pi pi-search"},null,-1),de={key:0,class:"text-right"},ue={key:1};function ce(e,a,r,o,t,d){const x=i("Toast"),w=i("Button"),D=i("MyExport"),P=i("Toolbar"),p=i("Dropdown"),_=i("Calendar"),L=i("InputText"),S=i("MultiSelect"),g=i("Column"),V=i("DataTable");return c(),h("div",Y,[s("div",A,[s("div",I,[n(x),n(P,{class:"mb-4"},{start:u(()=>[s("div",E,[n(w,{icon:"pi pi-filter",label:"Filter",class:b(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:d.showHideFilter},null,8,["onClick","class"])])]),end:u(()=>[n(D,{value:t.items,selectedColumns:t.selectedColumns,title:"Export Excel"},null,8,["value","selectedColumns"]),n(w,{icon:"pi pi-external-link",label:"Export CSV",title:"Report Penjualan",name:"Report Penjualan",onClick:a[0]||(a[0]=l=>d.exportCSV(l))})]),_:1}),s("div",{class:b(["card",{hidden:!t.filter}])},[G,s("div",q,[s("div",H,[W,n(p,{id:"customer",modelValue:t.selectedCustomer,"onUpdate:modelValue":a[1]||(a[1]=l=>t.selectedCustomer=l),onChange:d.ubahCustomer,options:t.lCustomer,placeholder:"Customer",optionLabel:"kontak",showClear:""},null,8,["modelValue","onChange","options"])]),s("div",X,[z,n(p,{id:"status",modelValue:t.selectedStatus,"onUpdate:modelValue":a[2]||(a[2]=l=>t.selectedStatus=l),options:t.statuses,onChange:d.ubahStatus,optionLabel:"label",placeholder:"All"},null,8,["modelValue","options","onChange"])]),s("div",J,[Q,n(p,{id:"periode",modelValue:t.selectedPeriode,"onUpdate:modelValue":a[3]||(a[3]=l=>t.selectedPeriode=l),onChange:d.ubahPeriode,options:t.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),s("div",Z,[s("span",$,[ee,n(_,{dateFormat:"dd-mm-yy",onDateSelect:d.getReportCustom,modelValue:t.f.awal,"onUpdate:modelValue":a[4]||(a[4]=l=>t.f.awal=l),inputId:"periodeawal"},null,8,["onDateSelect","modelValue"])])]),s("div",te,[s("span",ae,[le,n(_,{dateFormat:"dd-mm-yy",onDateSelect:d.getReportCustom,modelValue:t.f.akhir,"onUpdate:modelValue":a[5]||(a[5]=l=>t.f.akhir=l),inputId:"periodeakhir"},null,8,["onDateSelect","modelValue"])])])])],2),n(V,{ref:"dt",value:t.items,selection:e.selectedItem,"onUpdate:selection":a[8]||(a[8]=l=>e.selectedItem=l),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Report Penjualan",responsiveLayout:"scroll"},{header:u(()=>[s("div",se,[oe,s("div",ne,[s("span",ie,[re,n(L,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[6]||(a[6]=l=>t.filters.global.value=l),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),n(S,{modelValue:t.selectedColumns,"onUpdate:modelValue":a[7]||(a[7]=l=>t.selectedColumns=l),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),default:u(()=>[(c(),k(g,{field:"no",header:"No",sortable:!1,headerStyle:"width:4%; min-width:3rem;",key:"no"},{body:u(l=>[v(m(l.index+1),1)]),_:1})),n(g,{field:"date",header:"Tanggal",sortable:!0,headerStyle:"width:14%; min-width:10rem;",key:"date"},{body:u(l=>[v(m(e.$h.formatDate(l.data.invoice_date)),1)]),_:1}),(c(!0),h(M,null,j(t.selectedColumns,(l,F)=>(c(),k(g,{field:l.field,header:l.header,class:b(l.class),key:l.field+"_"+F,sortable:!0},{body:u(({data:y,field:C})=>[l.type=="currency"?(c(),h("div",de,m(e.$h.formatNumber(y[C])),1)):(c(),h("div",ue,m(y[C]),1))]),_:2},1032,["field","header","class"]))),128))]),_:1},8,["value","selection","filters"])])])])}const be=T(U,[["render",ce]]);export{be as default};
