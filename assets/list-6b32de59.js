import{D as k,G as K,_ as M,F as j,r,A as z,o as u,c as p,b as s,d as o,e as a,n as f,t as m,f as v,l as h,m as R,q as G,B as E,k as H,p as O,g as Y}from"./index-11eb6111.js";import{a as Q}from"./produk-90d88791.js";import{a as Z}from"./satuan-84ad7de8.js";import{a as J}from"./kategoriproduk-68d52205.js";import{z as g}from"./index-0ec66d4d.js";import{A as W}from"./index-b9e295bc.js";const y={index(e={}){return k.get("/stok-awal/?"+K.stringify(e))},store(e){return k.post("/stok-awal/",e)},update(e,i){return k.patch("/stok-awal/"+e,i)},show(e){return k.get("/stok-awal/"+e)},delete(e){return k.delete("/stok-awal/"+e)}};const X=g.object({id_gudang:g.number(),id_barang:g.number(),kode_barang:g.string().nonempty(),qty:g.coerce.number(),hpp:g.coerce.number()}),$={data(){return{FormError:{},lItem:[],lProduk:[],selectedProduk:null,filteredlProduk:[],lSatuan:[],lKategori:[],formDialog:!1,deleteDialog:!1,submitted:!1,item:{id:null,id_barang:null,kode_barang:null,satuan:null,id_gudang:1,hpp:null,stok:null},f:{selectedSatuan:null},filters:{},filter:!1,selectedColumns:[{field:"kode_barang",header:"Kode",class:"text-left"},{field:"nama_barang",header:"Produk",class:"text-left"},{field:"qty",header:"Kuantitas",class:"text-left"},{field:"satuan",header:"Satuan",class:"text-left"},{field:"kategori_barang",header:"Kategori",class:"text-left"},{field:"hpp",header:"HPP",class:"text-right",type:"currency"}],Columns:[{field:"kode_barang",header:"Kode Produk",class:"text-left"},{field:"nama_barang",header:"Nama Produk",class:"text-left"},{field:"qty",header:"Qty",class:"text-left"},{field:"satuan",header:"Satuan",class:"text-left"},{field:"kategori_barang",header:"Kategori",class:"text-left"},{field:"hpp",header:"HPP",class:"text-right",type:"currency"}],nullItem:null,isEdit:!1}},created(){this.initFilters()},mounted(){this.$isLoading.value=!0,this.nullItem={...this.item},this.getData().finally(()=>{this.$timeoutLoading()})},computed:{filteredItems:function(){return this.lItem.filter(e=>(this.f.selectedSatuan==null?!0:this.f.selectedSatuan.id==e.id_satuan)&&(this.f.selectedkategori==null?!0:this.f.selectedkategori.id==e.id_kategori))}},methods:{async getData(){await Q.index().then(e=>{this.lProduk=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data produk",life:3e3})}),await y.index().then(e=>{this.lItem=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data produk",life:3e3})}),await J.index().then(e=>{this.lKategori=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data kategori produk",life:3e3})}),await Z.index().then(e=>{this.lSatuan=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data satuan",life:3e3})})},async Save(){try{this.FormError={},this.$isLoading.value=!0,X.parse(this.item),this.isEdit?await y.update(this.item.id,this.item).then(e=>{this.lItem=this.lItem.map(i=>(console.log(i.id,this.item.id),i.id==this.item.id?{...this.item}:i)),this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.item=this.nullItem,this.selectedProduk=null,this.formDialog=!1}):(this.item.id=void 0,await y.store(this.item).then(e=>{this.item.id=e.data.data.id,this.lItem.unshift(this.item),this.$toast.add({severity:"success",summary:"Successful",detail:"Product Created",life:3e3}),this.item=this.nullItem,this.selectedProduk=null}))}catch(e){e instanceof g.ZodError?this.FormError=e.format():e instanceof W&&this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}finally{this.formDialog=!1,this.$timeoutLoading()}},searchProduk(e){setTimeout(()=>{e.query.trim().length?this.filteredlProduk=this.lProduk.filter(i=>i.nama_barang.toLowerCase().includes(e.query.trim().toLowerCase())):this.filteredlProduk=[...this.lProduk]},250)},selectProduk(e){this.item.id_barang=e.value.id,this.item.kode_barang=e.value.kode_barang,this.item.nama_barang=e.value.nama_barang,this.item.satuan=e.value.satuan},FormNew(){this.FormError={},this.formDialog=!0,this.item=this.nullItem,this.isEdit=!1},FormEdit(e){this.FormError={},this.item={...e},this.selectedProduk=this.lProduk.find(i=>i.id==this.item.id_barang),this.formDialog=!0,this.isEdit=!0},confirmDeleteProduk(e){this.item={...e},this.deleteDialog=!0},async deleteStokAwal(){await y.delete(this.item.id).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem=this.lItem.filter(i=>i.id!==this.item.id)}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}),this.deleteDialog=!1,this.item=this.nullItem},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){this.deleteDialog=!0},initFilters(){this.filters={global:{value:null,matchMode:j.CONTAINS}}}}},c=e=>(O("data-v-833fad2c"),e=e(),Y(),e),ee={class:"grid crud-demo"},te={class:"col-12"},le={class:"card"},ie={class:"my-2"},oe=c(()=>s("h5",{class:"mbe-4"},"Filter Stok Awal",-1)),se={class:"p-fluid formgrid grid"},ae={class:"field col-2"},re=c(()=>s("label",{for:"status",class:"mb-1"},"Satuan",-1)),ne={key:0},de={class:"product-badge"},ue={class:"field col-2"},me=c(()=>s("label",{for:"status",class:"mb-1"},"Kategori",-1)),ce={key:0},pe={class:"product-badge"},fe=c(()=>s("div",{class:"flex flex-column w-full justify-content-center md:align-items-center"},[s("div",{class:"text-4xl px-6"},"Belum ada data.")],-1)),he={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ge=c(()=>s("h5",{class:"m-0"},"Stok Awal Barang",-1)),_e={class:"block mt-2 md:mt-0 p-input-icon-left"},be=c(()=>s("i",{class:"pi pi-search"},null,-1)),ke={key:0},ve={key:1},ye={class:"formgrid grid"},xe={class:"field col-12 md:col-3"},we={class:"field col-12 md:col-5"},Se={class:"flex flex-column"},Ce={class:""},Pe={class:"field col-12 md:col-3"},De={class:"field col-12 md:col-3"},Fe={class:"field col-12 md:col-6"},Ve={class:"flex align-items-center justify-content-center"},Ie=c(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ee={key:0},Le=c(()=>s("br",null,null,-1)),qe={class:"flex align-items-center justify-content-center"},Ae=c(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ne={key:0};function Te(e,i,Ue,Be,t,d){const L=r("Toast"),n=r("Button"),q=r("MyExport"),A=r("Toolbar"),P=r("Dropdown"),N=r("MultiSelect"),x=r("InputText"),w=r("Column"),T=r("DataTable"),_=r("Label"),b=r("ErrorMsg"),U=r("AutoComplete"),B=r("AutoCompleteGudang"),D=r("InputNumber"),S=r("Dialog"),F=z("select-all-text");return u(),p("div",ee,[s("div",te,[s("div",le,[o(L),o(A,{class:"mb-4"},{start:a(()=>[s("div",ie,[o(n,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:d.FormNew},null,8,["onClick"])]),o(n,{icon:"pi pi-filter",label:"Filter",class:f(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:i[0]||(i[0]=l=>this.filter=!this.filter)},null,8,["class"])]),end:a(()=>[o(q,{value:d.filteredItems,selectedColumns:t.selectedColumns,title:"Stok Awal"},null,8,["value","selectedColumns"])]),_:1}),s("div",{class:f(["card fadein",{hidden:!t.filter}])},[oe,s("div",se,[s("div",ae,[re,o(P,{id:"status",modelValue:t.f.selectedSatuan,"onUpdate:modelValue":i[1]||(i[1]=l=>t.f.selectedSatuan=l),options:t.lSatuan,optionLabel:"satuan",showClear:"",placeholder:"Semua"},{value:a(l=>[l.value?(u(),p("div",ne,[s("span",de,m(l.value.satuan),1)])):v("",!0)]),_:1},8,["modelValue","options"])]),s("div",ue,[me,o(P,{id:"status",modelValue:t.f.selectedkategori,"onUpdate:modelValue":i[2]||(i[2]=l=>t.f.selectedkategori=l),options:t.lKategori,optionLabel:"kategori_barang",showClear:"",placeholder:"Semua"},{value:a(l=>[l.value?(u(),p("div",ce,[s("span",pe,m(l.value.kategori_barang),1)])):v("",!0)]),_:1},8,["modelValue","options"])])])],2),o(T,{ref:"dt",value:d.filteredItems,selection:t.selectedProduk,"onUpdate:selection":i[5]||(i[5]=l=>t.selectedProduk=l),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll",tableStyle:"table-layout:auto"},{empty:a(()=>[fe]),header:a(()=>[s("div",he,[ge,o(N,{modelValue:t.selectedColumns,"onUpdate:modelValue":i[3]||(i[3]=l=>t.selectedColumns=l),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),s("span",_e,[be,o(x,{modelValue:t.filters.global.value,"onUpdate:modelValue":i[4]||(i[4]=l=>t.filters.global.value=l),placeholder:"Search..."},null,8,["modelValue"])])])]),default:a(()=>[o(w,{header:"#",headerStyle:"width:10px"},{body:a(l=>[h(m(l.index+1),1)]),_:1}),(u(!0),p(R,null,G(t.selectedColumns,(l,C)=>(u(),H(w,{field:l.field,header:l.header,class:f(l.class),key:l.field+"_"+C,sortable:!0},{body:a(({data:V,field:I})=>[l.type=="currency"?(u(),p("div",ke,m(e.$h.formatCurrency(V[I])),1)):(u(),p("div",ve,m(V[I]),1))]),_:2},1032,["field","header","class"]))),128)),o(w,{header:"Aksi",headerStyle:"width:14%; min-width:10rem;"},{body:a(l=>[o(n,{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning mr-2",onClick:C=>d.FormEdit(l.data)},null,8,["onClick"]),o(n,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:C=>d.confirmDeleteProduk(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),o(S,{visible:t.formDialog,"onUpdate:visible":i[13]||(i[13]=l=>t.formDialog=l),style:{width:"720px"},header:"Stok Awal Barang",modal:!0,class:"p-fluid"},{footer:a(()=>[o(n,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:i[12]||(i[12]=l=>t.formDialog=!1)}),o(n,{label:"Save",icon:"pi pi-save",class:"p-button-text",onClick:d.Save,loading:e.$isLoading.value,disabled:e.$isLoading.value},null,8,["onClick","loading","disabled"])]),default:a(()=>[s("div",ye,[s("div",xe,[o(_,{required:"",for:"kode_barang"},{default:a(()=>[h("Kode Barang")]),_:1}),o(x,{id:"kode_barang",modelValue:t.item.kode_barang,"onUpdate:modelValue":i[6]||(i[6]=l=>t.item.kode_barang=l),modelModifiers:{trim:!0},required:"true",class:f({"p-invalid":t.FormError.kode_barang}),disabled:""},null,8,["modelValue","class"]),o(b,{error:t.FormError.kode_barang},null,8,["error"])]),s("div",we,[o(_,{required:"",for:"nama_barang"},{default:a(()=>[h("Nama Barang")]),_:1}),o(U,{modelValue:t.selectedProduk,"onUpdate:modelValue":i[7]||(i[7]=l=>t.selectedProduk=l),suggestions:t.filteredlProduk,optionLabel:"nama_barang",virtualScrollerOptions:{itemSize:50},class:f([{"p-invalid":!!t.FormError.id_barang},"min-w-max"]),onComplete:d.searchProduk,onItemSelect:d.selectProduk,disabled:t.isEdit,dropdown:""},{option:a(l=>[s("div",Se,[s("small",{class:f(l.option.isstok?"text-green-500":"text-blue-500")},m(l.option.kode_barang),3),s("div",Ce,m(l.option.nama_barang),1)])]),_:1},8,["modelValue","suggestions","class","onComplete","onItemSelect","disabled"]),o(b,{error:t.FormError.id_barang},null,8,["error"])]),o(B,{"class-field":"md:col-4",modelValue:t.item.id_gudang,"onUpdate:modelValue":i[8]||(i[8]=l=>t.item.id_gudang=l)},null,8,["modelValue"]),s("div",Pe,[o(_,{required:"",for:"qty"},{default:a(()=>[h("Stok Awal ")]),_:1}),E(o(D,{id:"qty",modelValue:t.item.qty,"onUpdate:modelValue":i[9]||(i[9]=l=>t.item.qty=l),required:"true",min:0,class:f({"p-invalid":t.FormError.qty}),minFractionDigits:1,maxFractionDigits:5},null,8,["modelValue","class"]),[[F]]),o(b,{error:t.FormError.qty},null,8,["error"])]),s("div",De,[o(_,{required:"",for:"satuan"},{default:a(()=>[h("Satuan ")]),_:1}),o(x,{id:"satuan",modelValue:t.item.satuan,"onUpdate:modelValue":i[10]||(i[10]=l=>t.item.satuan=l),modelModifiers:{trim:!0},required:"true",class:f({"p-invalid":t.FormError.satuan}),disabled:""},null,8,["modelValue","class"]),o(b,{error:t.FormError.satuan},null,8,["error"])]),s("div",Fe,[o(_,{required:"",for:"hpp"},{default:a(()=>[h("Harga Pokok Penjualan")]),_:1}),E(o(D,{modelValue:t.item.hpp,"onUpdate:modelValue":i[11]||(i[11]=l=>t.item.hpp=l),id:"diskon",min:"0",minFractionDigits:1,maxFractionDigits:2,inputStyle:"text-align:right;",mode:"currency",locale:"id-ID",max:9999999999,currency:"IDR"},null,8,["modelValue"]),[[F]]),o(b,{error:t.FormError.hpp},null,8,["error"])])])]),_:1},8,["visible"]),o(S,{visible:t.deleteDialog,"onUpdate:visible":i[15]||(i[15]=l=>t.deleteDialog=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[o(n,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:i[14]||(i[14]=l=>t.deleteDialog=!1)}),o(n,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:d.deleteStokAwal},null,8,["onClick"])]),default:a(()=>[s("div",Ve,[Ie,t.item?(u(),p("span",Ee,[h("Are you sure you want to delete "),Le,s("b",null,"["+m(t.item.kode_barang)+"]",1),h(m(t.item.nama_barang)+"?",1)])):v("",!0)])]),_:1},8,["visible"]),o(S,{visible:e.deleteSelectedProdukDialog,"onUpdate:visible":i[17]||(i[17]=l=>e.deleteSelectedProdukDialog=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[o(n,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:i[16]||(i[16]=l=>t.deleteDialog=!1)}),o(n,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:e.deleteSaldoAwal},null,8,["onClick"])]),default:a(()=>[s("div",qe,[Ae,t.item?(u(),p("span",Ne,"Are you sure you want to delete the selected produks?")):v("",!0)])]),_:1},8,["visible"])])])])}const He=M($,[["render",Te],["__scopeId","data-v-833fad2c"]]);export{He as default};
