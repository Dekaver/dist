import{_ as N,X as k,F as U,r,o as u,c as f,d as s,e as o,b as a,l as d,t as g,m as B,q as O,n as v,f as R,k as j,p as z,g as H}from"./index-11eb6111.js";import"./custom-zod-e9521e5d.js";import{z as b}from"./index-0ec66d4d.js";const V=b.object({id_category:b.number({required_error:"Pilih Kategori Akun",invalid_type_error:"Pilih Kategori Akun"}).nonnegative(),parent:b.number({required_error:"Pilih Sub Klasifikasi",invalid_type_error:"Pilih Sub Klasifikasi"}).nonnegative(),name:b.string().nonempty(),is_transaction:b.boolean(),is_active:b.boolean(),code:b.string()}),J={data(){return{lItem:null,item:{id_category:null,parent:null,code:"",name:null,is_transaction:!1,is_active:!0,id:null,level:4,is_cash:!1},selectedakun:null,code:null,FormError:{},itemDialog:!1,deleteDialog:!1,lKlasifikasi:null,selectedKlasifikasi:null,filteredKlasifikasi:[],lSubKlasifikasi:null,selectedSubKlasifikasi:null,filteredSubKlasifikasi:[],selectedAtasan:null,filteredJabatan:[],filters:{},isSubmitted:!1,isEdit:!1,isError:!1,selectedColumns:[{header:"Kode Akun",field:"code",class:"w-20rem"},{header:"Nama Akun",field:"name",class:"w-20rem"},{header:"Subklasifikasi",field:"subklasifikasi",class:"w-20rem"},{header:"Aktif",field:"is_active",class:"w-20rem"}],Columns:[{header:"Kode Akun",field:"code",class:"w-20rem"},{header:"Nama Akun",field:"name",class:"w-20rem"},{header:"Subklasifikasi",field:"subklasifikasi",class:"w-20rem"},{header:"Aktif",field:"is_active",class:"w-20rem"}]}},created(){this.initFilters()},mounted(){this.getData()},methods:{selectAkun(i,t){this.code=i.value.code},getData(){k.indexOption("klasifikasi").then(i=>{this.lKlasifikasi=i.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data Jabatan Atasan",life:3e3})}),this.getAkun()},getAkun(){k.indexOption("master",this.code).then(i=>{this.lItem=i.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data item",life:3e3})})},FormNew(){this.item={id_category:null,parent:null,code:"",name:null,is_transaction:!1,is_active:!0,id:null,level:4,is_cash:!1},this.isSubmitted=!1,this.isLoading=!1,this.itemDialog=!0,this.selectedKlasifikasi=null,this.selectedSubKlasifikasi=null},HideDialog(){this.itemDialog=!1,this.selectedKlasifikasi=null,this.selectedSubKlasifikasi=null,this.isSubmitted=!1,this.isEdit=!1},Save(){this.isSubmitted=!0,this.isError||(this.isEdit?k.update(this.item.id,this.item).then(i=>{this.$toast.add({severity:"success",summary:"Successful",detail:i.data.message,life:3e3}),this.lItem[this.lItem.findIndex(t=>t.id==i.data.data.id)]=i.data.data,this.isEdit=!1,this.itemDialog=!1,this.getData(),this.item={}}).catch(i=>{this.$toast.add({severity:"error",summary:"Failed",detail:i.response.data.message,life:3e3})}).finally(()=>{this.isLoading=!1}):(k.store(this.item).then(i=>{this.$toast.add({severity:"success",summary:"Successful",detail:i.data.message,life:3e3}),this.getData(),this.item={id_category:null,parent:null,code:"",name:null,is_transaction:!1,is_active:!0,id:null,level:4,is_cash:!1},this.selectedKlasifikasi=null,this.selectedSubKlasifikasi=null}).catch(i=>{this.$toast.add({severity:"error",summary:"Failed",detail:i.response.data.message,life:3e3})}).finally(()=>{this.isLoading=!1}),this.itemDialog=!1),this.isSubmitted=!1)},FormEdit(i){this.isEdit=!0,this.item={...i},this.itemDialog=!0,this.item.id_category!=null&&(this.selectedKlasifikasi=this.lKlasifikasi.find(t=>t.id==this.item.id_category),k.indexOption("subklasifikasi",this.item.id_category).then(t=>{this.lSubKlasifikasi=t.data.data,this.item.parent!=null&&this.lSubKlasifikasi!=null&&(this.selectedSubKlasifikasi=this.lSubKlasifikasi.find(y=>y.id==this.item.parent))}))},confirmDelete(i){this.item=i,this.deleteDialog=!0},Destroy(i){this.deleteDialog=!1,k.destroy(i.id).then(t=>{this.lItem=this.lItem.filter(y=>y.id!==i.id),this.$toast.add({severity:"success",summary:"Successful",detail:t.data.message,life:3e3})}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})}),this.item={}},searchKlasifikasi(i){setTimeout(()=>{i.query.trim().length?this.filteredKlasifikasi=this.lKlasifikasi.filter(t=>t.name.toLowerCase().includes(i.query.toLowerCase())):this.filteredKlasifikasi=[...this.lKlasifikasi]},250)},selectKlasifikasi(i){i.value&&(this.item.id_category=i.value.id,this.selectedSubKlasifikasi=null,this.lSubKlasifikasi=null,k.indexOption("subklasifikasi",i.value.id).then(t=>{this.lSubKlasifikasi=t.data.data}))},searchSubKlasifikasi(i){this.lSubKlasifikasi!=null&&setTimeout(()=>{i.query.trim().length?this.filteredSubKlasifikasi=this.lSubKlasifikasi.filter(t=>t.name.toLowerCase().includes(i.query.toLowerCase())):this.filteredSubKlasifikasi=[...this.lSubKlasifikasi]},250)},selectSubKlasifikasi(i){i.value&&(this.item.parent=i.value.id,this.item.parent_level=i.value.level)},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:U.CONTAINS}}}},watch:{item:{handler(){try{this.isEdit?V.parse(this.item,{operation:"edit"}):V.parse(this.item,{operation:"create"}),this.FormError={},this.isError=!1}catch(i){this.isError=!0,console.log(i,"ini error"),this.FormError=i.format()}},deep:!0},code:{handler(){this.getAkun()},deep:!0}}},S=i=>(z("data-v-ed8fca7a"),i=i(),H(),i),G={class:"card"},W={class:"my-2"},X={class:"flex gap-2"},Y={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Q=S(()=>a("h5",{class:"m-0"},"Daftar Akun",-1)),Z={class:"flex justify-content-end gap-2 col-12 md:col-6"},$={class:"block p-input-icon-left"},ee=S(()=>a("i",{class:"pi pi-search"},null,-1)),ie=S(()=>a("div",{class:"text-center"},"Empty",-1)),te={key:0},se={key:1},le={key:2},ae={key:3},oe={key:4},re={class:"formgrid grid"},ne={class:"field col-12"},de={class:"field col-12"},ue={class:"field col-12"},ce={class:"field col-12"},me={class:"field col-4"},fe={class:"flex flex-row gap-2 align-items-center"},he={class:"field col-4"},pe={class:"flex flex-row gap-2 align-items-center"},_e={class:"field col-4"},ke={class:"flex flex-row gap-2 align-items-center"},be={class:"flex align-items-center justify-content-center"},ge=S(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ve={key:0};function ye(i,t,y,Se,e,n){const A=r("Toast"),h=r("Button"),F=r("MyExport"),I=r("Toolbar"),L=r("AutoCompleteAkun"),C=r("InputText"),K=r("Column"),T=r("Tag"),P=r("ActionButton"),q=r("DataTable"),p=r("Label"),D=r("AutoComplete"),_=r("ErrorMsg"),M=r("InputMask"),x=r("InputSwitch"),E=r("Dialog");return u(),f("div",G,[s(A),s(I,{class:"mb-4"},{start:o(()=>[a("div",W,[s(h,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:n.FormNew},null,8,["onClick"])])]),end:o(()=>[a("div",X,[s(h,{label:"Refresh",icon:"pi pi-sync",class:"p-button-info",onClick:t[0]||(t[0]=l=>n.getData())}),s(F,{value:e.lItem,selectedColumns:e.selectedColumns,title:"Export Akun"},null,8,["value","selectedColumns"])])]),_:1}),s(q,{ref:"dt",value:e.lItem,dataKey:"id",paginator:!0,rows:25,filters:e.filters,rowGroupMode:"rowspan",groupRowsBy:"item_atasan",sortMode:"single",sortField:"item",sortOrder:1,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Akun",responsiveLayout:"scroll"},{header:o(()=>[a("div",Y,[Q,a("div",Z,[s(L,{modelValue:e.code,"onUpdate:modelValue":t[1]||(t[1]=l=>e.code=l),showLabel:!1,onSelectItem:t[2]||(t[2]=l=>n.selectAkun(l,i.index)),onClearItem:i.clearItem,level:1},null,8,["modelValue","onClearItem"]),a("span",$,[ee,s(C,{modelValue:e.filters.global.value,"onUpdate:modelValue":t[3]||(t[3]=l=>e.filters.global.value=l),placeholder:"Search..."},null,8,["modelValue"])])])])]),empty:o(()=>[ie]),default:o(()=>[s(K,{header:"#",headerStyle:"width:10px"},{body:o(l=>[d(g(l.index+1),1)]),_:1}),(u(!0),f(B,null,O(e.selectedColumns,(l,w)=>(u(),j(K,{field:l.field,header:l.header,class:v(l.class),key:l.field+"_"+w,sortable:!0},{body:o(({data:c,field:m})=>[m=="icon"?(u(),f("div",te,[s(h,{icon:c[m],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):m=="is_active"?(u(),f("div",se,[s(T,{value:c[m]?"Aktif":"Tidak",severity:c[m]?"open":"close"},null,8,["value","severity"])])):l.type=="date"?(u(),f("div",le,g(i.$h.formatDate(c[m])),1)):l.parent=="pegawai"?(u(),f("div",ae,g(c.pegawai[m]),1)):(u(),f("div",oe,g(c[m]),1))]),_:2},1032,["field","header","class"]))),128)),s(K,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:o(({data:l,index:w})=>[s(P,{data:l,index:w,onEdit:c=>n.FormEdit(l),onDelete:c=>n.confirmDelete(l)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","filters"]),s(E,{visible:e.itemDialog,"onUpdate:visible":t[11]||(t[11]=l=>e.itemDialog=l),style:{width:"fit-content",maxWidth:"500px"},header:"Departemen Details",modal:!0,class:"p-fluid"},{footer:o(()=>[s(h,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:n.HideDialog},null,8,["onClick"]),s(h,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:n.Save},null,8,["onClick"])]),default:o(()=>[a("div",re,[a("div",ne,[s(p,{required:""},{default:o(()=>[d("Category")]),_:1}),s(D,{disabled:e.isEdit,modelValue:e.selectedKlasifikasi,"onUpdate:modelValue":t[4]||(t[4]=l=>e.selectedKlasifikasi=l),autofocus:"",dropdown:"",suggestions:e.filteredKlasifikasi,optionLabel:"name",onComplete:n.searchKlasifikasi,onItemSelect:n.selectKlasifikasi,forceSelection:""},null,8,["disabled","modelValue","suggestions","onComplete","onItemSelect"]),s(_,{error:e.FormError.id_category},null,8,["error"])]),a("div",de,[s(p,{required:""},{default:o(()=>[d("Sub Klasifikasi")]),_:1}),s(D,{disabled:e.isEdit||e.lSubKlasifikasi==null,modelValue:e.selectedSubKlasifikasi,"onUpdate:modelValue":t[5]||(t[5]=l=>e.selectedSubKlasifikasi=l),autofocus:"",dropdown:"",suggestions:e.filteredSubKlasifikasi,optionLabel:"name",onComplete:n.searchSubKlasifikasi,onItemSelect:n.selectSubKlasifikasi,forceSelection:""},null,8,["disabled","modelValue","suggestions","onComplete","onItemSelect"]),s(_,{error:e.FormError.parent},null,8,["error"])]),a("div",ue,[s(p,null,{default:o(()=>[d("Kode")]),_:1}),s(M,{disabled:"",mask:"9?9999-99-99999",id:"item",modelValue:e.item.code,"onUpdate:modelValue":t[6]||(t[6]=l=>e.item.code=l),modelModifiers:{trim:!0},required:"true",autofocus:""},null,8,["modelValue"]),s(_,{error:e.FormError.code},null,8,["error"])]),a("div",ce,[s(p,{required:""},{default:o(()=>[d("Nama")]),_:1}),s(C,{id:"item",modelValue:e.item.name,"onUpdate:modelValue":t[7]||(t[7]=l=>e.item.name=l),modelModifiers:{trim:!0},required:"true",autofocus:"",class:v({"p-invalid":e.isSubmitted&&!e.item.name})},null,8,["modelValue","class"]),s(_,{error:e.FormError.name},null,8,["error"])]),a("div",me,[a("div",fe,[s(p,null,{default:o(()=>[d("Transaksi")]),_:1}),s(x,{id:"item",modelValue:e.item.is_transaction,"onUpdate:modelValue":t[8]||(t[8]=l=>e.item.is_transaction=l),required:"true",autofocus:"",class:v({"p-invalid":e.isSubmitted&&!e.item.is_transaction}),boolean:!0},null,8,["modelValue","class"])]),s(_,{error:e.FormError.is_transaction},null,8,["error"])]),a("div",he,[a("div",pe,[s(p,null,{default:o(()=>[d("Cash")]),_:1}),s(x,{id:"item",modelValue:e.item.is_cash,"onUpdate:modelValue":t[9]||(t[9]=l=>e.item.is_cash=l),required:"true",autofocus:"",class:v({"p-invalid":e.isSubmitted&&!e.item.is_cash}),boolean:!0},null,8,["modelValue","class"])]),s(_,{error:e.FormError.is_cash},null,8,["error"])]),a("div",_e,[a("div",ke,[s(p,null,{default:o(()=>[d("Aktif")]),_:1}),s(x,{id:"item",modelValue:e.item.is_active,"onUpdate:modelValue":t[10]||(t[10]=l=>e.item.is_active=l),required:"true",autofocus:"",class:v({"p-invalid":e.isSubmitted&&!e.item.is_active}),boolean:!0},null,8,["modelValue","class"])]),s(_,{error:e.FormError.is_active},null,8,["error"])])])]),_:1},8,["visible"]),s(E,{visible:e.deleteDialog,"onUpdate:visible":t[14]||(t[14]=l=>e.deleteDialog=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:o(()=>[s(h,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[12]||(t[12]=l=>e.deleteDialog=!1)}),s(h,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:t[13]||(t[13]=l=>n.Destroy(e.item))})]),default:o(()=>[a("div",be,[ge,e.item?(u(),f("span",ve,[d("Are you sure you want to delete "),a("b",null,g(e.item.name),1),d("?")])):R("",!0)])]),_:1},8,["visible"])])}const Ce=N(J,[["render",ye],["__scopeId","data-v-ed8fca7a"]]);export{Ce as default};
