import{_ as F,F as S,r,o as d,c as m,b as s,d as n,e as u,n as p,k as y,l as K,t as f,m as R,q as T,C as M}from"./index-11eb6111.js";import{a as N}from"./index-fa5c02f8.js";import{a as v}from"./options-b2eb7ae6.js";const O={data(){return{items:[],selectedColumns:[{field:"kode_barang",header:"Kode Barang",class:"text-left"},{field:"nama_barang",header:"Nama Barang",class:"text-left"},{field:"qty",header:"Qty",class:"text-left",type:"currency"},{field:"satuan",header:"Satuan",class:"text-left"},{field:"total",header:"Total",class:"text-left",type:"currency"},{field:"rata_rata",header:"Harga Rata-Rata",class:"text-left",type:"currency"}],Columns:[{field:"kode_barang",header:"Kode Barang",class:"text-left"},{field:"nama_barang",header:"Nama Barang",class:"text-left"},{field:"kategori_barang",header:"Kategori Barang",class:"text-left"},{field:"qty",header:"Qty",class:"text-left",type:"currency"},{field:"satuan",header:"Satuan",class:"text-left"},{field:"total",header:"Total",class:"text-left",type:"currency"},{field:"rata_rata",header:"Harga Rata-Rata",class:"text-left",type:"currency"}],filter:!1,filters:{},periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],f:{awal:null,akhir:null,id_kategori:null,selectedStatus:{label:"All",value:""}},selectedPeriode:{label:"All",value:""},lKategoriBarang:[],selectedKategoriBarang:null}},created(){this.initFilters()},computed:{hitungTotal:function(){let e=0;return this.items&&this.items.forEach(a=>{e+=parseFloat(a.total)}),e}},mounted(){this.getData()},methods:{ubahKategoriBarang(e){e.value===null?this.f.id_kategori=null:this.f.id_kategori=this.selectedKategoriBarang.id,this.getReport()},ubahPeriode(){const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),c=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=a,this.f.akhir=c;break}case"Kemarin":{const o=new Date(new Date(a).setDate(a.getDate()-1));this.f.awal=o,this.f.akhir=o;break}case"Perminggu":{const o=new Date(new Date(a).setDate(a.getDate()-7));this.f.awal=o,this.f.akhir=c;break}case"Perbulan":{const o=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=o,this.f.akhir=c;break}case"Pertahun":{const o=new Date(e.getFullYear(),0,1);this.f.awal=o,this.f.akhir=c;break}case"MingguLalu":{const o=new Date(new Date(a).setDate(a.getDate()-a.getDay()-7)),t=new Date(new Date(o).setDate(o.getDate()+6));this.f.awal=o,this.f.akhir=t;break}case"BulanLalu":{const o=new Date(e.getFullYear(),e.getMonth()-1,1),t=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=o,this.f.akhir=t;break}case"TahunLalu":{const o=new Date(e.getFullYear()-1,0,1),t=new Date(e.getFullYear()-1,11,31);this.f.awal=o,this.f.akhir=t;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},getData(){this.loading=!0,v.getKontakSupplier().then(e=>{this.lSupplier=e.data.data,e.data.data.length==1&&(this.selectedSupplier=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),v.getKategoriProduk().then(e=>{this.lKategoriBarang=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Kategori Barang",life:3e3})}),this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},getReport(){N.getPembelianProduk(this.f).then(e=>{this.items=e.data.data,console.log(this.items,"itemmss")}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Report Pembelian",life:3e3})}).finally(()=>{this.loading=!1})},exportCSV(){this.$refs.dt.exportCSV()},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:S.CONTAINS}}}},components:{}},Y={class:"grid crud-demo"},A={class:"col-12"},E={class:"card"},I={class:"my-2"},U=s("h5",{class:"mbe-4"},"Filter Laporan Pembelian Produk",-1),q={class:"p-fluid formgrid grid"},H={class:"field col-2 d-flex justifiy-content-center align-items-end"},j=s("label",{for:"periode",class:"mb-1"},"Periode",-1),Q={class:"field col-2"},W={class:"p-float-label"},z=s("p",{class:"mb-1"},"Periode Awal",-1),G={class:"field col-2"},J={class:"p-float-label"},X=s("p",{class:"mb-1"},"Periode Akhir",-1),Z={class:"field col-2"},$={class:"p-float-label"},ee=s("p",{class:"mb-1"},"Kategori Barang",-1),te={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ae=s("h5",{class:"m-0"},"Laporan Pembelian Produk",-1),le={class:"flex gap-2 col-12 md:col-5"},se={class:"block p-input-icon-left w-full"},oe=s("i",{class:"pi pi-search"},null,-1),ne={key:0,class:"text-right"},re={key:1},ie={key:2},de={class:"text-right"};function ue(e,a,c,o,t,i){const P=r("Toast"),b=r("Button"),D=r("MyExport"),C=r("Toolbar"),_=r("Dropdown"),k=r("Calendar"),x=r("InputText"),L=r("MultiSelect"),w=r("Column"),B=r("DataTable");return d(),m("div",Y,[s("div",A,[s("div",E,[n(P),n(C,{class:"mb-4"},{start:u(()=>[s("div",I,[n(b,{icon:"pi pi-filter",label:"Filter",class:p(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:i.showHideFilter},null,8,["onClick","class"])])]),end:u(()=>[n(D,{value:t.items,selectedColumns:t.selectedColumns,title:"Export Excel"},null,8,["value","selectedColumns"]),n(b,{icon:"pi pi-external-link",label:"Export CSV",onClick:a[0]||(a[0]=l=>i.exportCSV(l))})]),_:1}),s("div",{class:p(["card",{hidden:!t.filter}])},[U,s("div",q,[s("div",H,[j,n(_,{id:"periode",modelValue:t.selectedPeriode,"onUpdate:modelValue":a[1]||(a[1]=l=>t.selectedPeriode=l),onChange:i.ubahPeriode,options:t.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),s("div",Q,[s("span",W,[z,n(k,{dateFormat:"dd-mm-yy",modelValue:t.f.awal,"onUpdate:modelValue":a[2]||(a[2]=l=>t.f.awal=l),onDateSelect:i.getReportCustom,inputId:"periodeawal"},null,8,["modelValue","onDateSelect"])])]),s("div",G,[s("span",J,[X,n(k,{dateFormat:"dd-mm-yy",modelValue:t.f.akhir,"onUpdate:modelValue":a[3]||(a[3]=l=>t.f.akhir=l),onDateSelect:i.getReportCustom,inputId:"periodeakhir"},null,8,["modelValue","onDateSelect"])])]),s("div",Z,[s("span",$,[ee,n(_,{id:"kategoribarang",modelValue:t.selectedKategoriBarang,"onUpdate:modelValue":a[4]||(a[4]=l=>t.selectedKategoriBarang=l),onChange:i.ubahKategoriBarang,options:t.lKategoriBarang,placeholder:"Kategori Barang",optionLabel:"kategori_barang",showClear:""},null,8,["modelValue","onChange","options"])])])])],2),n(B,{ref:"dt",value:t.items,selection:e.selectedItem,"onUpdate:selection":a[7]||(a[7]=l=>e.selectedItem=l),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Report Pembelian",responsiveLayout:"scroll"},{header:u(()=>[s("div",te,[ae,s("div",le,[s("span",se,[oe,n(x,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[5]||(a[5]=l=>t.filters.global.value=l),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),n(L,{modelValue:t.selectedColumns,"onUpdate:modelValue":a[6]||(a[6]=l=>t.selectedColumns=l),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),default:u(()=>[(d(),y(w,{field:"no",header:"No",sortable:!1,headerStyle:"width:4%; min-width:3rem;",key:"no"},{body:u(l=>[K(f(l.index+1),1)]),_:1})),(d(!0),m(R,null,T(t.selectedColumns,(l,V)=>(d(),y(w,{field:l.field,header:l.header,class:p(l.class),key:l.field+"_"+V,sortable:!0},M({body:u(({data:g,field:h})=>[l.type=="currency"&&h!="qty"?(d(),m("div",ne,f(e.$h.formatNumber(g[h])),1)):h=="qty"?(d(),m("div",re,f(e.$h.formatNumber(g[h])),1)):(d(),m("div",ie,f(g[h]),1))]),_:2},[l.field=="total"?{name:"footer",fn:u(()=>[s("div",de,f(e.$h.formatNumber(i.hitungTotal)),1)]),key:"0"}:void 0]),1032,["field","header","class"]))),128))]),_:1},8,["value","selection","filters"])])])])}const fe=F(O,[["render",ue]]);export{fe as default};
