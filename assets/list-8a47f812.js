import{_ as P,F as N,r as n,o as r,c as m,b as s,d as i,e as a,l as v,t as h,m as k,q as L,f,k as E,n as B,p as U,g as A}from"./index-11eb6111.js";import{a as T}from"./api-41fd374f.js";import{a as D}from"./options-b2eb7ae6.js";const Y={data(){return{lItem:[],item:{},filters:{},lTarget:null,selectedTarget:null,filteredTarget:{},itemDialog:!1,deleteitemDialog:!1,deletelTargetDialog:!1,isSubmitted:!1,selectedKantor:null,selectedColumns:[{header:"Kantor",field:"kantor",class:"w-20rem"},{header:"Tahun",field:"tahun",class:"w-20rem"},{header:"Pendapatan",field:"p13",class:"w-20rem",type:"currency"},{header:"Operasional",field:"o13",class:"w-20rem",type:"currency"}],Columns:[{header:"Kantor",field:"kantor",class:"w-20rem"},{header:"Tahun",field:"tahun",class:"w-20rem"},{header:"Pendapatan",field:"p13",class:"w-20rem",type:"currency"},{header:"Operasional",field:"o13",class:"w-20rem",type:"currency"}]}},created(){this.initFilters()},mounted(){this.getData()},methods:{FormEdit(e){this.$router.push(`/master/target/${e.id_kantor}/${e.tahun}`)},changeKantor(e){this.item.id_kantor=e.value.id},async getData(){await T.index().then(e=>{this.lItem=e.data.data}),D.getKantor().then(e=>{this.lKantor=e.data.data})},async FormNew(){this.item={},this.isSubmitted=!1,this.itemDialog=!0,this.selectedTarget=null,await this.getKantor()},getKantor(){D.getKantor().then(e=>{this.lKantor=e.data.data,this.lKantor.length==1&&(this.selectedKantor=this.lKantor[0],this.item.id_kantor=this.lKantor[0].id)})},HideDialog(){this.itemDialog=!1,this.isSubmitted=!1},async saveTarget(){this.isSubmitted=!0,this.item.tahun=this.$h.formatDate(this.item.tahun,"YYYY"),await T.store(this.item).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:"Target berhasil dibuat",life:3e3}),this.itemDialog=!1}).catch(e=>{this.$toast.add({severity:"error",summary:"Falied",detail:"Target sudah dibuat",life:3e3})}),this.itemDialog=!1,this.item={},await this.getData()},confirmDelete(e){this.item=e,this.deleteitemDialog=!0},deleteTarget(){this.deleteitemDialog=!1,T.delete(this.item.tahun,this.item.id_kantor).then(()=>{this.lItem=this.lItem.filter(e=>e.id!==this.item.id),this.$toast.add({severity:"success",summary:"Successful",detail:"Target Deleted",life:3e3})}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Target Gagal di hapus",life:3e3})}),this.item={},this.getData()},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){this.deletelItemDialog=!0},deleteSelectedTarget(){this.lItem=this.lItem.filter(e=>!this.selectedlItem.includes(e)),this.deletelItemDialog=!1,this.selectedlItem=null,this.$toast.add({severity:"success",summary:"Successful",detail:"lItem Deleted",life:3e3})},initFilters(){this.filters={global:{value:null,matchMode:N.CONTAINS}}},searchTarget(e){setTimeout(()=>{e.query.trim().length?this.filteredTarget=this.lTarget.filter(o=>o.nama.toLowerCase().includes(e.query.toLowerCase())):this.filteredTarget=[...this.lTarget]},250)},selectTarget(e){this.item.kantor=e.value.text,this.item.id_kantor=e.value.id}}},u=e=>(U("data-v-71dfe364"),e=e(),A(),e),M={class:"grid crud-demo"},O={class:"col-12"},R={class:"card"},j={class:"my-2"},q={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},z=u(()=>s("h5",{class:"m-0"},"Target",-1)),H={class:"block mt-2 md:mt-0 p-input-icon-left"},G=u(()=>s("i",{class:"pi pi-search"},null,-1)),J=u(()=>s("div",{class:"text-center"},"Empty",-1)),Q={key:0},W={key:1},X={key:2},Z={class:"formgrid grid"},$={key:0,class:"field col-6"},ee=u(()=>s("label",{for:"kantor",class:"mb-2"},"Kantor",-1)),te={class:"flex flex-column"},le={class:"field col-12 md:col-4"},se={class:"p-float-label"},ie=u(()=>s("p",{class:"mb-1"},"Tahun",-1)),oe={class:"flex align-items-center justify-content-center"},ae=u(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ne={key:0},re={class:"flex align-items-center justify-content-center"},de=u(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ce={key:0};function me(e,o,ue,he,l,d){const C=n("Toast"),c=n("Button"),x=n("MyExport"),w=n("Toolbar"),S=n("InputText"),_=n("Column"),K=n("ActionButton"),I=n("DataTable"),V=n("Dropdown"),F=n("Calendar"),y=n("Dialog");return r(),m(k,null,[s("div",M,[s("div",O,[s("div",R,[i(C),i(w,{class:"mb-4"},{start:a(()=>[s("div",j,[i(c,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:d.FormNew},null,8,["onClick"])])]),end:a(()=>[i(x,{value:l.lItem,selectedColumns:l.selectedColumns,title:"Export Target"},null,8,["value","selectedColumns"])]),_:1}),i(I,{ref:"dt",value:l.lItem,selection:l.selectedColumns,"onUpdate:selection":o[1]||(o[1]=t=>l.selectedColumns=t),dataKey:"id",paginator:!0,rows:10,filters:l.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Target",responsiveLayout:"scroll"},{header:a(()=>[s("div",q,[z,s("span",H,[G,i(S,{modelValue:l.filters.global.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.filters.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:a(()=>[J]),default:a(()=>[i(_,{header:"#",headerStyle:"width:10px"},{body:a(t=>[v(h(t.index+1),1)]),_:1}),(r(!0),m(k,null,L(l.selectedColumns,(t,b)=>(r(),E(_,{field:t.field,header:t.header,class:B(t.class),key:t.field+"_"+b,sortable:!0},{body:a(({data:p,field:g})=>[g=="icon"?(r(),m("div",Q,[i(c,{icon:p[g],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):f("",!0),t.type=="currency"?(r(),m("div",W,h(e.$h.formatNumber(p[g])),1)):(r(),m("div",X,h(p[g]),1))]),_:2},1032,["field","header","class"]))),128)),i(_,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:a(({data:t,index:b})=>[i(K,{data:t,index:b,onEdit:p=>d.FormEdit(t),onDelete:p=>d.confirmDelete(t)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","selection","filters"]),i(y,{visible:l.itemDialog,"onUpdate:visible":o[4]||(o[4]=t=>l.itemDialog=t),style:{width:"650px"},header:"Form Target",modal:!0,class:"p-fluid"},{footer:a(()=>[i(c,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:d.HideDialog},null,8,["onClick"]),i(c,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:d.saveTarget},null,8,["onClick"])]),default:a(()=>[s("div",Z,[this.lKantor.length>1?(r(),m("div",$,[ee,i(V,{id:"top",modelValue:l.selectedKantor,"onUpdate:modelValue":o[2]||(o[2]=t=>l.selectedKantor=t),options:e.lKantor,optionLabel:"nama",onChange:d.changeKantor},{option:a(t=>[s("div",te,[s("div",null,h(t.option.nama),1)])]),_:1},8,["modelValue","options","onChange"])])):f("",!0),s("div",le,[s("span",se,[ie,i(F,{modelValue:l.item.tahun,"onUpdate:modelValue":o[3]||(o[3]=t=>l.item.tahun=t),view:"year",dateFormat:"yy"},null,8,["modelValue"])])])])]),_:1},8,["visible"]),i(y,{visible:l.deleteitemDialog,"onUpdate:visible":o[6]||(o[6]=t=>l.deleteitemDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[i(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o[5]||(o[5]=t=>l.deleteitemDialog=!1)}),i(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:d.deleteTarget},null,8,["onClick"])]),default:a(()=>[s("div",oe,[ae,l.item?(r(),m("span",ne,[v("Are you sure you want to delete "),s("b",null,h(l.item.item),1),v("?")])):f("",!0)])]),_:1},8,["visible"]),i(y,{visible:l.deletelTargetDialog,"onUpdate:visible":o[8]||(o[8]=t=>l.deletelTargetDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[i(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o[7]||(o[7]=t=>l.deletelTargetDialog=!1)}),i(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:d.deleteSelectedTarget},null,8,["onClick"])]),default:a(()=>[s("div",re,[de,l.item?(r(),m("span",ce,"Are you sure you want to delete the selected lTarget?")):f("",!0)])]),_:1},8,["visible"])])])]),s("pre",null,h(this.item),1)],64)}const _e=P(Y,[["render",me],["__scopeId","data-v-71dfe364"]]);export{_e as default};
