import{_ as w,X as u,F as A,r as l,o as n,c as _,b as a,d as o,e as r,m as E,q as S,k as h,f as p,l as f,n as C,t as I,p as V,g as T}from"./index-11eb6111.js";import{z as m}from"./index-0ec66d4d.js";const N=m.object({id:m.number().optional(),name:m.string().nonempty(),code:m.string().optional(),parent:m.number()}),L={data(){return{expandedRowGroups:null,expandedKeys:{},columns:[{field:"name",header:"Name",expander:!0},{field:"code",header:"Code"}],lItem:[],item:{id:null,name:null,code:null,category:null,debit:null,kredit:null},lAccount:null,selectedAccount:null,filteredAccount:null,FormDialog:!1,deleteFormDialog:!1,filters:{},FormError:{},isSubmitted:!1,isEdit:!1}},mounted(){this.getData()},created(){this.initFilters()},computed:{totalDebit(){return this.lItem&&this.lItem.reduce((e,t)=>parseFloat(e)+parseFloat(t.debit),0)},totalKredit(){return this.lItem&&this.lItem.reduce((e,t)=>parseFloat(e)+parseFloat(t.kredit),0)}},methods:{onRowGroupExpand(e){this.$toast.add({severity:"info",summary:"Row Group Expanded",detail:"Value: "+e.data,life:3e3})},onRowGroupCollapse(e){this.$toast.add({severity:"success",summary:"Row Group Collapsed",detail:"Value: "+e.data,life:3e3})},async getData(){await u.index().then(e=>{this.lItem=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load Data Saldo Awal",life:3e3})}),await u.indexByCategory("1,2,3").then(e=>{this.lAccount=e.data.data,this.filteredAccount=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load Data Akun",life:3e3})})},Save(){this.isSubmitted=!0;let e=N.safeParse(this.item);if(e.success===!1){this.FormError=e.error.format();return}this.isEdit?u.update(this.item.id,this.item).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.HideDialog(),this.isEdit=!1}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})}):u.store(this.item).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.HideDialog()}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})}),this.isSubmitted=!1},Destroy(e){u.destroy(e.id).then(t=>{this.$toast.add({severity:"success",summary:"Success",detail:t.data.message,life:3e3}),this.getData(),this.deleteFormDialog=!1}).catch(t=>{this.$toast.add({severity:"error",summary:"Failed",detail:t.response.data.message,life:3e3})})},HideDialog(){this.FormDialog=!1,this.isSubmitted=!1,this.item={},this.selectedAccount=null,this.FormError={}},FormNew(e){this.item={grandparent:e?e.data.parent:null,parent_level:e?e.data.level:0,parent:e?e.data.id:null,id_category:e?e.data.id_category:null,code:""},this.FormError={},this.isSubmitted=!1,this.FormDialog=!0},FormEdit(e){this.FormError={},this.item={...e.data},this.selectedAccount=this.lAccount.find(t=>t.id===e.id),this.isEdit=!0,this.isSubmitted=!1,this.FormDialog=!0},FormDelete(e){this.item=e,this.deleteFormDialog=!0},searchAccount(e){setTimeout(()=>{e.query.trim().length?this.filteredAccount=this.lAccount.filter(t=>t.name.toLowerCase().includes(e.query.toLowerCase())||t.code.toLowerCase().includes(e.query.toLowerCase())):this.filteredAccount=[...this.lAccount]},250)},selectAccount(e){this.item.id=e.value.id,this.item.category=e.value.id_category,this.item.name=e.value.name,this.item.code=e.value.code},initFilters(){this.filters={global:{value:null,matchMode:A.CONTAINS}}}}},q=e=>(V("data-v-fab766ae"),e=e(),T(),e),B={class:"grid crud-demo"},M={class:"col-12"},G={class:"card"},R={class:"card-body"},H={class:"formgrid grid"},U={class:"field col-12"},j={class:"field col-12 d-flex justifiy-content-center align-items-end"},z={class:"flex align-items-center justify-content-center"},K=q(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),O={key:0};function X(e,t,Y,J,s,c){const g=l("Column"),d=l("Button"),k=l("TreeTable"),x=l("Toast"),y=l("Label"),b=l("InputText"),F=l("ErrorMsg"),v=l("Dialog");return n(),_("div",B,[a("div",M,[a("div",G,[a("div",R,[o(k,{value:s.lItem,indentation:"1"},{default:r(()=>[(n(!0),_(E,null,S(s.columns,i=>(n(),h(g,{key:i.field,field:i.field,header:i.header,expander:i.expander},null,8,["field","header","expander"]))),128)),o(g,{header:"Action",headerStyle:"width:14%; min-width:10rem;"},{body:r(i=>[i.node.data.parent<10?(n(),h(d,{key:0,icon:"pi pi-plus",class:"p-button-rounded p-button-success mr-2",onClick:D=>c.FormNew(i.node)},null,8,["onClick"])):p("",!0),i.node.data.id>9?(n(),h(d,{key:1,icon:"pi pi-pencil",class:"p-button-rounded p-button-warning mr-2",onClick:D=>c.FormEdit(i.node)},null,8,["onClick"])):p("",!0),i.node.data.id>9?(n(),h(d,{key:2,icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:D=>c.FormDelete(i.node.data)},null,8,["onClick"])):p("",!0)]),_:1})]),_:1},8,["value"])])]),o(x),o(v,{visible:s.FormDialog,"onUpdate:visible":t[2]||(t[2]=i=>s.FormDialog=i),style:{width:"400px"},header:"Form Klasifikasi Akun",modal:!0,class:"p-fluid"},{footer:r(()=>[o(d,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:c.HideDialog},null,8,["onClick"]),o(d,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:c.Save},null,8,["onClick"])]),default:r(()=>[a("div",H,[a("div",U,[o(y,{required:""},{default:r(()=>[f("Code")]),_:1}),o(b,{disabled:"",id:"code",modelValue:s.item.code,"onUpdate:modelValue":t[0]||(t[0]=i=>s.item.code=i),modelModifiers:{trim:!0},required:"true",class:C({"p-invalid":!!s.FormError.code})},null,8,["modelValue","class"]),o(F,{error:s.FormError.code},null,8,["error"])]),a("div",j,[o(y,{for:"name"},{default:r(()=>[f("Account ")]),_:1}),o(b,{id:"name",modelValue:s.item.name,"onUpdate:modelValue":t[1]||(t[1]=i=>s.item.name=i),modelModifiers:{trim:!0},required:"true",class:C({"p-invalid":!!s.FormError.name})},null,8,["modelValue","class"]),o(F,{error:s.FormError.name},null,8,["error"])])])]),_:1},8,["visible"]),o(v,{visible:s.deleteFormDialog,"onUpdate:visible":t[5]||(t[5]=i=>s.deleteFormDialog=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[o(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[3]||(t[3]=i=>s.deleteFormDialog=!1)}),o(d,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:t[4]||(t[4]=i=>c.Destroy(s.item))})]),default:r(()=>[a("div",z,[K,s.item?(n(),_("span",O,[f("Are you sure you want to delete "),a("b",null,I(s.item.name),1),f("?")])):p("",!0)])]),_:1},8,["visible"])])])}const Z=w(L,[["render",X],["__scopeId","data-v-fab766ae"]]);export{Z as default};
