import{_ as E,s as k,F as R,r as i,o as u,c as h,b as s,d as o,e as r,n as v,k as C,f as x,l as _,t as f,m as q,q as M,p as K,g as z}from"./index-11eb6111.js";import{a as y}from"./api-917068af.js";import{a as H}from"./options-b2eb7ae6.js";const Q={data(){return{lSalesman:[],filteredSalesman:[],selectedSalesman:null,lDibuat:[],filteredDibuat:[],selectedDibuat:null,id_salesman:null,created_by:null,selectedDeliveryOrder:null,delivery_order:null,lDeliveryOrder:[],selectedItem:null,f:{selectedStatus:{label:"All",value:"A"},id_customer:null,awal:null,akhir:null},selectedStatus:{label:"All",value:"A"},statuses:[{label:"All",value:"A"},{label:"Draft",value:"D"},{label:"Open",value:"O"},{label:"Close",value:"C"}],selectedColumns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"nomor",header:"Nomor",class:"text-left"},{field:"no_so",header:"No. Pesanan",class:"text-left"},{field:"customer",header:"Pelanggan",class:"text-left"},{field:"kepada",header:"Kepada",class:"text-left"},{field:"created_name",header:"Dibuat Oleh",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],Columns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"nomor",header:"Nomor",class:"text-left"},{field:"gudang",header:"Gudang",class:"text-left"},{field:"no_so",header:"No. Pesanan",class:"text-left"},{field:"customer",header:"Pelanggan",class:"text-left"},{field:"telepon",header:"Telepon",class:"text-left"},{field:"kepada",header:"Kepada",class:"text-left"},{field:"driver",header:"Driver",class:"text-left"},{field:"driver_no",header:"No Driver",class:"text-left"},{field:"created_name",header:"Dibuat Oleh",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],lPersetujuan:[],filter:!1,deleteDialog:!1,filters:{}}},productService:null,created(){this.initFilters()},computed:{filteredItems:function(){return this.lDeliveryOrder.filter(e=>(this.f.selectedStatus.value=="A"?!0:this.f.selectedStatus.value==e.status)&&(this.f.id_customer?this.f.id_customer.id==e.id_customer:!0)&&(this.f.awal?this.f.awal.toLocaleDateString()<=new Date(e.tanggal).toLocaleDateString():!0)&&(this.f.akhir==null?!0:this.f.akhir.toLocaleDateString()>=new Date(e.tanggal).toLocaleDateString())&&(this.id_salesman==null?!0:this.id_salesman==e.id_salesman)&&(this.created_by==null?!0:this.created_by==e.created_by))}},mounted(){this.getData(),this.getDataPersetujuan(),k.on("update-persetujuan-delivery-order",()=>{this.getDataPersetujuan()})},beforeUnmount(){k.off("update-persetujuan-delivery-order")},methods:{getSalesman(){if(!this.isEdit&&this.$auth.id!=null&&this.$auth.id!=0){if(this.selectedSalesman=this.lSalesman.find(e=>e.id==this.$auth.id),this.selectedSalesman==null)return;this.item.id_salesman=this.selectedSalesman.id,this.item.salesman=this.selectedSalesman.name}},searchSalesman(e){setTimeout(()=>{this.filteredSalesman=e.query.trim().length?this.lSalesman.filter(a=>a.nama.toLowerCase().includes(e.query.toLowerCase())):[...this.lSalesman]},250)},searchDibuat(e){setTimeout(()=>{this.filteredDibuat=e.query.trim().length?this.lDibuat.filter(a=>a.nama.toLowerCase().includes(e.query.toLowerCase())):[...this.lDibuat]},250)},selectSalesman(e){this.id_salesman=e.value.id},unselectSalesman(){this.id_salesman=null},selectDibuat(e){this.created_by=e.value.id},unselectDibuat(){this.created_by=null},async getData(){await H.getPegawai().then(e=>{this.lSalesman=e.data.data,this.lDibuat=e.data.data}).catch(()=>{}),await y.index().then(e=>{this.lDeliveryOrder=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Pengiriman Barang",life:3e3})})},async getDataPersetujuan(){await y.getPersetujuan().then(e=>{this.lPersetujuan=e.data.data}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})})},confirmDelete(e){this.delivery_order=e,this.deleteDialog=!0},async submitDelete(){await y.destroy(this.delivery_order.id).then(()=>{this.deleteDialog=!1,this.$toast.add({severity:"success",summary:"Successful",detail:"Quotation Deleted",life:3e3}),this.lDeliveryOrder=this.lDeliveryOrder.filter(e=>e.id!=this.delivery_order.id)}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Delete Quotation",life:3e3})})},onRowDblclick(e){this.$router.push(`/delivery/order/${e.data.id}/edit`)},FormEdit(e){this.$router.push(`/delivery/order/${e.id}/edit`)},Cetak(e){this.$router.push(`/delivery/order/${e.id}/cetak`)},showHideFilter(){this.filter=!this.filter},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:R.CONTAINS}}}}},c=e=>(K("data-v-24618d7a"),e=e(),z(),e),G={class:"grid crud-demo"},Y={class:"col-12"},J={class:"card"},W={class:"my-2"},X=c(()=>s("h5",{class:"mbe-4"},"Pencarian Pengiriman Barang",-1)),Z={class:"p-fluid formgrid grid"},$={class:"field col-2"},ee={class:"p-float-label"},te=c(()=>s("p",{class:"mb-1"},"Periode Awal",-1)),le={class:"field col-2"},se={class:"p-float-label"},ae=c(()=>s("p",{class:"mb-1"},"Periode Akhir",-1)),oe={class:"field col-2"},ie={class:"p-float-label"},ne=c(()=>s("p",{class:"mb-1"},"Salesman",-1)),re={class:"field col-2"},de={class:"field col-2"},ue={class:"p-float-label"},ce=c(()=>s("p",{class:"mb-1"},"Dibuat Oleh",-1)),me={class:"field col-2 d-flex justifiy-content-center align-items-end mb-0"},he=c(()=>s("label",{for:"salesquotation",class:"mb-1"},"Status",-1)),pe={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},fe=c(()=>s("h5",{class:"m-0"},"Pengiriman Barang",-1)),_e={class:"flex gap-2 col-12 md:col-5 py-1"},ge={class:"block p-input-icon-left w-full"},be=c(()=>s("i",{class:"pi pi-search"},null,-1)),ve=c(()=>s("div",{class:"text-center"},"Empty",-1)),ye={key:0},De={key:1},Se={key:2},we={key:3,class:"text-right"},ke={key:4},Ce={class:"flex align-items-center justify-content-center"},xe=c(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Pe={key:0};function Ve(e,a,Le,Te,t,n){const P=i("Toast"),p=i("Button"),D=i("router-link"),V=i("MyExport"),L=i("Toolbar"),S=i("Calendar"),w=i("AutoComplete"),T=i("Label"),I=i("AutoCompleteKontak"),A=i("Dropdown"),F=i("InputText"),j=i("MultiSelect"),g=i("Column"),O=i("Tag"),N=i("ActionButton"),B=i("DataTable"),U=i("Dialog");return u(),h("div",G,[s("div",Y,[s("div",J,[o(P),o(L,{class:"mb-4"},{start:r(()=>[s("div",W,[o(D,{to:"/delivery/order/create",class:"btn btn-added me-2"},{default:r(()=>[o(p,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2"})]),_:1}),o(p,{icon:"pi pi-filter",label:"Filter",class:v(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:n.showHideFilter},null,8,["onClick","class"]),t.lPersetujuan.length>0?(u(),C(D,{key:0,to:"/delivery/order/persetujuan",class:"btn btn-added me-2"},{default:r(()=>[o(p,{icon:"pi pi-shield",class:"p-button mx-2 p-button-outlined",label:"Persetujuan",badge:t.lPersetujuan.length,severity:"warning",badgeSeverity:"warning"},null,8,["badge"])]),_:1})):x("",!0)])]),end:r(()=>[o(V,{value:n.filteredItems,selectedColumns:t.selectedColumns,title:"Export Pengiriman Barang"},null,8,["value","selectedColumns"])]),_:1}),s("div",{class:v(["card fadein",{hidden:!t.filter}])},[X,s("div",Z,[s("div",$,[s("span",ee,[te,o(S,{dateFormat:"dd-mm-yy",modelValue:t.f.awal,"onUpdate:modelValue":a[0]||(a[0]=l=>t.f.awal=l),inputId:"periodeawal"},null,8,["modelValue"])])]),s("div",le,[s("span",se,[ae,o(S,{dateFormat:"dd-mm-yy",modelValue:t.f.akhir,"onUpdate:modelValue":a[1]||(a[1]=l=>t.f.akhir=l),inputId:"periodeakhir"},null,8,["modelValue"])])]),s("div",oe,[s("span",ie,[ne,o(w,{modelValue:t.selectedSalesman,"onUpdate:modelValue":a[2]||(a[2]=l=>t.selectedSalesman=l),optionLabel:"nama",suggestions:t.filteredSalesman,onComplete:n.searchSalesman,onClear:n.unselectSalesman,onItemSelect:n.selectSalesman,dropdown:"",forceSelection:""},null,8,["modelValue","suggestions","onComplete","onClear","onItemSelect"])])]),s("div",re,[o(T,null,{default:r(()=>[_("Pelanggan")]),_:1}),o(I,{modelValue:t.f.id_customer,"onUpdate:modelValue":a[3]||(a[3]=l=>t.f.id_customer=l),label:"kontak","is-customer":""},null,8,["modelValue"])]),s("div",de,[s("span",ue,[ce,o(w,{clear:"",modelValue:t.selectedDibuat,"onUpdate:modelValue":a[4]||(a[4]=l=>t.selectedDibuat=l),optionLabel:"nama",suggestions:t.filteredDibuat,onComplete:n.searchDibuat,onItemSelect:n.selectDibuat,onClear:n.unselectDibuat,dropdown:"",forceSelection:""},null,8,["modelValue","suggestions","onComplete","onItemSelect","onClear"])])]),s("div",me,[he,o(A,{id:"salesquotation",modelValue:t.f.selectedStatus,"onUpdate:modelValue":a[5]||(a[5]=l=>t.f.selectedStatus=l),options:t.statuses,optionLabel:"label",placeholder:"Status"},null,8,["modelValue","options"])])])],2),o(B,{ref:"dt",value:n.filteredItems,selection:t.selectedItem,"onUpdate:selection":a[8]||(a[8]=l=>t.selectedItem=l),"selection-mode":"single",onRowDblclick:n.onRowDblclick,paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Pengiriman Barang",responsiveLayout:"scroll"},{header:r(()=>[s("div",pe,[fe,s("div",_e,[s("span",ge,[be,o(F,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[6]||(a[6]=l=>t.filters.global.value=l),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),o(j,{modelValue:t.selectedColumns,"onUpdate:modelValue":a[7]||(a[7]=l=>t.selectedColumns=l),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),empty:r(()=>[ve]),default:r(()=>[o(g,{header:"#",headerStyle:"width:10px"},{body:r(l=>[_(f(l.index+1),1)]),_:1}),(u(!0),h(q,null,M(t.selectedColumns,(l,b)=>(u(),C(g,{field:l.field,header:l.header,class:v(l.class),key:l.field+"_"+b,sortable:!0},{body:r(({data:m,field:d})=>[d=="icon"?(u(),h("div",ye,[o(p,{icon:m[d],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):d=="status"?(u(),h("div",De,[o(O,{value:e.$h.getLabel(m[d]),severity:e.$h.getLabel(m[d])},null,8,["value","severity"])])):d=="tanggal"?(u(),h("div",Se,f(e.$h.formatDate(m[d])),1)):d=="grandtotal"?(u(),h("div",we,f(e.$h.formatNumber(m[d])),1)):(u(),h("div",ke,f(m[d]),1))]),_:2},1032,["field","header","class"]))),128)),o(g,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:r(({data:l,index:b})=>[o(N,{data:l,index:b,onEdit:m=>n.FormEdit(l),onDelete:m=>n.confirmDelete(l),onPrint:n.Cetak,showDelete:l.status!="C",showPrint:l.status!="D"},null,8,["data","index","onEdit","onDelete","onPrint","showDelete","showPrint"])]),_:1})]),_:1},8,["value","selection","onRowDblclick","filters"])]),o(U,{visible:t.deleteDialog,"onUpdate:visible":a[10]||(a[10]=l=>t.deleteDialog=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[o(p,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:a[9]||(a[9]=l=>t.deleteDialog=!1)}),o(p,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:n.submitDelete},null,8,["onClick"])]),default:r(()=>[s("div",Ce,[xe,t.delivery_order?(u(),h("span",Pe,[_("Are you sure you want to delete "),s("b",null,f(t.delivery_order.nomor),1),_("?")])):x("",!0)])]),_:1},8,["visible"])])])}const je=E(Q,[["render",Ve],["__scopeId","data-v-24618d7a"]]);export{je as default};
