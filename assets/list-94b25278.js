import{_ as I,U as B,F as A,r as i,o as d,c as r,b as l,d as o,e as n,n as f,t as p,l as h,m as N,q as O,f as y,k as j}from"./index-11eb6111.js";import{a as k}from"./api-ff803cba.js";import{a as M}from"./kategoriproduk-68d52205.js";const E={data(){return{items:[],item:{tanggal:null,id_kategori:null,id_gudang:null,keterangan:null},f:{awal:null,akhir:null,selectedStatus:null},itemDialog:!1,lKategoriProduk:[],selectedKategoriProduk:null,tanggal:null,filters:{},selectedItem:null,statuses:[{label:"Semua",value:""},{label:"Draft",value:"D"},{label:"Upload",value:"U"},{label:"Approve",value:"A"},{label:"Cancel",value:"X"}],selectedColumns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"created_at",header:"Tgl.Dibuat",class:"text-left",type:"date"},{field:"uploaded_at",header:"Tgl.Diupload",class:"text-left",type:"date"},{field:"approved_at",header:"Tgl.Disetujui",class:"text-left",type:"date"},{field:"status",header:"Status",class:"text-left"}],Columns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"created_at",header:"Tgl.Dibuat",class:"text-left",type:"date"},{field:"uploaded_at",header:"Tgl.Diupload",class:"text-left",type:"date"},{field:"approved_at",header:"Tgl.Disetujui",class:"text-left",type:"date"},{field:"status",header:"Status",class:"text-left"}],deleteDialog:!1,filter:!1,loading:!1}},created(){this.initFilters()},setup(){return{loadingState:B()}},mounted(){this.loadingState.startLoading(),this.getData().finally(()=>{setTimeout(()=>{this.loadingState.stopLoading()},5e3)})},computed:{filteredItems:function(){return this.items.filter(s=>(this.f.selectedStatus.value==""?!0:this.f.selectedStatus.value==s.status)&&(this.f.awal==null?!0:this.$h.formatDateYmd(this.f.awal)<=this.$h.formatDateYmd(s.tanggal))&&(this.f.akhir==null?!0:this.$h.formatDateYmd(this.f.akhir)>=this.$h.formatDateYmd(s.tanggal)))}},methods:{async getData(){this.loading=!0,await k.index().then(s=>{this.items=s.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Stok Opname",life:3e3})}).finally(()=>{this.loading=!1}),await M.index().then(s=>{this.lKategoriProduk=s.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Kategori Barang",life:3e3})}).finally(()=>{this.loading=!1})},confirmDelete(s){this.item=s,this.deleteDialog=!0},async selectDate(s){this.item.tanggal=new Date(s)},async submitCreate(){let s=!0;await k.store(this.item).then(a=>{this.item.id=a.data.data.id,this.item.nomor=a.data.data.nomor}).catch(()=>{s=!1,this.$toast.add({severity:"error",summary:"Failed",detail:"Create Stok Opname",life:3e3})}).finally(()=>{s&&(this.$toast.add({severity:"success",summary:"Successful",detail:"Created Stok Opname",life:3e3}),setTimeout(()=>{this.getData(),this.itemDialog=!1},1e3))})},FormEdit(s){this.$router.push({name:"stok-opname.edit",params:{id:s.id}})},async Destroy(s){await k.delete(s.id).then(a=>{this.$toast.add({severity:"success",summary:"Successful",detail:"Delete Stok Opname",life:3e3}),this.getData(),this.deleteDialog=!1}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Cetak Stok Opname",life:3e3})})},onChangeKategoriProduk(s){this.item.id_kategori=s.value.id},async openNew(){this.item={},this.selectedKategoriProduk=null,this.item.tanggal=new Date,this.tanggal=new Date,this.submitted=!1,this.itemDialog=!0},hideDialog(){this.itemDialog=!1,this.submitted=!1},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:A.CONTAINS}}}}},q={class:"grid crud-demo"},R={class:"col-12"},Y={class:"card"},z={class:"my-2"},G=l("h5",{class:"mbe-4"},"Pencarian Stok Opname",-1),H={class:"p-fluid formgrid grid"},X={class:"field col-2"},J={class:"p-float-label"},Q=l("p",{class:"mb-1"},"Tanggal Awal",-1),W={class:"field col-2"},Z={class:"p-float-label"},$=l("p",{class:"mb-1"},"Tanggal Akhir",-1),ee={class:"field col-2 d-flex justifiy-content-center align-items-end"},te=l("label",{for:"status",class:"mb-1"},"Status",-1),le={key:0},ae={key:1},se={key:2},oe={class:"field col-auto",style:{display:"flex","align-items":"flex-end","align-content":"flex-end"}},ie={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ne=l("h5",{class:"m-0"},"Stok Opname",-1),de={class:"block mt-2 md:mt-0 p-input-icon-left"},re=l("i",{class:"pi pi-search"},null,-1),ue={key:0},ce={key:1},me={class:"w-full flex justify-content-center"},ge={key:2},fe={key:3},pe=l("div",{class:"flex flex-column w-full justify-content-center md:align-items-center"},[l("div",{class:"text-4xl px-6"},"Belum ada data.")],-1),he={class:"formgrid grid"},_e={class:"field col-12"},ve={key:0,class:"p-invalid"},be={class:"field col-12 d-flex justifiy-content-center align-items-end"},ye=l("label",{for:"keterangan"},"Keterangan",-1),ke={key:0,class:"p-invalid"},De={class:"field col-12 d-flex justifiy-content-center align-items-end"},we=l("label",{for:"kategori",class:"mb-1"},"Kategori",-1),xe={class:"flex align-items-center justify-content-center"},Ce=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Se={key:0};function Ve(s,a,Te,Le,t,u){const C=i("Toast"),c=i("Button"),S=i("MyExport"),V=i("Toolbar"),_=i("Calendar"),D=i("Dropdown"),T=i("MultiSelect"),w=i("InputText"),v=i("Column"),L=i("Tag"),F=i("ActionButton"),K=i("DataTable"),U=i("Label"),P=i("AutoCompleteGudang"),x=i("Dialog");return d(),r("div",q,[l("div",R,[l("div",Y,[o(C),o(V,{class:"mb-4"},{start:n(()=>[l("div",z,[o(c,{icon:"pi pi-plus",label:"Tambah",class:"p-button p-button-success mx-2",onClick:u.openNew},null,8,["onClick"]),o(c,{icon:"pi pi-filter",label:"Filter",class:f(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:u.showHideFilter},null,8,["onClick","class"])])]),end:n(()=>[o(S,{value:t.items,selectedColumns:t.selectedColumns,title:"Stok Opname"},null,8,["value","selectedColumns"])]),_:1}),l("div",{class:f(["card",{hidden:!t.filter}])},[G,l("div",H,[l("div",X,[l("span",J,[Q,o(_,{showIcon:"",dateFormat:"dd-mm-yy",modelValue:t.f.awal,"onUpdate:modelValue":a[0]||(a[0]=e=>t.f.awal=e),inputId:"periodeawal"},null,8,["modelValue"])])]),l("div",W,[l("span",Z,[$,o(_,{showIcon:"",dateFormat:"dd-mm-yy",modelValue:t.f.akhir,"onUpdate:modelValue":a[1]||(a[1]=e=>t.f.akhir=e),inputId:"periodeakhir"},null,8,["modelValue"])])]),l("div",ee,[te,o(D,{id:"status",modelValue:t.f.selectedStatus,"onUpdate:modelValue":a[2]||(a[2]=e=>t.f.selectedStatus=e),options:t.statuses,optionLabel:"label",placeholder:"Status"},{value:n(e=>[e.value&&e.value.value?(d(),r("div",le,[l("span",{class:f("product-badge status-"+e.value.value)},p(e.value.label),3)])):e.value&&!e.value.value?(d(),r("div",ae,[l("span",{class:f("product-badge status-"+e.value.toLowerCase())},p(e.value),3)])):(d(),r("span",se,p(e.placeholder),1))]),_:1},8,["modelValue","options"])]),l("div",oe,[o(c,{label:"Search"})])])],2),o(K,{ref:"dt",value:t.items,selection:t.selectedItem,"onUpdate:selection":a[5]||(a[5]=e=>t.selectedItem=e),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{header:n(()=>[l("div",ie,[ne,o(T,{modelValue:t.selectedColumns,"onUpdate:modelValue":a[3]||(a[3]=e=>t.selectedColumns=e),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),l("span",de,[re,o(w,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[4]||(a[4]=e=>t.filters.global.value=e),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:n(()=>[pe]),default:n(()=>[o(v,{field:"nomor",header:"Nomor",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:n(e=>[h(p(e.data.nomor),1)]),_:1}),(d(!0),r(N,null,O(t.selectedColumns,(e,b)=>(d(),j(v,{field:e.field,header:e.header,class:f(e.class),key:e.field+"_"+b,sortable:!0},{body:n(({data:m,field:g})=>[g=="icon"?(d(),r("div",ue,[o(c,{icon:m[g],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):g=="status"?(d(),r("div",ce,[l("div",me,[o(L,{style:{float:"right"},value:s.$h.getLabel(m[g]),severity:s.$h.getLabel(m[g])},null,8,["value","severity"])])])):e.type=="date"?(d(),r("div",ge,p(s.$h.formatDate(m[g])),1)):(d(),r("div",fe,p(m[g]),1))]),_:2},1032,["field","header","class"]))),128)),o(v,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;",class:"text-right"},{body:n(({data:e,index:b})=>[o(F,{data:e,index:b,onEdit:m=>u.FormEdit(e),onDelete:m=>u.confirmDelete(e),showDelete:e.status=="D"||e.status=="U"},null,8,["data","index","onEdit","onDelete","showDelete"])]),_:1})]),_:1},8,["value","selection","filters"]),o(x,{visible:t.itemDialog,"onUpdate:visible":a[10]||(a[10]=e=>t.itemDialog=e),style:{width:"450px"},header:"Tambah Stok Opname",modal:!0,class:"p-fluid"},{footer:n(()=>[o(c,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:u.hideDialog},null,8,["onClick"]),o(c,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:u.submitCreate},null,8,["onClick"])]),default:n(()=>[l("div",he,[l("div",_e,[o(U,{requiredfor:"tanggal"},{default:n(()=>[h("Tanggal")]),_:1}),o(_,{showIcon:"",dateFormat:"dd-mm-yy",modelValue:t.tanggal,"onUpdate:modelValue":a[6]||(a[6]=e=>t.tanggal=e),inputId:"tanggal",onDateSelect:u.selectDate,class:f({"p-invalid":s.submitted&&!t.item.tanggal}),showButtonBar:""},null,8,["modelValue","onDateSelect","class"]),s.submitted&&!t.item.tanggal?(d(),r("small",ve,"Required")):y("",!0)]),l("div",be,[ye,o(w,{id:"keterangan",modelValue:t.item.keterangan,"onUpdate:modelValue":a[7]||(a[7]=e=>t.item.keterangan=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:f({"p-invalid":s.submitted&&!t.item.keterangan})},null,8,["modelValue","class"]),s.submitted&&!t.item.keterangan?(d(),r("small",ke,"required")):y("",!0)]),o(P,{modelValue:t.item.id_gudang,"onUpdate:modelValue":a[8]||(a[8]=e=>t.item.id_gudang=e)},null,8,["modelValue"]),l("div",De,[we,o(D,{id:"kategori",modelValue:t.selectedKategoriProduk,"onUpdate:modelValue":a[9]||(a[9]=e=>t.selectedKategoriProduk=e),options:t.lKategoriProduk,onChange:u.onChangeKategoriProduk,optionLabel:"kategori_barang",placeholder:"Kategori"},null,8,["modelValue","options","onChange"])])])]),_:1},8,["visible"]),o(x,{visible:t.deleteDialog,"onUpdate:visible":a[13]||(a[13]=e=>t.deleteDialog=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[o(c,{autofocus:"",label:"No",icon:"pi pi-times",class:"p-button-text",onClick:a[11]||(a[11]=e=>t.deleteDialog=!1)}),o(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:a[12]||(a[12]=e=>u.Destroy(t.item))})]),default:n(()=>[l("div",xe,[Ce,t.item?(d(),r("span",Se,[h("Are you sure you want to delete "),l("b",null,p(t.item.nomor),1),h("?")])):y("",!0)])]),_:1},8,["visible"])])])])}const Pe=I(E,[["render",Ve]]);export{Pe as default};
