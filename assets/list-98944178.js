import{_ as R,$ as T,F as B,r as n,o as c,c as h,b as s,d as o,e as u,n as b,k as v,l as S,t as p,m as M,q as K}from"./index-11eb6111.js";import{a as N}from"./options-b2eb7ae6.js";import{a as O}from"./kategoriproduk-68d52205.js";import{a as U}from"./index-fa5c02f8.js";import{a as m}from"./xlsx.min-b21a3818.js";const Y={data(){return{items:[],statuses:[{label:"All",value:""},{label:"Lunas",value:"Lunas"},{label:"Belum Lunas",value:"Belum Lunas"},{label:"Belum Bayar",value:"Belum Bayar"}],periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],periode:{awal:null,akhir:null},f:{awal:null,akhir:null},selectedPeriode:{label:"All",value:""},selectedColumns:[{field:"ap_number",header:"Nomor",class:"text-left"},{field:"supplier",header:"Supplier",class:"text-left"},{field:"invoice_number",header:"Referensi",class:"text-left"},{field:"amount",header:"Total",class:"text-left",type:"currency"},{field:"pay",header:"Bayar",class:"text-left",type:"currency"},{field:"sisa_tagihan",header:"Sisa Tagihan",class:"text-left",type:"currency"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],Columns:[{field:"ap_number",header:"Nomor",class:"text-left"},{field:"supplier",header:"Supplier",class:"text-left"},{field:"invoice_number",header:"Referensi",class:"text-left"},{field:"amount",header:"Total",class:"text-left",type:"currency"},{field:"pay",header:"Bayar",class:"text-left",type:"currency"},{field:"sisa_tagihan",header:"Sisa Tagihan",class:"text-left",type:"currency"},{field:"keterangan",header:"Keterangan",class:"text-left"},{field:"status",header:"Status",class:"text-left"}],lKategori:[],selectedKategori:null,lGudang:[],selectedGudang:null,lSupplier:[],selectedSupplier:null,lStatus:[],selectedStatus:null,filter:!1,filters:{}}},created(){this.initFilters()},mounted(){this.getData()},methods:{ubahSupplier(e){e.value===null?this.f.id_supplier=null:this.f.id_supplier=this.selectedSupplier.id,this.getReport()},ubahStatus(e){this.f.status=e.value.value,this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},exportToXLSX(){const e=m.utils.table_to_sheet(document.querySelector("table")),l=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];e["!cols"]=l;const r=m.utils.book_new();m.utils.book_append_sheet(r,e,"Sheet1"),m.writeFile(r,`Report Pembelian ${new Date().getTime()}.xlsx`)},ubahPeriode(){const e=new Date,l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=l,this.f.akhir=r;break}case"Kemarin":{const i=new Date(new Date(l).setDate(l.getDate()-1));this.f.awal=i,this.f.akhir=i;break}case"Perminggu":{const i=new Date(new Date(l).setDate(l.getDate()-7));this.f.awal=i,this.f.akhir=r;break}case"Perbulan":{const i=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=i,this.f.akhir=r;break}case"Pertahun":{const i=new Date(e.getFullYear(),0,1);this.f.awal=i,this.f.akhir=r;break}case"MingguLalu":{const i=new Date(new Date(l).setDate(l.getDate()-l.getDay()-7)),t=new Date(new Date(i).setDate(i.getDate()+6));this.f.awal=i,this.f.akhir=t;break}case"BulanLalu":{const i=new Date(e.getFullYear(),e.getMonth()-1,1),t=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=i,this.f.akhir=t;break}case"TahunLalu":{const i=new Date(e.getFullYear()-1,0,1),t=new Date(e.getFullYear()-1,11,31);this.f.awal=i,this.f.akhir=t;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},getReport(){U.getPembelian(this.f).then(e=>{this.items=e.data.data,console.log(this.items,"itemmss")}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Report Pembelian",life:3e3})}).finally(()=>{this.loading=!1})},getData(){this.getReport(),this.loading=!0,O.index().then(e=>{this.lKategori=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Kategori Barang",life:3e3})}).finally(()=>{this.loading=!1}),N.getKontakSupplier().then(e=>{this.lSupplier=e.data.data,e.data.data.length==1&&(this.selectedSupplier=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),T.index().then(e=>{this.lGudang=e.data.data,e.data.data.length==1&&(this.selectedGudang=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Gudang",life:3e3})}).finally(()=>{this.loading=!1})},selectKontak(e){this.id_customer=e.value.id,this.customer=e.value.text},formatNumber(e){if(e)return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},exportCSV(){this.$refs.dt.exportCSV({filename:"Pembelian.csv"})},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}},components:{}},A={class:"grid crud-demo"},I={class:"col-12"},E={class:"card"},G={class:"my-2"},j=s("h5",{class:"mbe-4"},"Filter Report Pembelian",-1),q={class:"p-fluid formgrid grid"},H={class:"field col-2 d-flex justifiy-content-center align-items-end"},W=s("label",{for:"supplier",class:"mb-1"},"Supplier",-1),X={class:"field col-2 d-flex justifiy-content-center align-items-end"},z=s("label",{for:"status",class:"mb-1"},"Status",-1),J={class:"field col-2 d-flex justifiy-content-center align-items-end"},Q=s("label",{for:"periode",class:"mb-1"},"Periode",-1),Z={class:"field col-2"},$={class:"p-float-label"},ee=s("p",{class:"mb-1"},"Periode Awal",-1),te={class:"field col-2"},le={class:"p-float-label"},ae=s("p",{class:"mb-1"},"Periode Akhir",-1),se={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ie=s("h5",{class:"m-0"},"Report Pembelian",-1),oe={class:"flex gap-2 col-12 md:col-5"},ne={class:"block p-input-icon-left w-full"},re=s("i",{class:"pi pi-search"},null,-1),de={key:0,class:"text-right"},ue={key:1};function ce(e,l,r,i,t,d){const x=n("Toast"),_=n("Button"),D=n("MyExport"),P=n("Toolbar"),f=n("Dropdown"),w=n("Calendar"),C=n("InputText"),L=n("MultiSelect"),g=n("Column"),V=n("DataTable");return c(),h("div",A,[s("div",I,[s("div",E,[o(x),o(P,{class:"mb-4"},{start:u(()=>[s("div",G,[o(_,{icon:"pi pi-filter",label:"Filter",class:b(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:d.showHideFilter},null,8,["onClick","class"])])]),end:u(()=>[o(D,{value:t.items,selectedColumns:t.selectedColumns,title:"Export Excel"},null,8,["value","selectedColumns"]),o(_,{icon:"pi pi-external-link",label:"Export CSV",title:"Report Pembelian",name:"Report Pembelian",onClick:l[0]||(l[0]=a=>d.exportCSV(a))})]),_:1}),s("div",{class:b(["card",{hidden:!t.filter}])},[j,s("div",q,[s("div",H,[W,o(f,{id:"supplier",modelValue:t.selectedSupplier,"onUpdate:modelValue":l[1]||(l[1]=a=>t.selectedSupplier=a),onChange:d.ubahSupplier,options:t.lSupplier,placeholder:"Supplier",optionLabel:"kontak",showClear:""},null,8,["modelValue","onChange","options"])]),s("div",X,[z,o(f,{id:"status",modelValue:t.selectedStatus,"onUpdate:modelValue":l[2]||(l[2]=a=>t.selectedStatus=a),options:t.statuses,onChange:d.ubahStatus,optionLabel:"label",placeholder:"All"},null,8,["modelValue","options","onChange"])]),s("div",J,[Q,o(f,{id:"periode",modelValue:t.selectedPeriode,"onUpdate:modelValue":l[3]||(l[3]=a=>t.selectedPeriode=a),onChange:d.ubahPeriode,options:t.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),s("div",Z,[s("span",$,[ee,o(w,{dateFormat:"dd-mm-yy",onDateSelect:d.getReportCustom,modelValue:t.f.awal,"onUpdate:modelValue":l[4]||(l[4]=a=>t.f.awal=a),inputId:"periodeawal"},null,8,["onDateSelect","modelValue"])])]),s("div",te,[s("span",le,[ae,o(w,{dateFormat:"dd-mm-yy",onDateSelect:d.getReportCustom,modelValue:t.f.akhir,"onUpdate:modelValue":l[5]||(l[5]=a=>t.f.akhir=a),inputId:"periodeakhir"},null,8,["onDateSelect","modelValue"])])])])],2),o(V,{ref:"dt",value:t.items,selection:e.selectedItem,"onUpdate:selection":l[8]||(l[8]=a=>e.selectedItem=a),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Report Pembelian",responsiveLayout:"scroll"},{header:u(()=>[s("div",se,[ie,s("div",oe,[s("span",ne,[re,o(C,{modelValue:t.filters.global.value,"onUpdate:modelValue":l[6]||(l[6]=a=>t.filters.global.value=a),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),o(L,{modelValue:t.selectedColumns,"onUpdate:modelValue":l[7]||(l[7]=a=>t.selectedColumns=a),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),default:u(()=>[(c(),v(g,{field:"no",header:"No",sortable:!1,headerStyle:"width:4%; min-width:3rem;",key:"no"},{body:u(a=>[S(p(a.index+1),1)]),_:1})),o(g,{field:"date",header:"Tanggal",sortable:!0,headerStyle:"width:14%; min-width:10rem;",key:"date"},{body:u(a=>[S(p(e.$h.formatDate(a.data.date)),1)]),_:1}),(c(!0),h(M,null,K(t.selectedColumns,(a,F)=>(c(),v(g,{field:a.field,header:a.header,class:b(a.class),key:a.field+"_"+F,sortable:!0},{body:u(({data:y,field:k})=>[a.type=="currency"?(c(),h("div",de,p(e.$h.formatNumber(y[k])),1)):(c(),h("div",ue,p(y[k]),1))]),_:2},1032,["field","header","class"]))),128))]),_:1},8,["value","selection","filters"])])])])}const be=R(Y,[["render",ce]]);export{be as default};
