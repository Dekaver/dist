import{_ as S,a0 as G,$ as V,F as B,r as i,o as u,c as h,b as o,d as n,e as d,n as g,t as c,k,m as F,q as M}from"./index-11eb6111.js";import{a as T}from"./kategoriproduk-68d52205.js";import{a as K}from"./index-fa5c02f8.js";import{a as O}from"./options-b2eb7ae6.js";const E={data(){return{items:[],expandedRowGroups:G(),selectedColumns:[{field:"kode_barang",header:"Kode Barang"},{field:"nama_barang",header:"Nama Barang"},{field:"qty",header:"Qty",type:"currency"},{field:"satuan",header:"Satuan",type:"text"}],Columns:[{field:"kode_barang",header:"Kode Barang"},{field:"nama_barang",header:"Nama Barang"},{field:"qty",header:"Qty",type:"currency"},{field:"satuan",header:"Satuan",type:"text"}],lKategori:[],selectedKategori:null,lGudang:[],selectedGudang:null,filter:!1,filters:{},lSupplier:[],selectedSupplier:null,lStatus:[],selectedStatus:null,statuses:[{label:"All",value:""},{label:"Lunas",value:"Lunas"},{label:"Belum Lunas",value:"Belum Lunas"},{label:"Belum Bayar",value:"Belum Bayar"}],periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],f:{awal:null,akhir:null},selectedPeriode:{label:"All",value:""}}},created(){this.initFilters()},mounted(){this.getData()},methods:{ubahSupplier(e){e.value===null?this.f.id_supplier=null:this.f.id_supplier=this.selectedSupplier.id,this.getReport()},ubahGudang(e){e.value===null?this.f.id_gudang=null:this.f.id_gudang=this.selectedGudang.id,this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},ubahPeriode(){const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),p=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=a,this.f.akhir=p;break}case"Kemarin":{const s=new Date(new Date(a).setDate(a.getDate()-1));this.f.awal=s,this.f.akhir=s;break}case"Perminggu":{const s=new Date(new Date(a).setDate(a.getDate()-7));this.f.awal=s,this.f.akhir=p;break}case"Perbulan":{const s=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=s,this.f.akhir=p;break}case"Pertahun":{const s=new Date(e.getFullYear(),0,1);this.f.awal=s,this.f.akhir=p;break}case"MingguLalu":{const s=new Date(new Date(a).setDate(a.getDate()-a.getDay()-7)),t=new Date(new Date(s).setDate(s.getDate()+6));this.f.awal=s,this.f.akhir=t;break}case"BulanLalu":{const s=new Date(e.getFullYear(),e.getMonth()-1,1),t=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=s,this.f.akhir=t;break}case"TahunLalu":{const s=new Date(e.getFullYear()-1,0,1),t=new Date(e.getFullYear()-1,11,31);this.f.awal=s,this.f.akhir=t;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},onRowGroupExpand(e){console.log("Row Group Expanded",e.data)},onRowGroupCollapse(e){console.log("Row Group Collapsed",e.data)},getReport(){K.getPenerimaanBarang(this.f).then(e=>{this.items=e.data.data,console.log(this.items,"itemmss")}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Report Pembelian",life:3e3})}).finally(()=>{this.loading=!1})},getData(){this.loading=!0,O.getKontakSupplier().then(e=>{this.lSupplier=e.data.data,e.data.data.length==1&&(this.selectedSupplier=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),T.index().then(e=>{this.lKategori=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Kategori Barang",life:3e3})}).finally(()=>{this.loading=!1}),V.index().then(e=>{this.lGudang=e.data.data,e.data.data.length==1&&(this.selectedGudang=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Gudang",life:3e3})}).finally(()=>{this.loading=!1}),this.getReport()},selectKontak(e){this.id_customer=e.value.id,this.customer=e.value.text},formatNumber(e){if(e)return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},exportCSV(){this.$refs.dt.exportCSV()},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}},components:{}},N={class:"grid crud-demo"},U={class:"col-12"},Y={class:"card"},A={class:"my-2"},I=o("h5",{class:"mbe-4"},"Filter Report Pembelian",-1),j={class:"p-fluid formgrid grid"},q={class:"field col-2 d-flex justifiy-content-center align-items-end"},H=o("label",{for:"supplier",class:"mb-1"},"Supplier",-1),Q={class:"field col-2 d-flex justifiy-content-center align-items-end"},W=o("label",{for:"supplier",class:"mb-1"},"Gudang",-1),z={class:"field col-2 d-flex justifiy-content-center align-items-end"},J=o("label",{for:"periode",class:"mb-1"},"Periode",-1),X={class:"field col-2"},Z={class:"p-float-label"},$=o("p",{class:"mb-1"},"Periode Awal",-1),ee={class:"field col-2"},te={class:"p-float-label"},ae=o("p",{class:"mb-1"},"Periode Akhir",-1),le={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},oe=o("h5",{class:"m-0"},"Report Penerimaan Barang",-1),se={class:"flex gap-2 col-12 md:col-5"},ne={class:"block p-input-icon-left w-full"},ie=o("i",{class:"pi pi-search"},null,-1),re={class:"vertical-align-middle ml-2 font-bold line-height-3"},de={class:"vertical-align-middle ml-2 font-bold line-height-3"},ue={class:"vertical-align-middle ml-2 font-bold line-height-3"},pe=o("template",null,null,-1),ce={key:0},he={key:1};function me(e,a,p,s,t,r){const v=i("Toast"),f=i("Button"),C=i("MyExport"),D=i("Toolbar"),m=i("Dropdown"),b=i("Calendar"),x=i("InputText"),L=i("MultiSelect"),_=i("Column"),P=i("DataTable");return u(),h("div",N,[o("div",U,[o("div",Y,[n(v),n(D,{class:"mb-4"},{start:d(()=>[o("div",A,[n(f,{icon:"pi pi-filter",label:"Filter",class:g(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:r.showHideFilter},null,8,["onClick","class"])])]),end:d(()=>[n(C,{value:t.items,selectedColumns:t.selectedColumns,title:"Export Excel"},null,8,["value","selectedColumns"]),n(f,{icon:"pi pi-external-link",label:"Export CSV",title:"Report Pembelian",name:"Report Hutang Supplier",onClick:a[0]||(a[0]=l=>r.exportCSV(l))})]),_:1}),o("div",{class:g(["card",{hidden:!t.filter}])},[I,o("div",j,[o("div",q,[H,n(m,{id:"supplier",modelValue:t.selectedSupplier,"onUpdate:modelValue":a[1]||(a[1]=l=>t.selectedSupplier=l),onChange:r.ubahSupplier,options:t.lSupplier,placeholder:"Supplier",optionLabel:"kontak",showClear:""},null,8,["modelValue","onChange","options"])]),o("div",Q,[W,n(m,{id:"supplier",modelValue:t.selectedGudang,"onUpdate:modelValue":a[2]||(a[2]=l=>t.selectedGudang=l),onChange:r.ubahGudang,options:t.lGudang,placeholder:"Gudang",optionLabel:"gudang",showClear:""},null,8,["modelValue","onChange","options"])]),o("div",z,[J,n(m,{id:"periode",modelValue:t.selectedPeriode,"onUpdate:modelValue":a[3]||(a[3]=l=>t.selectedPeriode=l),onChange:r.ubahPeriode,options:t.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),o("div",X,[o("span",Z,[$,n(b,{dateFormat:"dd-mm-yy",onDateSelect:r.getReportCustom,modelValue:t.f.awal,"onUpdate:modelValue":a[4]||(a[4]=l=>t.f.awal=l),inputId:"periodeawal"},null,8,["onDateSelect","modelValue"])])]),o("div",ee,[o("span",te,[ae,n(b,{dateFormat:"dd-mm-yy",onDateSelect:r.getReportCustom,modelValue:t.f.akhir,"onUpdate:modelValue":a[5]||(a[5]=l=>t.f.akhir=l),inputId:"periodeakhir"},null,8,["onDateSelect","modelValue"])])])])],2),n(P,{ref:"dt",expandedRowGroups:t.expandedRowGroups,"onUpdate:expandedRowGroups":a[8]||(a[8]=l=>t.expandedRowGroups=l),value:t.items,expandableRowGroups:"",rowGroupMode:"subheader",groupRowsBy:"id",onRowgroupExpand:r.onRowGroupExpand,onRowgroupCollapse:r.onRowGroupCollapse,sortMode:"single",sortField:"id",sortOrder:1,dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Report Pembelian",responsiveLayout:"scroll"},{header:d(()=>[o("div",le,[oe,o("div",se,[o("span",ne,[ie,n(x,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[6]||(a[6]=l=>t.filters.global.value=l),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),n(L,{modelValue:t.selectedColumns,"onUpdate:modelValue":a[7]||(a[7]=l=>t.selectedColumns=l),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),groupheader:d(l=>[o("span",re,c(l.data.supplier),1),o("span",de,"Tanggal : "+c(e.$h.formatDate(l.data.tanggal)),1),o("span",ue,"DN : "+c(l.data.nomor_dn),1)]),default:d(()=>[(u(),k(_,{sortable:!1,headerStyle:"width:4%; min-width:3rem;",key:"no"},{default:d(()=>[pe]),_:1})),(u(!0),h(F,null,M(t.selectedColumns,(l,R)=>(u(),k(_,{field:l.field,header:l.header,class:g(l.class),key:l.field+"_"+R,sortable:!0},{body:d(({data:w,field:y})=>[l.type=="currency"?(u(),h("div",ce,c(e.$h.formatNumber(w[y])),1)):(u(),h("div",he,c(w[y]),1))]),_:2},1032,["field","header","class"]))),128))]),_:1},8,["expandedRowGroups","value","onRowgroupExpand","onRowgroupCollapse","filters"])])])])}const we=S(E,[["render",me]]);export{we as default};
