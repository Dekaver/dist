import{_ as E,s as w,F as U,r as n,o as d,c as u,b as o,d as a,e as i,n as g,k as C,f as x,l as b,t as h,m as O,q as R}from"./index-11eb6111.js";import{a as v}from"./api-b68fe7dd.js";const M={data(){return{lItem:[],selectedItem:null,item:null,deleteDialog:!1,filter:!1,filters:{},f:{awal:null,akhir:null,id_supplier:null,selectedStatus:{label:"All",value:""}},statuses:[{label:"All",value:""},{label:"Draft",value:"D"},{label:"Open",value:"O"},{label:"Close",value:"C"}],selectedColumns:[{field:"tanggal",header:"Tanggal",type:"date"},{field:"nomor",header:"Nomor"},{field:"nomor_po",header:"Nomor PO"},{field:"supplier",header:"Supplier"},{field:"nama_pegawai",header:"Dibuat Oleh"},{field:"status",header:"Status"}],Columns:[{field:"tanggal",header:"Tanggal",type:"date"},{field:"nomor",header:"Nomor"},{field:"nomor_po",header:"Nomor PO"},{field:"supplier",header:"Supplier"},{field:"nama_pegawai",header:"Dibuat Oleh"},{field:"status",header:"Status"}],lPersetujuan:[]}},created(){this.initFilters()},mounted(){this.getData(),this.getDataPersetujuan(),w.on("update-persetujuan-penerimaan-barang",()=>{this.getDataPersetujuan()})},beforeUnmount(){w.off("update-persetujuan-penerimaan-barang")},computed:{filteredItems(){return this.lItem.filter(l=>(this.f.selectedStatus.value==""?!0:this.f.selectedStatus.value==l.status)&&(this.f.id_supplier==null?!0:this.f.id_supplier==l.id_supplier)&&(this.f.awal==null?!0:this.f.awal.toLocaleDateString()<=new Date(l.tanggal).toLocaleDateString())&&(this.f.akhir==null?!0:this.f.akhir.toLocaleDateString()>=new Date(l.tanggal).toLocaleDateString())&&(this.selectedAkun?this.selectedAkun.id==l.akun:!0))}},methods:{async getData(){await v.index().then(l=>{this.lItem=l.data.data})},async getDataPersetujuan(){await v.getPersetujuan().then(l=>{this.lPersetujuan=l.data.data}).catch(l=>{this.$toast.add({severity:"error",summary:"Failed",detail:l.response.data.message,life:3e3})})},FormEdit(l){this.$router.push({name:"penerimaanbarang.edit",params:{id:l.id}})},onRowDblclick(l){this.$router.push({name:"penerimaanbarang.edit",params:{id:l.data.id}})},async Destroy(l){await v.destroy(l.id).then(s=>{this.$toast.add({severity:"success",summary:"Success",detail:s.data.message,life:3e3}),this.lItem=this.lItem.filter(y=>y.id!=l.id),this.deleteDialog=!1}).catch(s=>{this.$toast.add({severity:"error",summary:"Error",detail:s.response.data.message,life:3e3}),this.deleteDialog=!1})},confirmDelete(l){this.deleteDialog=!0,this.item={...l}},showHideFilter(){this.filter=!this.filter},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:U.CONTAINS}}}}},K={class:"grid crud-demo"},z={class:"col-12"},H={class:"card"},q={class:"my-2"},Y=o("h5",{class:"mbe-4"},"Pencarian Penerimaan Barang",-1),G={class:"p-fluid formgrid grid"},J={class:"field col-2"},Q={class:"p-float-label"},W=o("p",{class:"mb-1"},"Periode Awal",-1),X={class:"field col-2"},Z={class:"p-float-label"},$=o("p",{class:"mb-1"},"Periode Akhir",-1),ee={class:"field col-2"},te={class:"field col-2 d-flex justifiy-content-center align-items-end mb-0"},le=o("label",{for:"status",class:"mb-1"},"Status",-1),se={class:"field col-auto",style:{display:"flex","align-items":"flex-end","align-content":"flex-end"}},oe={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ae=o("h5",{class:"m-0"},"Penerimaan Barang",-1),ne={class:"flex gap-2 col-12 md:col-5"},ie={class:"block p-input-icon-left w-full"},re=o("i",{class:"pi pi-search"},null,-1),de={key:0},ue={key:1},ce={key:2},me={key:3,class:"text-right"},pe={key:4},he={class:"flex align-items-center justify-content-center"},fe=o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),_e={key:0};function ge(l,s,y,be,e,c){const P=n("Toast"),m=n("Button"),k=n("router-link"),S=n("MyExport"),V=n("Toolbar"),D=n("Calendar"),T=n("AutoCompleteKontak"),I=n("Dropdown"),L=n("InputText"),j=n("MultiSelect"),f=n("Column"),F=n("Tag"),A=n("ActionButton"),N=n("DataTable"),B=n("Dialog");return d(),u("div",K,[o("div",z,[o("div",H,[a(P),a(V,{class:"mb-4"},{start:i(()=>[o("div",q,[a(k,{to:"/penerimaan-barang/create",class:"btn btn-added me-2"},{default:i(()=>[a(m,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2"})]),_:1}),a(m,{icon:"pi pi-filter",label:"Filter",class:g(["p-button mx-2",{"p-button-block":e.filter,"p-button-outlined":!e.filter}]),onClick:c.showHideFilter},null,8,["onClick","class"]),e.lPersetujuan.length>0?(d(),C(k,{key:0,to:"/penerimaan-barang/persetujuan",class:"btn btn-added me-2"},{default:i(()=>[a(m,{icon:"pi pi-shield",class:"p-button mx-2 p-button-outlined",label:"Persetujuan",badge:e.lPersetujuan.length,severity:"warning",badgeSeverity:"warning"},null,8,["badge"])]),_:1})):x("",!0)])]),end:i(()=>[a(S,{value:c.filteredItems,selectedColumns:e.selectedColumns,title:"Export Penerimaan Barang"},null,8,["value","selectedColumns"])]),_:1}),o("div",{class:g(["card fadein",{hidden:!e.filter}])},[Y,o("div",G,[o("div",J,[o("span",Q,[W,a(D,{dateFormat:"dd-mm-yy",modelValue:e.f.awal,"onUpdate:modelValue":s[0]||(s[0]=t=>e.f.awal=t),inputId:"f.awal"},null,8,["modelValue"])])]),o("div",X,[o("span",Z,[$,a(D,{dateFormat:"dd-mm-yy",modelValue:e.f.akhir,"onUpdate:modelValue":s[1]||(s[1]=t=>e.f.akhir=t),inputId:"f.akhir"},null,8,["modelValue"])])]),o("div",ee,[a(T,{modelValue:e.f.id_supplier,"onUpdate:modelValue":s[2]||(s[2]=t=>e.f.id_supplier=t),"is-supplier":"",label:"Supplier"},null,8,["modelValue"])]),o("div",te,[le,a(I,{id:"status",modelValue:e.f.selectedStatus,"onUpdate:modelValue":s[3]||(s[3]=t=>e.f.selectedStatus=t),options:e.statuses,optionLabel:"label",placeholder:"Status"},null,8,["modelValue","options"])]),o("div",se,[a(m,{label:"Search"})])])],2),a(N,{ref:"dt",value:c.filteredItems,selection:e.selectedItem,"onUpdate:selection":s[6]||(s[6]=t=>e.selectedItem=t),dataKey:"id","selection-mode":"single",onRowDblclick:c.onRowDblclick,paginator:!0,rows:10,filters:e.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Purchase order",responsiveLayout:"scroll"},{header:i(()=>[o("div",oe,[ae,o("div",ne,[o("span",ie,[re,a(L,{modelValue:e.filters.global.value,"onUpdate:modelValue":s[4]||(s[4]=t=>e.filters.global.value=t),placeholder:"Search...",class:"w-full"},null,8,["modelValue"])]),a(j,{modelValue:e.selectedColumns,"onUpdate:modelValue":s[5]||(s[5]=t=>e.selectedColumns=t),options:e.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-3rem"},null,8,["modelValue","options"])])])]),default:i(()=>[a(f,{header:"#",headerStyle:"width:10px"},{body:i(t=>[b(h(t.index+1),1)]),_:1}),(d(!0),u(O,null,R(e.selectedColumns,(t,_)=>(d(),C(f,{field:t.field,header:t.header,class:g(t.class),key:t.field+"_"+_,sortable:!0},{body:i(({data:p,field:r})=>[r=="icon"?(d(),u("div",de,[a(m,{icon:p[r],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):r=="status"?(d(),u("div",ue,[a(F,{value:l.$h.getLabel(p[r]),severity:l.$h.getLabel(p[r])},null,8,["value","severity"])])):r=="tanggal"?(d(),u("div",ce,h(l.$h.formatDate(p[r])),1)):r=="total"?(d(),u("div",me,h(l.$h.formatNumber(p[r])),1)):(d(),u("div",pe,h(p[r]),1))]),_:2},1032,["field","header","class"]))),128)),a(f,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:i(({data:t,index:_})=>[a(A,{data:t,index:_,onEdit:c.FormEdit,onDelete:p=>c.confirmDelete(t),showDelete:t.status!="C"},null,8,["data","index","onEdit","onDelete","showDelete"])]),_:1})]),_:1},8,["value","selection","onRowDblclick","filters"]),a(B,{visible:e.deleteDialog,"onUpdate:visible":s[9]||(s[9]=t=>e.deleteDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[a(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[7]||(s[7]=t=>e.deleteDialog=!1)}),a(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:s[8]||(s[8]=t=>c.Destroy(e.item))})]),default:i(()=>[o("div",he,[fe,e.item?(d(),u("span",_e,[b("Are you sure you want to delete "),o("b",null,h(e.item.nomor),1),b("?")])):x("",!0)])]),_:1},8,["visible"])])])])}const ke=E(M,[["render",ge]]);export{ke as default};
