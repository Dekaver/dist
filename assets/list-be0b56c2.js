import{_ as F,X as T,F as q,r as o,o as d,c,b as i,d as s,e as n,l as C,t as k,m as B,q as U,n as f,f as h,k as E,p as M,g as R}from"./index-11eb6111.js";import{a as b}from"./pajak-69cfe91a.js";const z={data(){return{lPajak:null,lAccountPenjualan:null,lAccountPembelian:null,selectedAccountPenjualan:null,selectedAccountPembelian:null,filteredAccountPenjualan:null,filteredAccountPembelian:null,pajakDialog:!1,deletepajakDialog:!1,deletelPajakDialog:!1,pajak:{},selectedlPajak:null,filters:{},isSubmitted:!1,storage:null,selectedColumns:[{header:"Nama",field:"nama",class:"w-20rem"},{header:"Nilai",field:"nilai",class:"w-20rem"},{header:"Potongan",field:"is_potong",class:"w-20rem"},{header:"Akun Pembelian",field:"nama_akun_pembelian",class:"w-20rem"},{header:"Akun Penjualan",field:"nama_akun_penjualan",class:"w-20rem"}],Columns:[{header:"Nama",field:"nama",class:"w-20rem"},{header:"Nilai",field:"nilai",class:"w-20rem"},{header:"Potongan",field:"is_potong",class:"w-20rem"},{header:"Akun Pembelian",field:"nama_akun_pembelian",class:"w-20rem"},{header:"Akun Penjualan",field:"nama_akun_penjualan",class:"w-20rem"}]}},created(){this.initFilters()},mounted(){this.getData()},methods:{async getData(){b.index().then(a=>{this.lPajak=a.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Data Pajak ",life:3e3})}),await T.indexByTransaction().then(a=>{this.lAccountPenjualan=a.data.data,this.lAccountPembelian=a.data.data}).catch(a=>{this.$toast.add({severity:"error",summary:"Failed",detail:a.response.data.message,life:3e3})})},FormNew(){this.pajak={},this.pajak.nilai=0,this.isSubmitted=!1,this.pajakDialog=!0,this.selectedAccountPenjualan=null,this.selectedAccountPembelian=null},HideDialog(){this.pajakDialog=!1,this.isSubmitted=!1},searchPenjualan(a){setTimeout(()=>{a.query.trim().length?this.filteredAccountPenjualan=this.lAccountPenjualan.filter(l=>l.name.toLowerCase().includes(a.query.toLowerCase())||l.code.toLowerCase().includes(a.query.toLowerCase())):this.filteredAccountPenjualan=[...this.lAccountPenjualan]},250)},searchPembelian(a){setTimeout(()=>{a.query.trim().length?this.filteredAccountPembelian=this.lAccountPembelian.filter(l=>l.name.toLowerCase().includes(a.query.toLowerCase())||l.code.toLowerCase().includes(a.query.toLowerCase())):this.filteredAccountPembelian=[...this.lAccountPembelian]},250)},selectPenjualan(a){this.pajak.akun_penjualan=a.value.id,this.pajak.nama_akun_penjualan=a.value.name},selectPembelian(a){this.pajak.akun_pembelian=a.value.id,this.pajak.nama_akun_pembelian=a.value.name},savePajak(){this.isSubmitted=!0,this.pajak.nama.trim()&&(this.pajak.id?b.update(this.pajak.id,this.pajak).then(()=>{this.$toast.add({severity:"success",summary:"Successful",detail:"pajak Updated",life:3e3}),this.lPajak[this.findIndexById(this.pajak.id)]=this.pajak}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Update pajak ",life:3e3})}).finally(()=>{this.pajak={}}):(this.pajak.id=this.createId(),b.store(this.pajak).then(()=>{this.$toast.add({severity:"success",summary:"Successful",detail:"pajak Created",life:3e3})}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Create pajak ",life:3e3})}).finally(()=>{this.pajak={}}),this.lPajak.push(this.pajak)),this.pajakDialog=!1)},FormEdit(a){this.pajak={...a},this.pajak.akun_penjualan!=null&&(this.selectedAccountPenjualan=this.lAccountPenjualan.find(l=>l.kode==this.pajak.akun_penjualan)),this.pajak.akun_pembelian!=null&&(this.selectedAccountPembelian=this.lAccountPembelian.find(l=>l.kode==this.pajak.akun_pembelian)),this.pajakDialog=!0},confirmDelete(a){this.pajak=a,this.deletepajakDialog=!0},deletePajak(){this.lPajak=this.lPajak.filter(a=>a.id!==this.pajak.id),b.delete(this.pajak.id).then(()=>{this.$toast.add({severity:"success",summary:"Successful",detail:"pajak Deleted",life:3e3})}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Deleted pajak",life:3e3})}).finally(()=>{this.pajak={}}),this.deletepajakDialog=!1},findIndexById(a){let l=-1;for(let m=0;m<this.lPajak.length;m++)if(this.lPajak[m].id===a){l=m;break}return l},createId(){let a=0;return this.lPajak.length==0?a=1:a=this.lPajak.reduce((m,P)=>m.id>P.id?m:P).id+1,a},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){this.deletelPajakDialog=!0},deleteSelectedlPajak(){this.lPajak=this.lPajak.filter(a=>!this.selectedlPajak.includes(a)),this.deletelPajakDialog=!1,this.selectedlPajak=null,this.$toast.add({severity:"success",summary:"Successful",detail:"lPajak Deleted",life:3e3})},initFilters(){this.filters={global:{value:null,matchMode:q.CONTAINS}}}}},r=a=>(M("data-v-d57337fe"),a=a(),R(),a),H={class:"grid crud-demo"},O={class:"col-12"},Y={class:"card"},K={class:"my-2"},X={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},G=r(()=>i("h5",{class:"m-0"},"Manage Pajak",-1)),J={class:"block mt-2 md:mt-0 p-input-icon-left"},Q=r(()=>i("i",{class:"pi pi-search"},null,-1)),W={key:0},Z={key:1},$={key:2},ee={class:"formgrid grid"},ae={class:"field col-12 d-flex justifiy-content-center align-items-end"},te=r(()=>i("label",{for:"nama"},"Nama",-1)),le={key:0,class:"p-invalid"},ie={class:"field col-12 d-flex justifiy-content-center align-items-end"},se=r(()=>i("label",{for:"nilai"},"Nilai Efektif",-1)),ne={key:0,class:"p-invalid"},oe={class:"col-12 mb-3"},de={class:""},ue=r(()=>i("span",{id:"switch1",style:{position:"relative",bottom:"8px",left:"8px"}},"Nilai Pemotongan",-1)),ce={class:"field col-12 d-flex justifiy-content-center align-items-end"},re=r(()=>i("label",{for:"inventoryStatus",class:"mb-2"},"Akun Pajak Penjulan",-1)),me={key:0,class:"p-invalid"},pe={class:"field col-12 d-flex justifiy-content-center align-items-end"},ke=r(()=>i("label",{for:"inventoryStatus",class:"mb-2"},"Akun Pajak Pembelian",-1)),he={key:0,class:"p-invalid"},je={class:"flex align-items-center justify-content-center"},fe=r(()=>i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),_e={key:0},be={class:"flex align-items-center justify-content-center"},Pe=r(()=>i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ge={key:0};function ye(a,l,m,P,e,u){const A=o("Toast"),p=o("Button"),D=o("MyExport"),S=o("Toolbar"),w=o("InputText"),g=o("Column"),V=o("ActionButton"),I=o("DataTable"),N=o("InputNumber"),L=o("InputSwitch"),x=o("AutoComplete"),y=o("Dialog");return d(),c("div",H,[i("div",O,[i("div",Y,[s(A),s(S,{class:"mb-4"},{start:n(()=>[i("div",K,[s(p,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:u.FormNew},null,8,["onClick"])])]),end:n(()=>[s(D,{value:e.lPajak,selectedColumns:e.selectedColumns,title:"Export Pajak"},null,8,["value","selectedColumns"])]),_:1}),s(I,{ref:"dt",value:e.lPajak,selection:e.selectedlPajak,"onUpdate:selection":l[1]||(l[1]=t=>e.selectedlPajak=t),dataKey:"id",paginator:!0,rows:10,filters:e.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Pajak",responsiveLayout:"scroll"},{header:n(()=>[i("div",X,[G,i("span",J,[Q,s(w,{modelValue:e.filters.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>e.filters.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),default:n(()=>[s(g,{header:"#",headerStyle:"width:10px"},{body:n(t=>[C(k(t.index+1),1)]),_:1}),(d(!0),c(B,null,U(e.selectedColumns,(t,v)=>(d(),E(g,{field:t.field,header:t.header,class:f(t.class),key:t.field+"_"+v,sortable:!0},{body:n(({data:j,field:_})=>[_=="icon"?(d(),c("div",W,[s(p,{icon:j[_],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):t.type=="date"?(d(),c("div",Z,k(a.$h.formatDate(j[_])),1)):(d(),c("div",$,k(j[_]),1))]),_:2},1032,["field","header","class"]))),128)),s(g,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:n(({data:t,index:v})=>[s(V,{data:t,index:v,onEdit:j=>u.FormEdit(t),onDelete:j=>u.confirmDelete(t)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","selection","filters"]),s(y,{visible:e.pajakDialog,"onUpdate:visible":l[7]||(l[7]=t=>e.pajakDialog=t),style:{width:"450px"},header:"Pajak Details",modal:!0,class:"p-fluid"},{footer:n(()=>[s(p,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:u.HideDialog},null,8,["onClick"]),s(p,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:u.savePajak},null,8,["onClick"])]),default:n(()=>[i("div",ee,[i("div",ae,[te,s(w,{id:"nama",modelValue:e.pajak.nama,"onUpdate:modelValue":l[2]||(l[2]=t=>e.pajak.nama=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:f({"p-invalid":e.isSubmitted&&!e.pajak.nama})},null,8,["modelValue","class"]),e.isSubmitted&&!e.pajak.nama?(d(),c("small",le,"required.")):h("",!0)]),i("div",ie,[se,s(N,{modelValue:e.pajak.nilai,"onUpdate:modelValue":l[3]||(l[3]=t=>e.pajak.nilai=t),step:"0.5",class:f({"p-invalid":e.isSubmitted&&!e.pajak.nilai}),min:"0",max:"100",showButtons:""},null,8,["modelValue","class"]),e.isSubmitted&&!e.pajak.nilai?(d(),c("small",ne,"required.")):h("",!0)]),i("div",oe,[i("div",de,[s(L,{modelValue:e.pajak.is_potong,"onUpdate:modelValue":l[4]||(l[4]=t=>e.pajak.is_potong=t),"aria-labelledby":"switch1"},null,8,["modelValue"]),ue])]),i("div",ce,[re,s(x,{modelValue:e.selectedAccountPenjualan,"onUpdate:modelValue":l[5]||(l[5]=t=>e.selectedAccountPenjualan=t),optionLabel:"name",suggestions:e.filteredAccountPenjualan,onComplete:u.searchPenjualan,onItemSelect:u.selectPenjualan,class:f({"p-invalid":e.isSubmitted&&!e.pajak.akun_penjualan}),dropdown:""},{option:n(t=>[i("tr",null,[i("td",null,"["+k(t.option.code)+"]",1),i("td",null,k(t.option.name),1)])]),_:1},8,["modelValue","suggestions","onComplete","onItemSelect","class"]),e.isSubmitted&&!e.pajak.akun_penjualan?(d(),c("small",me,"required.")):h("",!0)]),i("div",pe,[ke,s(x,{modelValue:e.selectedAccountPembelian,"onUpdate:modelValue":l[6]||(l[6]=t=>e.selectedAccountPembelian=t),optionLabel:"name",suggestions:e.filteredAccountPembelian,onComplete:u.searchPembelian,onItemSelect:u.selectPembelian,class:f({"p-invalid":e.isSubmitted&&!e.pajak.akun_pembelian}),dropdown:""},{option:n(t=>[i("tr",null,[i("td",null,"["+k(t.option.code)+"]",1),i("td",null,k(t.option.name),1)])]),_:1},8,["modelValue","suggestions","onComplete","onItemSelect","class"]),e.isSubmitted&&!e.pajak.akun_pembelian?(d(),c("small",he,"required.")):h("",!0)])])]),_:1},8,["visible"]),s(y,{visible:e.deletepajakDialog,"onUpdate:visible":l[9]||(l[9]=t=>e.deletepajakDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[s(p,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[8]||(l[8]=t=>e.deletepajakDialog=!1)}),s(p,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:u.deletePajak},null,8,["onClick"])]),default:n(()=>[i("div",je,[fe,e.pajak?(d(),c("span",_e,[C("Are you sure you want to delete "),i("b",null,k(e.pajak.pajak),1),C("?")])):h("",!0)])]),_:1},8,["visible"]),s(y,{visible:e.deletelPajakDialog,"onUpdate:visible":l[11]||(l[11]=t=>e.deletelPajakDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[s(p,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[10]||(l[10]=t=>e.deletelPajakDialog=!1)}),s(p,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:u.deleteSelectedlPajak},null,8,["onClick"])]),default:n(()=>[i("div",be,[Pe,e.pajak?(d(),c("span",ge,"Are you sure you want to delete the selected lPajak?")):h("",!0)])]),_:1},8,["visible"])])])])}const we=F(z,[["render",ye],["__scopeId","data-v-d57337fe"]]);export{we as default};
