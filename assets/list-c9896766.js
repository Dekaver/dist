import{D as b,_ as U,F as B,r as n,A as R,o as c,c as p,b as a,d as o,e as r,n as u,l as h,t as v,m as K,q as J,B as M,f as O,k as j,p as q,g as H}from"./index-11eb6111.js";import{A as z}from"./index-b9e295bc.js";import"./custom-zod-e9521e5d.js";import{z as d}from"./index-0ec66d4d.js";const w={index(){return b.get("/saldo-awal-ar/")},store(e){return b.post("/saldo-awal-ar/",e)},update(e,t){return b.patch("/saldo-awal-ar/"+e,t)},show(e){return b.get("/saldo-awal-ar/"+e)},destroy(e){return b.delete("/saldo-awal-ar/"+e)}};const X=d.object({invoice_date:d.date(),invoice:d.string().min(3),amount:d.number().gt(0),top:d.number().nullish(),id_top:d.number().int(),due_date:d.date(),id_customer:d.number().int()}),Y={data(){return{old_number:null,filter:!1,filters:{},isClean:!0,f:{awal:null,akhir:null,id_customer:null},item:{id:null,tanggal:null,tanggal_invoice:null,amount:0,top:0,due_date:null},filteredKontak:[],lKontak:[],lItem:[],selectedColumns:[{field:"invoice",header:"Nomor Invoice",class:"text-left"},{field:"invoice_date",header:"Tanggal Invoice",class:"text-left"},{field:"kontak",header:"Customer",class:"text-left"},{field:"top",header:"TOP",class:"text-left"},{field:"due_date",header:"Tanggal Jatuh Tempo",class:"text-left"},{field:"amount",header:"Jumlah",class:"text-right"}],Columns:[{field:"invoice",header:"Nomor Invoice",class:"text-left"},{field:"invoice_date",header:"Tanggal Invoice",class:"text-left"},{field:"kontak",header:"Customer",class:"text-left"},{field:"top",header:"TOP",class:"text-left"},{field:"due_date",header:"Tanggal Jatuh Tempo",class:"text-left"},{field:"amount",header:"Jumlah",class:"text-right"}],formDialog:!1,deleteformDialog:!1}},computed:{filteredSaldoAwal(){return this.lItem.filter(e=>{var t;return(((t=this.f.selectedStatus)==null?void 0:t.value)==null?!0:this.f.selectedStatus.value==e.status)&&(this.f.id_customer?this.f.id_customer==e.id_customer:!0)&&(this.f.awal?this.f.awal.toLocaleDateString()<=new Date(e.invoice_date).toLocaleDateString():!0)&&(this.f.akhir?this.f.akhir.toLocaleDateString()>=new Date(e.invoice_date).toLocaleDateString():!0)})},FormError(){var e,t;return this.isClean?{}:((t=(e=X.safeParse(this.item))==null?void 0:e.error)==null?void 0:t.format())||{}}},created(){this.initFilters()},mounted(){this.$isLoading.value=!0,this.getData().finally(()=>{this.$timeoutLoading()})},watch:{"item.top":function(e){if(this.item){const t=new Date(this.item.invoice_date);t.setDate(new Date(this.item.invoice_date).getDate()+parseInt(e)),this.item.due_date=t}},"item.invoice_date":function(e){if(this.item){const t=new Date(e);t.setDate(new Date(e).getDate()+this.item.top),this.item.due_date=t}}},methods:{async getData(){await w.index().then(e=>{this.lItem=e.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data Saldo Awal",life:3e3})})},FormNew(){this.item={invoice:this.tanggal,invoice_date:this.invoice_date,amount:0,top:0,due_date:this.due_date},this.isClean=!0,this.formDialog=!0},HideDialog(){this.formDialog=!1,this.isClean=!0},confirmDelete(e){this.item=e,this.deleteformDialog=!0},async Save(){this.isClean=!1;try{if(this.$isLoading.value=!0,Object.keys(this.FormError).length>0){this.$toast.add({severity:"warn",summary:"Failed",detail:"validate error",life:3e3});return}this.isEdit?await w.update(this.old_number,this.item).then(e=>{this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.lItem[this.lItem.findIndex(t=>t.invoice==this.old_number)]=this.item,this.isEdit=!1,this.formDialog=!1}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}):await w.store(this.item).then(()=>{this.getData(),this.item.amount=0,this.item.top=0,this.item.invoice=null,this.selectedKontak=null,this.$toast.add({severity:"success",summary:"Successful",detail:"Created Saldo Awal",life:3e3})}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}).finally(()=>{this.isLoading=!1}),this.selectedAtasan=null,this.isClean=!1,this.formDialog=!1}catch(e){e instanceof z&&this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}finally{this.$timeoutLoading()}},FormEdit(e){this.isEdit=!0,this.old_number=e.invoice,this.item={...e},this.item.invoice_date=new Date(e.invoice_date),this.item.amount=parseFloat(e.amount),this.item.due_date=new Date(e.due_date),this.formDialog=!0},onRowDblclick(e){this.isEdit=!0,this.old_number=e.data.invoice,this.item={...e.data},this.item.invoice_date=new Date(e.data.invoice_date),this.item.due_date=new Date(e.data.due_date),this.item.amount=parseFloat(e.data.amount),this.formDialog=!0},async Destroy(){await w.destroy(this.item.invoice).then(e=>{this.lItem=this.lItem.filter(t=>t.invoice!=this.item.invoice),this.$toast.add({severity:"success",summary:"Successful",detail:e.data.message,life:3e3}),this.deleteformDialog=!1}).catch(e=>{this.$toast.add({severity:"error",summary:"Failed",detail:e.response.data.message,life:3e3})}).finally(()=>{this.item={}})},selectKontak(e){this.item.id_customer=e.value.id,this.item.top=e.value.top},selectDate(e){this.item.invoice_date=new Date(e)},showHideFilter(){this.filter=!this.filter},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:B.CONTAINS}}}}},f=e=>(q("data-v-a2390fc2"),e=e(),H(),e),G={class:"grid crud-demo"},Q={class:"col-12"},W={class:"card"},Z={class:"my-2"},$=f(()=>a("h5",{class:"mbe-4"},"Pencarian Saldo Awal Piutang",-1)),ee={class:"p-fluid formgrid grid"},te={class:"field col-2"},ie={class:"p-float-label"},le=f(()=>a("p",{class:"mb-2"},"Periode Awal",-1)),oe={class:"field col-2"},ae={class:"p-float-label"},se=f(()=>a("p",{class:"mb-2"},"Periode Akhir",-1)),re={class:"field col-2"},ne={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},de=f(()=>a("h5",{class:"m-0"},"Saldo Awal Piutang",-1)),me={class:"block mt-2 md:mt-0 p-input-icon-left"},ce=f(()=>a("i",{class:"pi pi-search"},null,-1)),ue=f(()=>a("div",{class:"text-center"},"Empty",-1)),he={key:0},fe={key:1},_e={key:2},pe={class:"p-fluid formgrid grid"},ve={class:"field col-12 md:col-6"},ge={class:"field col-12 md:col-6"},be={class:"field col-12 md:col-5"},De={class:"field col-12 md:col-3"},ye={class:"field col-12 md:col-4"},we={class:"field col-12 md:col-12"},ke={class:"flex align-items-center justify-content-center"},xe=f(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ce={key:0};function Fe(e,t,Se,Ie,l,s){const V=n("Toast"),m=n("Button"),E=n("Toolbar"),k=n("Calendar"),S=n("AutoCompleteKontak"),x=n("InputText"),C=n("Column"),T=n("ActionButton"),L=n("DataTable"),D=n("Label"),y=n("ErrorMsg"),A=n("InputTop"),P=n("InputNumber"),I=n("Dialog"),N=R("select-all-text");return c(),p("div",G,[a("div",Q,[a("div",W,[o(V),o(E,{class:"mb-4"},{start:r(()=>[a("div",Z,[o(m,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:s.FormNew},null,8,["onClick"])]),o(m,{icon:"pi pi-filter",label:"Filter",class:u(["p-button mx-2",{"p-button-block":l.filter,"p-button-outlined":!l.filter}]),onClick:s.showHideFilter},null,8,["onClick","class"])]),end:r(()=>[o(m,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:t[0]||(t[0]=i=>s.exportCSV(i))})]),_:1}),a("div",{class:u(["card fadein",{hidden:!l.filter}])},[$,a("div",ee,[a("div",te,[a("span",ie,[le,o(k,{dateFormat:"dd-mm-yy",modelValue:l.f.awal,"onUpdate:modelValue":t[1]||(t[1]=i=>l.f.awal=i),inputId:"periodeawal"},null,8,["modelValue"])])]),a("div",oe,[a("span",ae,[se,o(k,{dateFormat:"dd-mm-yy",modelValue:l.f.akhir,"onUpdate:modelValue":t[2]||(t[2]=i=>l.f.akhir=i),inputId:"periodeakhir"},null,8,["modelValue"])])]),a("div",re,[o(S,{modelValue:l.f.id_customer,"onUpdate:modelValue":t[3]||(t[3]=i=>l.f.id_customer=i),label:"Customer","is-customer":"",required:!1},null,8,["modelValue"])])])],2),o(L,{ref:"dt",value:s.filteredSaldoAwal,selection:l.item,"onUpdate:selection":t[5]||(t[5]=i=>l.item=i),"selection-mode":"single",dataKey:"id",onRowDblclick:s.onRowDblclick,paginator:!0,rows:10,filters:l.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{header:r(()=>[a("div",ne,[de,a("span",me,[ce,o(x,{modelValue:l.filters.global.value,"onUpdate:modelValue":t[4]||(t[4]=i=>l.filters.global.value=i),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:r(()=>[ue]),default:r(()=>[o(C,{header:"#",headerStyle:"width:10px"},{body:r(i=>[h(v(i.index+1),1)]),_:1}),(c(!0),p(K,null,J(l.selectedColumns,(i,F)=>(c(),j(C,{field:i.field,header:i.header,class:u(i.class),key:i.field+"_"+F,sortable:!0},{body:r(({data:g,field:_})=>[_=="due_date"||_=="invoice_date"?(c(),p("div",he,v(e.$h.formatDate(g[_])),1)):_=="amount"?(c(),p("div",fe,v(e.$h.formatNumber(g[_])),1)):(c(),p("div",_e,v(g[_]),1))]),_:2},1032,["field","header","class"]))),128)),o(C,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:r(({data:i,index:F})=>[o(T,{data:i,index:F,onEdit:g=>s.FormEdit(i),onDelete:g=>s.confirmDelete(i)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","selection","onRowDblclick","filters"]),o(I,{visible:l.formDialog,"onUpdate:visible":t[12]||(t[12]=i=>l.formDialog=i),style:{width:"720px"},header:"Saldo Awal Piutang",modal:!0,class:""},{footer:r(()=>[o(m,{label:"Cancel",icon:"pi pi-times",class:"p-button-text p-button-danger",onClick:s.HideDialog},null,8,["onClick"]),o(m,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:s.Save,loading:e.isLoading,disabled:e.isLoading},null,8,["onClick","loading","disabled"])]),default:r(()=>[a("div",pe,[a("div",ve,[o(D,{for:"invoice",required:""},{default:r(()=>[h("Nomor Invoice")]),_:1}),o(x,{id:"invoice",modelValue:l.item.invoice,"onUpdate:modelValue":t[6]||(t[6]=i=>l.item.invoice=i),class:u(s.FormError.invoice&&"p-invalid")},null,8,["modelValue","class"]),o(y,{error:s.FormError.invoice},null,8,["error"])]),a("div",ge,[o(D,{for:"invoice_date",required:""},{default:r(()=>[h("Tanggal Invoice")]),_:1}),o(k,{modelValue:l.item.invoice_date,"onUpdate:modelValue":t[7]||(t[7]=i=>l.item.invoice_date=i),inputId:"invoice_date",maxDate:e.$h.today,class:u(s.FormError.invoice_date&&"p-invalid")},null,8,["modelValue","maxDate","class"]),o(y,{error:s.FormError.invoice_date},null,8,["error"])]),a("div",be,[o(S,{modelValue:l.item.id_customer,"onUpdate:modelValue":t[8]||(t[8]=i=>l.item.id_customer=i),onSelectItem:s.selectKontak,label:"Customer",error:s.FormError.id_customer,"is-customer":""},null,8,["modelValue","onSelectItem","error"])]),a("div",De,[o(A,{top:l.item.top,"onUpdate:top":t[9]||(t[9]=i=>l.item.top=i),id:l.item.id_top,"onUpdate:id":t[10]||(t[10]=i=>l.item.id_top=i),error:s.FormError.id_top},null,8,["top","id","error"])]),a("div",ye,[o(D,{for:"due_date"},{default:r(()=>[h("Tanggal Jatuh Tempo")]),_:1}),o(x,{id:"due_date",value:e.$h.formatDate(l.item.due_date),disabled:"",class:u(s.FormError.due_date&&"p-invalid")},null,8,["value","class"]),o(y,{error:s.FormError.due_date},null,8,["error"])]),a("div",we,[o(D,null,{default:r(()=>[h("Total")]),_:1}),M(o(P,{modelValue:l.item.amount,"onUpdate:modelValue":t[11]||(t[11]=i=>l.item.amount=i),name:"harga",mode:"currency",locale:"id-ID",currency:"IDR",class:u(["min-w-max text-right",s.FormError.amount&&"p-invalid"])},null,8,["modelValue","class"]),[[N]]),o(y,{error:s.FormError.amount},null,8,["error"])])])]),_:1},8,["visible"]),o(I,{visible:l.deleteformDialog,"onUpdate:visible":t[14]||(t[14]=i=>l.deleteformDialog=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[o(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[13]||(t[13]=i=>l.deleteformDialog=!1)}),o(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:s.Destroy},null,8,["onClick"])]),default:r(()=>[a("div",ke,[xe,l.item?(c(),p("span",Ce,[h("Are you sure you want to delete "),a("b",null,v(l.item.invoice),1),h("?")])):O("",!0)])]),_:1},8,["visible"])])]),a("pre",null,v(s.FormError),1)])}const Ae=U(Y,[["render",Fe],["__scopeId","data-v-a2390fc2"]]);export{Ae as default};
