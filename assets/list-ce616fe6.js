import{_ as v,Y as k,F as S,r as n,o as D,c as x,b as t,d as e,e as u,n as b,l as y,t as T}from"./index-11eb6111.js";import{a as L}from"./api-f000d862.js";import{a as p}from"./xlsx.min-b21a3818.js";const V={data(){return{filter:!1,filters:{},f:{awal:null,akhir:null,selectedStatus:{label:"All",value:""},selectedCustomer:""},statuses:[{label:"All",value:""},{label:"Draft",value:"D"},{label:"Open",value:"O"},{label:"Close",value:"C"},{label:"Cancel",value:"X"}],lItem:[],lCustomer:[],filteredCustomer:[]}},created(){this.initFilters(),this.getData()},mounted(){},computed:{filteredItems:function(){return this.lItem.filter(a=>(typeof this.f.selectedCustomer=="string"?!0:this.f.selectedCustomer.kontak==a.customer)&&(this.f.awal==null?!0:this.f.awal.toLocaleDateString()<=new Date(a.tanggal).toLocaleDateString())&&(this.f.akhir==null?!0:this.f.akhir.toLocaleDateString()>=new Date(a.tanggal).toLocaleDateString()))}},methods:{async getData(){await L.getLaporanMonitoring().then(a=>{this.lItem=a.data.data.map(l=>({...l,tanggal:this.$h.formatDate(l.tanggal),total:this.$h.formatNumber(l.total)}))}),await k.index().then(a=>{this.lCustomer=a.data.data})},searchCustomer(a){a.query.trim().length?this.filteredCustomer=this.lCustomer.filter(l=>l.kontak.toLowerCase().includes(a.query.trim().toLowerCase())):this.filteredCustomer=[...this.lCustomer]},exportToXLSX(){var a=document.querySelector("table"),l=a.cloneNode(!0),f=l.querySelector("thead tr").childElementCount,c=document.createElement("th");c.setAttribute("colspan",f),c.textContent="Monitoring Sales Order";var o=document.createElement("tr");o.append(c);var i=l.querySelector("thead");i.insertBefore(o,i.childNodes[0]);const d=p.utils.table_to_sheet(l),m=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];d["!cols"]=m,d.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}};const h=p.utils.book_new();p.utils.book_append_sheet(h,d,"Sheet1"),console.log(d),p.writeFile(h,`Monitoring Sales Order ${new Date().getTime()}.xlsx`)},exportCSV(){this.$refs.dt.exportCSV()},showHideFilter(){this.filter=!this.filter},initFilters(){this.filters={global:{value:null,matchMode:S.CONTAINS}}}}},P={class:"grid crud-demo"},O={class:"col-12"},N={class:"card"},F=t("h5",{class:"mbe-4"},"Filter Monitoring Sales Order",-1),B={class:"p-fluid formgrid grid"},I={class:"field col-2"},A={class:"p-float-label"},M=t("p",{class:"mb-1"},"Start Date",-1),E={class:"field col-2"},X={class:"p-float-label"},R=t("p",{class:"mb-1"},"End Date",-1),q={class:"field col-2"},U={class:"p-float-label"},H=t("p",{class:"mb-1"},"Customer",-1),z={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},K=t("h5",{class:"m-0"},"Monitoring Sales Order",-1),j={class:"block mt-2 md:mt-0 p-input-icon-left"},G=t("i",{class:"pi pi-search"},null,-1),Y=t("hr",null,null,-1),J=t("div",{class:"text-center"},"Data is Empty",-1),Q=t("hr",null,null,-1);function W(a,l,f,c,o,i){const d=n("Toast"),m=n("Button"),h=n("Toolbar"),_=n("Calendar"),g=n("AutoComplete"),w=n("InputText"),s=n("Column"),C=n("DataTable");return D(),x("div",P,[t("div",O,[t("div",N,[e(d),e(h,{class:"mb-2"},{start:u(()=>[e(m,{icon:"pi pi-filter",class:b(["p-button mx-2",{"p-button-block":o.filter,"p-button-outlined":!o.filter}]),label:"Filter",onClick:i.showHideFilter},null,8,["onClick","class"])]),end:u(()=>[e(m,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:i.exportToXLSX},null,8,["onClick"])]),_:1}),t("div",{class:b(["card fadein",{hidden:!o.filter}])},[F,t("div",B,[t("div",I,[t("span",A,[M,e(_,{dateFormat:"dd-mm-yy",modelValue:o.f.awal,"onUpdate:modelValue":l[0]||(l[0]=r=>o.f.awal=r),inputId:"periodeawal",sh:"",maxDate:o.f.akhir,showButtonBar:""},null,8,["modelValue","maxDate"])])]),t("div",E,[t("span",X,[R,e(_,{dateFormat:"dd-mm-yy",modelValue:o.f.akhir,"onUpdate:modelValue":l[1]||(l[1]=r=>o.f.akhir=r),inputId:"periodeakhir",minDate:o.f.awal,showButtonBar:""},null,8,["modelValue","minDate"])])]),t("div",q,[t("span",U,[H,e(g,{modelValue:o.f.selectedCustomer,"onUpdate:modelValue":l[2]||(l[2]=r=>o.f.selectedCustomer=r),dropdown:"",suggestions:o.filteredCustomer,onComplete:i.searchCustomer,optionLabel:"kontak"},null,8,["modelValue","suggestions","onComplete"])])])])],2),e(C,{ref:"dt",value:i.filteredItems,selection:a.selectedProducts,"onUpdate:selection":l[4]||(l[4]=r=>a.selectedProducts=r),dataKey:"id",paginator:!0,rows:10,filters:o.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Data",responsiveLayout:"scroll",tableStyle:"table-layout:auto"},{header:u(()=>[t("div",z,[K,t("span",j,[G,e(w,{modelValue:o.filters.global.value,"onUpdate:modelValue":l[3]||(l[3]=r=>o.filters.global.value=r),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:u(()=>[Y,J,Q]),default:u(()=>[e(s,{header:"No",headerStyle:"width:10px"},{body:u(r=>[y(T(r.index+1),1)]),_:1}),e(s,{field:"nomor",header:"Nomor SO",sortable:!0}),e(s,{field:"tanggal",header:"Tanggal SO",sortable:!0}),e(s,{field:"customer",header:"Customer",sortable:!0}),e(s,{field:"referensi",header:"No PO",sortable:!0}),e(s,{field:"gudang",header:"Gudang",sortable:!0}),e(s,{field:"total",header:"Total",class:"text-right",sortable:!0}),e(s,{field:"created_name",header:"Dibuat Oleh",sortable:!0}),e(s,{field:"no_penawaran",header:"No Penawaran",sortable:!0}),e(s,{field:"salesman",header:"Salesman",sortable:!0}),e(s,{field:"delivery_order_nomor",header:"DO",sortable:!0}),e(s,{field:"delivery_order_return_date",header:"Return Date DO",sortable:!0}),e(s,{field:"invoice",header:"Invoice",sortable:!0})]),_:1},8,["value","selection","filters"])])])])}const te=v(V,[["render",W]]);export{te as default};
