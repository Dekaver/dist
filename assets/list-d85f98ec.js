import{_ as T,F as E,r as l,o as d,c as r,b as i,d as n,e as o,l as v,t as p,m as I,q as N,n as C,f as w,k as M,p as P,g as B}from"./index-11eb6111.js";import{a as _}from"./jabatan-a5143f42.js";import{a as U}from"./options-b2eb7ae6.js";const q={data(){return{lJabatan:null,jabatanDialog:!1,deleteJabatanDialog:!1,jabatan:{},selectedAtasan:null,filteredJabatan:[],filters:{},isSubmitted:!1,isEdit:!1,selectedColumns:[{header:"Jabatan",field:"jabatan",class:"w-20rem"},{header:"Atasan",field:"atasan_jabatan",class:"w-20rem"},{header:"Head Departemen",field:"is_head_departemen",class:"w-20rem"}],Columns:[{header:"Jabatan",field:"jabatan",class:"w-20rem"},{header:"Atasan",field:"atasan_jabatan",class:"w-20rem"},{header:"Head Departemen",field:"is_head_departemen",class:"w-20rem"}]}},created(){this.initFilters()},mounted(){this.$isLoading.value=!1,this.getData()},methods:{getData(){_.index().then(a=>{this.lJabatan=a.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data jabatan",life:3e3})}),U.getAtasanJabatan().then(a=>{this.lAtasan=a.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Failed Load data Jabatan Atasan",life:3e3})})},FormNew(){this.jabatan={},this.isSubmitted=!1,this.isLoading=!1,this.jabatanDialog=!0,this.selectedAtasan=null,this.jabatan.is_head_departemen=!1},HideDialog(){this.jabatanDialog=!1,this.selectedAtasan=null,this.isSubmitted=!1},Save(){try{this.isSubmitted=!0,this.$isLoading.value=!0,this.jabatan.jabatan.trim()&&(this.isEdit?_.update(this.jabatan.id,this.jabatan).then(a=>{this.$toast.add({severity:"success",summary:"Successful",detail:a.data.message,life:3e3}),this.lJabatan[this.lJabatan.findIndex(e=>e.id==a.data.data.id)]=a.data.data,a.data.data.is_head_departemen&&(this.lAtasan.find(e=>e.id==a.data.data.id)?this.lAtasan[this.lAtasan.findIndex(e=>e.id==a.data.data.id)]=a.data.data:this.lAtasan.push(a.data.data)),this.isEdit=!1,this.jabatanDialog=!1,this.jabatan={},this.selectedAtasan=null}).catch(a=>{this.$toast.add({severity:"error",summary:"Failed",detail:a.response.data.message,life:3e3})}):_.store(this.jabatan).then(a=>{this.$toast.add({severity:"success",summary:"Successful",detail:a.data.message,life:3e3}),this.lJabatan.push(a.data.data),a.data.data.is_head_departemen&&(this.lAtasan.find(e=>e.id==a.data.data.id)?this.lAtasan[this.lAtasan.findIndex(e=>e.id==a.data.data.id)]=a.data.data:this.lAtasan.push(a.data.data)),this.jabatan={},this.selectedAtasan=null}).catch(a=>{this.$toast.add({severity:"error",summary:"Failed",detail:a.response.data.message,life:3e3})}),this.isSubmitted=!1)}catch(a){console.log(a)}finally{this.$timeoutLoading()}},FormEdit(a){this.isEdit=!0,this.jabatan={...a},this.jabatanDialog=!0,this.jabatan.atasan!=null&&(this.selectedAtasan=this.lAtasan.find(e=>e.id==this.jabatan.atasan))},confirmDelete(a){this.jabatan=a,this.deleteJabatanDialog=!0},Destroy(){this.deleteJabatanDialog=!1,_.destroy(this.jabatan.id).then(a=>{this.lJabatan=this.lJabatan.filter(e=>e.id!==this.jabatan.id),this.$toast.add({severity:"success",summary:"Successful",detail:a.data.message,life:3e3}),this.getData()}).catch(a=>{this.$toast.add({severity:"error",summary:"Failed",detail:a.response.data.message,life:3e3})}),this.jabatan={}},searchAtasan(a){setTimeout(()=>{a.query.trim().length?this.filteredJabatan=this.lAtasan.filter(e=>e.jabatan.toLowerCase().includes(a.query.toLowerCase())):this.filteredJabatan=[...this.lAtasan]},250)},selectAtasan(a){this.jabatan.atasan=a.value.id,this.jabatan.jabatan_atasan=a.value.jabatan},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:E.CONTAINS}}}}},c=a=>(P("data-v-af296a83"),a=a(),B(),a),H={class:"grid crud-demo"},R={class:"col-12"},O={class:"card"},z={class:"my-2"},Y={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},G=c(()=>i("h5",{class:"m-0"},"Manajemen Jabatan",-1)),K={class:"block mt-2 md:mt-0 p-input-icon-left"},Q=c(()=>i("i",{class:"pi pi-search"},null,-1)),W=c(()=>i("hr",null,null,-1)),X=c(()=>i("div",{class:"text-center"},"Jabatan is Empty",-1)),Z=c(()=>i("hr",null,null,-1)),$={key:0},aa={key:1},ea={key:2},ta={key:3},sa={key:4},ia={class:"formgrid grid"},na={class:"field col-12 d-flex justifiy-content-center align-items-end"},la=c(()=>i("label",{for:"jabatan"},"Jabatan",-1)),oa={key:0,class:"p-invalid"},da={class:"field col-12 d-flex justifiy-content-center align-items-end"},ra=c(()=>i("label",{for:"atasan"},"Atasan Langsung",-1)),ca={class:"flex gap-2 align-options-center"},ua={class:"col-6"},ma={class:""},ha=c(()=>i("span",{id:"switch1",style:{position:"relative",bottom:"8px",left:"8px"}},"Head Department",-1)),pa={class:"flex align-items-center justify-content-center"},ba=c(()=>i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),_a={key:0};function fa(a,e,ga,va,s,u){const x=l("Toast"),b=l("Button"),A=l("MyExport"),D=l("Toolbar"),k=l("MultiSelect"),y=l("InputText"),f=l("Column"),S=l("Tag"),J=l("ActionButton"),L=l("DataTable"),V=l("AutoComplete"),F=l("InputSwitch"),j=l("Dialog");return d(),r("div",H,[i("div",R,[i("div",O,[n(x),n(D,{class:"mb-4"},{start:o(()=>[i("div",z,[n(b,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:u.FormNew},null,8,["onClick"])])]),end:o(()=>[n(A,{value:s.lJabatan,selectedColumns:s.selectedColumns,title:"Export Jabatan"},null,8,["value","selectedColumns"])]),_:1}),n(L,{ref:"dt",value:s.lJabatan,dataKey:"id",paginator:!0,rows:10,filters:s.filters,rowGroupMode:"rowspan",groupRowsBy:"jabatan_atasan",sortMode:"single",sortField:"jabatan",sortOrder:1,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Jabatan",responsiveLayout:"scroll"},{header:o(()=>[i("div",Y,[G,n(k,{modelValue:s.selectedColumns,"onUpdate:modelValue":e[0]||(e[0]=t=>s.selectedColumns=t),options:s.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),i("span",K,[Q,n(y,{modelValue:s.filters.global.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.filters.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),empty:o(()=>[W,X,Z]),default:o(()=>[n(f,{header:"#",headerStyle:"width:10px"},{body:o(t=>[v(p(t.index+1),1)]),_:1}),(d(!0),r(I,null,N(s.selectedColumns,(t,g)=>(d(),M(f,{field:t.field,header:t.header,class:C(t.class),key:t.field+"_"+g,sortable:!0},{body:o(({data:m,field:h})=>[h=="icon"?(d(),r("div",$,[n(b,{icon:m[h],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):h=="is_head_departemen"?(d(),r("div",aa,[n(S,{value:m[h]?"Yes":"No",severity:m[h]?"open":"close"},null,8,["value","severity"])])):t.type=="date"?(d(),r("div",ea,p(a.$h.formatDate(m[h])),1)):t.parent=="pegawai"?(d(),r("div",ta,p(m.pegawai[h]),1)):(d(),r("div",sa,p(m[h]),1))]),_:2},1032,["field","header","class"]))),128)),n(f,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:o(({data:t,index:g})=>[n(J,{data:t,index:g,onEdit:m=>u.FormEdit(t),onDelete:m=>u.confirmDelete(t)},null,8,["data","index","onEdit","onDelete"])]),_:1})]),_:1},8,["value","filters"]),n(j,{visible:s.jabatanDialog,"onUpdate:visible":e[5]||(e[5]=t=>s.jabatanDialog=t),style:{width:"450px"},header:"Departemen Details",modal:!0,class:"p-fluid"},{footer:o(()=>[n(b,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:u.HideDialog},null,8,["onClick"]),n(b,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:u.Save,loading:a.$isLoading.value,disabled:a.$isLoading.value},null,8,["onClick","loading","disabled"])]),default:o(()=>[i("div",ia,[i("div",na,[la,n(y,{id:"jabatan",modelValue:s.jabatan.jabatan,"onUpdate:modelValue":e[2]||(e[2]=t=>s.jabatan.jabatan=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:C({"p-invalid":s.isSubmitted&&!s.jabatan.jabatan})},null,8,["modelValue","class"]),s.isSubmitted&&!s.jabatan.jabatan?(d(),r("small",oa,"required")):w("",!0)]),i("div",da,[ra,n(V,{modelValue:s.selectedAtasan,"onUpdate:modelValue":e[3]||(e[3]=t=>s.selectedAtasan=t),optionLabel:"jabatan",suggestions:s.filteredJabatan,onComplete:u.searchAtasan,onChange:u.selectAtasan,dropdown:"",forceSelection:""},{option:o(t=>[i("div",ca,[i("div",null,"["+p(t.option.id)+"]",1),i("div",null,p(t.option.jabatan),1)])]),_:1},8,["modelValue","suggestions","onComplete","onChange"])]),i("div",ua,[i("div",ma,[n(F,{modelValue:s.jabatan.is_head_departemen,"onUpdate:modelValue":e[4]||(e[4]=t=>s.jabatan.is_head_departemen=t),"aria-labelledby":"switch1",boolean:!0},null,8,["modelValue"]),ha])])])]),_:1},8,["visible"]),n(j,{visible:s.deleteJabatanDialog,"onUpdate:visible":e[7]||(e[7]=t=>s.deleteJabatanDialog=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:o(()=>[n(b,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[6]||(e[6]=t=>s.deleteJabatanDialog=!1)}),n(b,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:u.Destroy},null,8,["onClick"])]),default:o(()=>[i("div",pa,[ba,s.jabatan?(d(),r("span",_a,[v("Are you sure you want to delete "),i("b",null,p(s.jabatan.jabatan),1),v("?")])):w("",!0)])]),_:1},8,["visible"])])])])}const wa=T(q,[["render",fa],["__scopeId","data-v-af296a83"]]);export{wa as default};
