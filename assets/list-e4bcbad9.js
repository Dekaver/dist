import{_ as L,o as r,c as d,b as t,m as g,q as w,t as s,W as T,p as C,g as I,F as P,r as _,d as m,e as v,n as D,k as j,C as M}from"./index-11eb6111.js";import{a as E}from"./index-fa5c02f8.js";import{a as S}from"./xlsx.min-b21a3818.js";import{a as V}from"./options-b2eb7ae6.js";import{_ as X}from"./data-empty-73bd2e8a.js";const K={props:{lItem:{type:Array,default:()=>[]}},data(){return{columns:[{field:"ap_number",header:"Nomor",expander:!0},{field:"date",header:"Tanggal",type:"date"},{field:"invoice_number",header:"Invoice"},{field:"invoice_date",header:"Tanggal Invoice",type:"date"},{field:"due_date",header:"Jatuh Tempo",type:"date"},{field:"amount",header:"Nilai Invoice",class:"justify-content-end",type:"currency"},{field:"pay",header:"Bayar",class:"justify-content-end",type:"currency"},{field:"discount",header:"Diskon",class:"justify-content-end",type:"currency"},{field:"sisa",header:"Sisa Tagihan",class:"justify-content-end",type:"currency"},{field:"umur_overdue",header:"Umur Jatuh Tempo",type:"number"},{field:"po_number",header:"Nomor PO"},{field:"keterangan",header:"Keterangan"}]}},methods:{exportToXLSX(){const e=S.utils.table_to_sheet(document.getElementById("table")),l=[{width:15},{wch:25},{width:15},{width:13},{width:13},{width:20},{width:20},{width:20},{width:20},{width:14},{width:15},{width:15}];e["!cols"]=l;for(const u in e)if(Object.prototype.hasOwnProperty.call(e,u)){const a=e[u];a.t==="n"&&(a.z="0")}e.A1.s={font:{name:"Arial Black",sz:12,bold:!0},alignment:{vertical:"center",horizontal:"center"}},e.A2.s={font:{name:"Arial Black",sz:16,bold:!0},alignment:{vertical:"center",horizontal:"center"}};let f={fill:{patternType:"solid",fgColor:{rgb:"49b1fb"},bgColor:{rgb:"49b1fb"}},alignment:{vertical:"center",horizontal:"center"}};const i={s:{c:0,r:5},e:{c:11,r:5}};for(let u=i.s.r;u<=i.e.r;u++)for(let a=i.s.c;a<=i.e.c;a++){const y=S.utils.encode_cell({r:u,c:a});e[y].s=f}["F","G","H","I"].forEach(u=>{for(let a=7;a<=this.totalDataObjects+7;a++){const y=u+a,b=e[y];b&&b.v&&(b.s={alignment:{vertical:"center",horizontal:"right"}})}});const p=S.utils.book_new();S.utils.book_append_sheet(p,e,"Sheet1"),S.writeFile(p,"exported_data.xlsx")}},created(){},mounted(){},computed:{totalDataObjects(){let e=0;for(const l of this.lItem)if(e++,l.children&&Array.isArray(l.children))for(const f of l.children)e++;return e}}},F=e=>(C("data-v-f4ea50a3"),e=e(),I(),e),R={border:"1",id:"table"},Y=F(()=>t("tr",null,[t("td",{colspan:"12"},"PT Planet IT (PRODUK)")],-1)),U=F(()=>t("tr",null,[t("td",{colspan:"12"},"LAPORAN HUTANG (AP) BELUM LUNAS")],-1));function z(e,l,f,i,o,p){return r(),d("div",null,[t("button",{onClick:l[0]||(l[0]=(...u)=>p.exportToXLSX&&p.exportToXLSX(...u))},"Export to XLSX"),t("div",null,[t("table",R,[t("thead",null,[Y,U,t("tr",null,[(r(),d(g,null,w(12,u=>t("td",{key:u},s(" "))),64))]),t("tr",null,[(r(),d(g,null,w(12,u=>t("td",{key:u},s(" "))),64))]),t("tr",null,[(r(),d(g,null,w(12,u=>t("td",{key:u},s(" "))),64))]),t("tr",null,[(r(!0),d(g,null,w(o.columns,(u,a)=>(r(),d("th",{key:a},s(u.header),1))),128))])]),t("tbody",null,[(r(!0),d(g,null,w(f.lItem,({key:u,data:a,children:y,style:b})=>(r(),d(g,{key:u},[t("tr",{style:T(b==="font-bold"?"font-weight: bold;":"")},[t("td",null,s(a.invoice_number),1),t("td",null,s(e.$h.formatDate(a.invoice_date)),1),t("td",null,s(a.due_date!="Total"?e.$h.formatDate(a.due_date):a.due_date),1),t("td",null,s(a.amount?e.$h.formatNumber(a.amount):null),1),t("td",null,s(a.pay?e.$h.formatNumber(a.pay):null),1),t("td",null,s(a.discount?e.$h.formatNumber(a.discount):null),1),t("td",null,s(a.sisa?e.$h.formatNumber(a.sisa):null),1),t("td",null,s(a.umur_overdue),1),t("td",null,s(a.po_number),1),t("td",null,s(a.keterangan),1)],4),(r(!0),d(g,null,w(y,({key:x,data:c})=>(r(),d("tr",{key:x,style:T(c.style==="font-bold"?"font-weight: bold;":"")},[t("td",null,s(c.invoice_number),1),t("td",null,s(e.$h.formatDate(c.invoice_date)),1),t("td",null,s(c.due_date!="Total"?e.$h.formatDate(c.due_date):c.due_date),1),t("td",null,s(c.amount?e.$h.formatNumber(c.amount):null),1),t("td",null,s(c.pay?e.$h.formatNumber(c.pay):null),1),t("td",null,s(c.discount?e.$h.formatNumber(c.discount):null),1),t("td",null,s(c.sisa?e.$h.formatNumber(c.sisa):null),1),t("td",null,s(c.umur_overdue),1),t("td",null,s(c.po_number),1),t("td",null,s(c.keterangan),1)],4))),128))],64))),128))])])])])}const $=L(K,[["render",z],["__scopeId","data-v-f4ea50a3"]]);const H={components:{Export:$},data(){return{columns:[{field:"date",header:"",expander:!0},{field:"tanggal",header:"Tanggal",type:"date"},{field:"kode_barang",header:"Kode Barang"},{field:"nama_barang",header:"Nama Barang"},{field:"qty",header:"QTY",class:"justify-content-end",type:"currency"},{field:"satuan",header:"Satuan",class:"justify-content-end"},{field:"jumlah_tagihan",header:"Jumlah Tagihan",class:"justify-content-end",type:"currency"},{field:"total",header:"Total",class:"justify-content-end",type:"currency"}],lItem:[],filter:!1,filters:{},expandedKeys:{},grandtotal:null,lSupplier:[],selectedSupplier:null,selectedStatus:null,periodes:[{label:"All",value:""},{label:"Perhari",value:"Perhari"},{label:"Kemarin",value:"Kemarin"},{label:"Perminggu",value:"Perminggu"},{label:"Perbulan",value:"Perbulan"},{label:"Pertahun",value:"Pertahun"},{label:"Minggu Lalu",value:"MingguLalu"},{label:"Bulan Lalu",value:"BulanLalu"},{label:"Tahun Lalu",value:"TahunLalu"},{label:"Custom",value:"Custom"}],f:{awal:null,akhir:null,selectedStatus:{label:"All",value:""}},selectedPeriode:{label:"All",value:""}}},created(){this.initFilters()},mounted(){this.getData()},methods:{ubahSupplier(e){e.value===null?this.f.id_supplier=null:this.f.id_supplier=this.selectedSupplier.id,this.getReport()},getReportCustom(){this.selectedPeriode={label:"Custom",value:"Custom"},this.getReport()},ubahPeriode(){const e=new Date,l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(this.selectedPeriode.value){case"Perhari":{this.f.awal=l,this.f.akhir=f;break}case"Kemarin":{const i=new Date(new Date(l).setDate(l.getDate()-1));this.f.awal=i,this.f.akhir=i;break}case"Perminggu":{const i=new Date(new Date(l).setDate(l.getDate()-7));this.f.awal=i,this.f.akhir=f;break}case"Perbulan":{const i=new Date(e.getFullYear(),e.getMonth(),1);this.f.awal=i,this.f.akhir=f;break}case"Pertahun":{const i=new Date(e.getFullYear(),0,1);this.f.awal=i,this.f.akhir=f;break}case"MingguLalu":{const i=new Date(new Date(l).setDate(l.getDate()-l.getDay()-7)),o=new Date(new Date(i).setDate(i.getDate()+6));this.f.awal=i,this.f.akhir=o;break}case"BulanLalu":{const i=new Date(e.getFullYear(),e.getMonth()-1,1),o=new Date(e.getFullYear(),e.getMonth(),0);this.f.awal=i,this.f.akhir=o;break}case"TahunLalu":{const i=new Date(e.getFullYear()-1,0,1),o=new Date(e.getFullYear()-1,11,31);this.f.awal=i,this.f.akhir=o;break}default:{this.f.awal=null,this.f.akhir=null;break}}this.getReport()},exportToXLSX(){this.$refs.Export.exportToXLSX()},async getData(){V.getKontakSupplier().then(e=>{this.lSupplier=e.data.data,e.data.data.length==1&&(this.selectedSupplier=e.data.data[0])}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load data Customer",life:3e3})}),await this.getReport()},getReport(){E.getPembelianSupplier(this.f).then(e=>{this.grandtotal=e.data.total,this.lItem=e.data.data,this.lItem.map(l=>this.expandedKeys[l.key]=!0)}).catch(e=>{this.$toast.add({severity:"error",summary:"Error",detail:e.response.data.message,life:3e3})})},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:P.CONTAINS}}},showHideFilter(){this.filter=!this.filter}}},k=e=>(C("data-v-cec88104"),e=e(),I(),e),J={class:"grid crud-demo"},W={class:"col-12"},q={class:"card"},G={class:"my-2"},Q=k(()=>t("h5",{class:"mbe-4"},"Filter Pembelian Supplier",-1)),Z={class:"p-fluid formgrid grid"},ee={class:"field col-2 d-flex justifiy-content-center align-items-end"},te=k(()=>t("label",{for:"supplier",class:"mb-1"},"Supplier",-1)),le={class:"field col-2 d-flex justifiy-content-center align-items-end"},ae=k(()=>t("label",{for:"periode",class:"mb-1"},"Periode",-1)),ne={class:"field col-2"},oe={class:"p-float-label"},se=k(()=>t("p",{class:"mb-1"},"Periode Awal",-1)),re={class:"field col-2"},ie={class:"p-float-label"},de=k(()=>t("p",{class:"mb-1"},"Periode Akhir",-1)),ue={key:0},ce={key:0},he={key:1,class:"text-right"},pe={key:1},me={key:2,class:"text-right"},fe={key:0},_e={key:1},ge={key:3},ye={class:"text-right"},be=k(()=>t("div",{class:"flex flex-column gap-2 justify-content-center align-items-center"},[t("div",{class:"text-4xl"},"Loading...")],-1)),ve=k(()=>t("div",{class:"flex flex-column gap-2 justify-content-center align-items-center"},[t("img",{src:X,alt:"",style:{width:"300px"}}),t("div",{class:"text-4xl"},"Belum ada data.")],-1));function we(e,l,f,i,o,p){const u=_("Toast"),a=_("Button"),y=_("MyExport"),b=_("Toolbar"),x=_("Dropdown"),c=_("Calendar"),N=_("Tag"),A=_("Column"),B=_("TreeTable"),O=_("Export");return r(),d(g,null,[t("div",J,[t("div",W,[t("div",q,[m(u),m(b,{class:"mb-2"},{start:v(()=>[t("div",G,[m(a,{icon:"pi pi-filter",label:"Filter",class:D(["p-button mx-2",{"p-button-block":o.filter,"p-button-outlined":!o.filter}]),onClick:p.showHideFilter},null,8,["onClick","class"])])]),end:v(()=>[m(a,{label:"Export XLSX",icon:"pi pi-upload",class:"p-button-help",onClick:l[0]||(l[0]=n=>p.exportToXLSX()),disabled:!o.lItem.length>0,loading:!o.lItem.length>0},null,8,["disabled","loading"]),m(y,{value:o.lItem,selectedColumns:e.selectedColumns,title:"Export Excel"},null,8,["value","selectedColumns"])]),_:1}),t("div",{class:D(["card",{hidden:!o.filter}])},[Q,t("div",Z,[t("div",ee,[te,m(x,{id:"supplier",modelValue:o.selectedSupplier,"onUpdate:modelValue":l[1]||(l[1]=n=>o.selectedSupplier=n),onChange:p.ubahSupplier,options:o.lSupplier,placeholder:"Supplier",optionLabel:"kontak",showClear:""},null,8,["modelValue","onChange","options"])]),t("div",le,[ae,m(x,{id:"periode",modelValue:o.selectedPeriode,"onUpdate:modelValue":l[2]||(l[2]=n=>o.selectedPeriode=n),onChange:p.ubahPeriode,options:o.periodes,optionLabel:"label",placeholder:"All"},null,8,["modelValue","onChange","options"])]),t("div",ne,[t("span",oe,[se,m(c,{dateFormat:"dd-mm-yy",modelValue:o.f.awal,"onUpdate:modelValue":l[3]||(l[3]=n=>o.f.awal=n),onDateSelect:p.getReportCustom,inputId:"periodeawal"},null,8,["modelValue","onDateSelect"])])]),t("div",re,[t("span",ie,[de,m(c,{dateFormat:"dd-mm-yy",modelValue:o.f.akhir,"onUpdate:modelValue":l[4]||(l[4]=n=>o.f.akhir=n),onDateSelect:p.getReportCustom,inputId:"periodeakhir"},null,8,["modelValue","onDateSelect"])])])])],2),m(B,{expandedKeys:o.expandedKeys,"onUpdate:expandedKeys":l[5]||(l[5]=n=>o.expandedKeys=n),value:o.lItem,indentation:"1",scrollable:"",scrollDirection:"both"},{default:v(()=>[(r(!0),d(g,null,w(o.columns,n=>(r(),j(A,{key:n.field,field:n.field,header:n.header,class:D(n.class),expander:n.expander,style:T([n.style,{width:"250px"}])},M({body:v(h=>[n.type=="date"?(r(),d("div",ue,[new Date(h.node.data[n.field])instanceof Date&&!isNaN(new Date(h.node.data[n.field]))?(r(),d("div",ce,s(e.$h.formatDate(new Date(h.node.data[n.field]))),1)):(r(),d("div",{key:1,class:D(h.node.data.style)},s(h.node.data[n.field]),3))])):n.type=="currency"?(r(),d("div",he,[h.node.data[n.field]?(r(),d("div",{key:0,class:D(h.node.data.style)},s(e.$h.formatNumber(h.node.data[n.field])),3)):(r(),d("div",pe))])):n.type=="number"?(r(),d("div",me,[h.node.data[n.field]?(r(),d("div",fe,s(e.$h.formatNumber(h.node.data[n.field])),1)):(r(),d("div",_e))])):e.field=="status"?(r(),d("div",ge,[m(N,{style:{float:"right"},value:e.$h.getLabel(h.node.data[n.field]),severity:e.$h.getLabel(h.node.data[n.field])},null,8,["value","severity"])])):(r(),d("div",{key:4,class:D(h.node.data.style)},s(h.node.data[n.field]),3))]),loading:v(()=>[be]),empty:v(()=>[ve]),_:2},[n.field=="total"?{name:"footer",fn:v(()=>[t("div",ye,s(e.$h.formatNumber(o.grandtotal)),1)]),key:"0"}:void 0]),1032,["field","header","class","expander","style"]))),128))]),_:1},8,["expandedKeys","value"])])])]),m(O,{ref:"Export",style:{display:"none"},lItem:o.lItem},null,8,["lItem"])],64)}const Le=L(H,[["render",we],["__scopeId","data-v-cec88104"]]);export{Le as default};
