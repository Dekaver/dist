import{_ as F,F as N,r as n,o as d,c as m,b as l,d as o,e as i,n as b,l as _,t as p,m as A,q as B,f as E,k as I}from"./index-11eb6111.js";import{a as v}from"./api-125ed4f7.js";const M={data(){return{items:[{nomor:null,tanggal:null,id_so:null,id_customer:null,id_salesman:"",id_gudang:"",kepada:"",keterangan:"",alamat:"",status:"",telepon:"",email:"",deliverypoint:"",create_by:"",modified_by:"",create_date:"",modified_date:""}],lSalesOrder:[],salesorder:null,periode:{awal:null,akhir:null},products:null,product:{},selectedProducts:null,f:{awal:null,akhir:null,selectedStatus:{label:"All",value:""}},statuses:[{label:"All",value:""},{label:"Draft",value:"D"},{label:"Open",value:"O"},{label:"Close",value:"C"},{label:"Cancel",value:"X"}],selectedColumns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"total",header:"Total",class:"text-right",type:"currency"},{field:"status",header:"Status",class:"text-left"}],Columns:[{field:"tanggal",header:"Tanggal",class:"text-left",type:"date"},{field:"total",header:"Total",class:"text-right",type:"currency"},{field:"status",header:"Status",class:"text-left"}],deleteDialog:!1,filter:!1,filters:null,loading:!1}},created(){this.initFilters()},mounted(){this.getData()},computed:{filteredItems:function(){return this.lSalesOrder.filter(a=>(this.f.selectedStatus.value==""?!0:this.f.selectedStatus.value==a.status)&&(this.f.awal==null?!0:this.f.awal.toLocaleDateString()<=new Date(a.tanggal).toLocaleDateString())&&(this.f.akhir==null?!0:this.f.akhir.toLocaleDateString()>=new Date(a.tanggal).toLocaleDateString()))}},methods:{getData(){this.loading=!0,v.index().then(a=>{this.lSalesOrder=a.data.data}).catch(()=>{this.$toast.add({severity:"error",summary:"Failed",detail:"Load Sales Order",life:3e3})}).finally(()=>{this.loading=!1})},getLabel:function(a){switch(a){case"D":return"draft";case"O":return"open";case"P":return"partial";case"C":return"close";case"X":return"cancel";default:return"draft"}},confirmDelete(a){this.salesorder=a,this.deleteDialog=!0},submitDelete(){let a=!0;v.destroy(this.salesorder.id).then(()=>{this.deleteDialog=!1,this.$toast.add({severity:"success",summary:"Successful",detail:"Sales Order Deleted",life:3e3})}).catch(s=>{console.log(s),a=!1,this.$toast.add({severity:"error",summary:"Failed",detail:s.response.data.message,life:3e3})}).finally(()=>{a&&(this.lSalesOrder=this.lSalesOrder.filter(s=>s.id!=this.salesorder.id))})},FormEdit(a){this.$router.push(`/rencana-anggaran-biaya/${a.id}/edit`)},showHideFilter(){this.filter=!this.filter},exportCSV(){this.$refs.dt.exportCSV()},initFilters(){this.filters={global:{value:null,matchMode:N.CONTAINS}}}}},U={class:"grid crud-demo"},R={class:"col-12"},j={class:"card"},q={class:"my-2"},z=l("h5",{class:"mbe-4"},"Filter Sales Order",-1),H={class:"p-fluid formgrid grid"},X={class:"field col-2"},K={class:"p-float-label"},Y=l("p",{class:"mb-1"},"Periode Awal",-1),G={class:"field col-2"},J={class:"p-float-label"},Q=l("p",{class:"mb-1"},"Periode Akhir",-1),W={class:"field col-2 d-flex justifiy-content-center align-items-end mb-0"},Z=l("label",{for:"salesquotation",class:"mb-1"},"Status",-1),$={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ee=l("h5",{class:"m-0"},"Manage Sales Order",-1),te={class:"block mt-2 md:mt-0 p-input-icon-left"},le=l("i",{class:"pi pi-search"},null,-1),se=l("span",{class:"p-column-title"},"SO Number",-1),oe={key:0},ae={key:1},ne={key:2},ie={key:3,class:"text-right"},re={key:4},de={class:"flex align-items-center justify-content-center"},ce=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ue={key:0};function me(a,s,pe,fe,t,c){const S=n("Toast"),f=n("Button"),k=n("router-link"),D=n("MyExport"),w=n("Toolbar"),y=n("Calendar"),x=n("Dropdown"),C=n("MultiSelect"),V=n("InputText"),h=n("Column"),T=n("Tag"),L=n("ActionButton"),O=n("DataTable"),P=n("Dialog");return d(),m("div",U,[l("div",R,[l("div",j,[o(S),o(w,{class:"mb-4"},{start:i(()=>[l("div",q,[o(k,{to:"/rencana-anggaran-biaya/create",class:"btn btn-added me-2"},{default:i(()=>[o(f,{label:"Tambah",icon:"pi pi-plus",class:"p-button-primary mr-2"})]),_:1}),o(f,{icon:"pi pi-filter",label:"Filter",class:b(["p-button mx-2",{"p-button-block":t.filter,"p-button-outlined":!t.filter}]),onClick:c.showHideFilter},null,8,["onClick","class"])])]),end:i(()=>[o(D,{value:c.filteredItems,selectedColumns:t.selectedColumns,title:"Export Sales Order"},null,8,["value","selectedColumns"])]),_:1}),l("div",{class:b(["card fadein",{hidden:!t.filter}])},[z,l("div",H,[l("div",X,[l("span",K,[Y,o(y,{dateFormat:"dd-mm-yy",modelValue:t.f.awal,"onUpdate:modelValue":s[0]||(s[0]=e=>t.f.awal=e),inputId:"periodeawal"},null,8,["modelValue"])])]),l("div",G,[l("span",J,[Q,o(y,{dateFormat:"dd-mm-yy",modelValue:t.f.akhir,"onUpdate:modelValue":s[1]||(s[1]=e=>t.f.akhir=e),inputId:"periodeakhir"},null,8,["modelValue"])])]),l("div",W,[Z,o(x,{id:"salesquotation",modelValue:t.f.selectedStatus,"onUpdate:modelValue":s[2]||(s[2]=e=>t.f.selectedStatus=e),options:t.statuses,optionLabel:"label",placeholder:"All"},null,8,["modelValue","options"])])])],2),o(O,{ref:"dt",value:c.filteredItems,selection:t.selectedProducts,"onUpdate:selection":s[5]||(s[5]=e=>t.selectedProducts=e),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Sales order",responsiveLayout:"scroll"},{header:i(()=>[l("div",$,[ee,o(C,{modelValue:t.selectedColumns,"onUpdate:modelValue":s[3]||(s[3]=e=>t.selectedColumns=e),options:t.Columns,optionLabel:"header",placeholder:"Select Column",class:"w-full md:w-20rem ml-auto"},null,8,["modelValue","options"]),l("span",te,[le,o(V,{modelValue:t.filters.global.value,"onUpdate:modelValue":s[4]||(s[4]=e=>t.filters.global.value=e),placeholder:"Search..."},null,8,["modelValue"])])])]),default:i(()=>[o(h,{header:"#",headerStyle:"width:10px;"},{body:i(({index:e})=>[_(p(e+1),1)]),_:1}),o(h,{field:"nomor",header:"SO Number",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(e=>[se,_(" "+p(e.data.nomor),1)]),_:1}),(d(!0),m(A,null,B(t.selectedColumns,(e,g)=>(d(),I(h,{field:e.field,header:e.header,class:b(e.class),key:e.field+"_"+g,sortable:!0},{body:i(({data:u,field:r})=>[r=="icon"?(d(),m("div",oe,[o(f,{icon:u[r],class:"p-button-rounded p-button-outlined p-button-icon"},null,8,["icon"])])):r=="status"?(d(),m("div",ae,[o(T,{value:c.getLabel(u[r]),severity:c.getLabel(u[r])},null,8,["value","severity"])])):r=="tanggal"?(d(),m("div",ne,p(a.$h.formatDate(u[r])),1)):e.type=="currency"?(d(),m("div",ie,p(a.$h.formatNumber(u[r])),1)):(d(),m("div",re,p(u[r]),1))]),_:2},1032,["field","header","class"]))),128)),o(h,{header:"Aksi",headerStyle:"width:6%; max-width:1rem;"},{body:i(({data:e,index:g})=>[o(L,{data:e,index:g,onEdit:u=>c.FormEdit(e),onDelete:u=>c.confirmDelete(e),showDelete:e.status=="D"||e.status=="O"},null,8,["data","index","onEdit","onDelete","showDelete"])]),_:1})]),_:1},8,["value","selection","filters"])]),o(P,{visible:t.deleteDialog,"onUpdate:visible":s[7]||(s[7]=e=>t.deleteDialog=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[o(f,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[6]||(s[6]=e=>t.deleteDialog=!1)}),o(f,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:c.submitDelete},null,8,["onClick"])]),default:i(()=>[l("div",de,[ce,t.salesorder?(d(),m("span",ue,[_("Are you sure you want to delete "),l("b",null,p(t.salesorder.nomor),1),_("?")])):E("",!0)])]),_:1},8,["visible"])])])}const ge=F(M,[["render",me]]);export{ge as default};
